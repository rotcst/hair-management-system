<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MAKE IT HAIR Professional - ç®¡ç†ç³»ç»Ÿ</title>
    <!-- SheetJSåº“ç”¨äºå¤„ç†Excelæ–‡ä»¶ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Firebase SDK - ç”¨äºäº‘ç«¯æ•°æ®åŒæ­¥ -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        :root {
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --black: #000000;
            --dark-gray: #1a1a1a;
            --text-light: #ffffff;
        }
        
        /* æµ…è‰²æ¨¡å¼å˜é‡ */
        body.light-theme {
            --gold: #B8860B;
            --gold-light: #DAA520;
            --black: #f8f9fa;
            --dark-gray: #f5f5f5;
            --text-light: #212529;
        }
        
        /* æµ…è‰²æ¨¡å¼ç‰¹å®šæ ·å¼ */
        body.light-theme .menu-item {
            background: #ffffff;
            border: 1px solid var(--gold);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        body.light-theme .menu-item:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        body.light-theme .content-area {
            background: #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        body.light-theme .top-nav .store-info,
        body.light-theme .top-nav .user-info,
        body.light-theme .top-nav .language-switcher {
            background: #ffffff;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        body.light-theme input,
        body.light-theme select,
        body.light-theme textarea {
            background: #ffffff !important;
            border-color: var(--gold) !important;
            color: var(--text-light) !important;
        }
        
        body.light-theme .submenu-item {
            background: rgba(184, 134, 11, 0.1);
            border: 1px solid rgba(184, 134, 11, 0.3);
        }
        
        body.light-theme .submenu-item:hover {
            background: rgba(184, 134, 11, 0.2);
        }
        
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--black);
            color: var(--text-light);
        }
        
        .container {
            max-width: 1200px;
            margin: 60px auto 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 50px;
            padding: 20px;
            border-bottom: 2px solid var(--gold);
        }
        
        .logo {
            font-size: 2.5em;
            color: var(--gold);
            margin-bottom: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }
        
        .logo:hover {
            color: var(--gold-light);
            transform: scale(1.1);
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }
        
        .subtitle {
            color: var(--gold-light);
            font-style: italic;
            font-size: 1.2em;
        }
        
        .menu {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .menu-item {
            background: var(--dark-gray);
            padding: 30px;
            border-radius: 10px;
            border: 1px solid var(--gold);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .menu-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.2);
            border-color: var(--gold-light);
        }
        
        .menu-item:hover h2 {
            color: var(--gold-light);
        }
        
        .menu-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            transform: translateX(-100%);
            transition: 0.5s;
        }
        
        .menu-item:hover::before {
            transform: translateX(100%);
        }
        
        h1 {
            color: var(--gold);
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        
        h2 {
            color: var(--gold);
            margin: 0 0 15px 0;
            font-size: 1.5em;
            transition: color 0.3s ease;
        }
        
        p {
            color: var(--text-light);
            margin: 0;
            line-height: 1.6;
            font-size: 1.1em;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid var(--gold);
            color: var(--gold-light);
        }
        
        /* å­èœå•æ ·å¼ */
        .submenu {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--gold);
        }
        
        .submenu.active {
            display: block;
        }
        
        .submenu-item {
            background: rgba(212, 175, 55, 0.1);
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .submenu-item:hover {
            background: rgba(212, 175, 55, 0.2);
            border-color: var(--gold);
            transform: translateX(10px);
        }
        
        .submenu-item h3 {
            color: var(--gold-light);
            margin: 0 0 5px 0;
            font-size: 1.1em;
        }
        
        .submenu-item p {
            margin: 0;
            font-size: 0.9em;
            color: #cccccc;
        }
        
        .back-button {
            background: var(--gold);
            color: var(--black);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .back-button:hover {
            background: var(--gold-light);
            transform: translateY(-2px);
        }
        
        .content-area {
            display: none;
            background: var(--dark-gray);
            padding: 30px;
            border-radius: 10px;
            border: 1px solid var(--gold);
            margin-top: 20px;
        }
        
        .content-area.active {
            display: block;
        }
        
        .content-area h1 {
            color: var(--gold);
            border-bottom: 2px solid var(--gold);
            padding-bottom: 10px;
        }
        
        /* é¡¶éƒ¨å¯¼èˆªæ æ ·å¼ */
        .top-nav {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* ä»£ç†åº—åç§°æ˜¾ç¤ºæ ·å¼ */
        .store-info {
            background: var(--dark-gray);
            padding: 8px 15px;
            border-radius: 8px;
            height: 40px;
            display: flex;
            align-items: center;
            box-sizing: border-box;
        }
        
        .store-info span {
            color: var(--gold);
            font-size: 0.9em;
            font-weight: bold;
        }
        
        /* å³ä¾§å¯¼èˆªç»„ */
        .nav-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        /* ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤ºæ ·å¼ */
        .user-info {
            background: var(--dark-gray);
            padding: 8px 15px;
            border-radius: 8px;
            height: 40px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-sizing: border-box;
        }
        
        .user-position {
            background: var(--gold);
            color: var(--black);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .user-name {
            color: var(--text-light);
            font-size: 0.9em;
            transition: all 0.2s ease;
        }
        
        .user-name:hover {
            background-color: rgba(212, 175, 55, 0.2);
            border-radius: 3px;
            padding: 2px 6px;
        }
        
        .user-name::after {
            content: ' â–¼';
            font-size: 0.8em;
            opacity: 0.7;
            margin-left: 5px;
        }
        
        /* è¯­è¨€åˆ‡æ¢æ ·å¼ */
        .language-switcher {
            display: flex;
            gap: 5px;
            background: var(--dark-gray);
            padding: 8px 15px;
            border-radius: 8px;
            height: 40px;
            align-items: center;
            box-sizing: border-box;
        }
        
        .language-btn {
            background: transparent;
            color: var(--text-light);
            border: 1px solid var(--gold);
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }
        
        .language-btn:hover {
            background: var(--gold);
            color: var(--black);
        }
        
        .language-btn.active {
            background: var(--gold);
            color: var(--black);
            font-weight: bold;
        }
        
        /* éšè—æ•°å­—è¾“å…¥æ¡†çš„ä¸Šä¸‹è°ƒèŠ‚æŒ‰é’® */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        input[type="number"] {
            -moz-appearance: textfield;
        }
        
        /* å›ºå®šè¡¨æ ¼å’Œè¾“å…¥æ¡†å°ºå¯¸ï¼Œé˜²æ­¢è¾“å…¥æ—¶å˜åŒ– */
        #productTable {
            table-layout: fixed;
            width: 100%;
        }
        
        #productTable th:nth-child(1) { width: 25%; }  /* äº§å“å */
        #productTable th:nth-child(2) { width: 18%; }  /* å•ä»· */
        #productTable th:nth-child(3) { width: 12%; }  /* æ•°é‡ */
        #productTable th:nth-child(4) { width: 12%; }  /* èµ é€ */
        #productTable th:nth-child(5) { width: 18%; }  /* æ€»é‡‘é¢ */
        #productTable th:nth-child(6) { width: 15%; }  /* æ“ä½œ */
        
        #productTable input {
            min-width: 0;
            max-width: 100%;
        }
        
        /* å›ºå®šæ¨¡æ€æ¡†å®½åº¦ */
        #transactionModal > div {
            min-width: 600px;
            max-width: 600px;
        }
        
        /* è‡ªå®šä¹‰æ—¥æœŸè¾“å…¥æ¡†æ ·å¼ */
        input[type="date"] {
            position: relative;
            background: var(--dark-gray);
            border: 1px solid var(--gold);
            color: var(--text-light);
            border-radius: 5px;
        }
        
        /* éšè—æµè§ˆå™¨é»˜è®¤çš„æ—¥æœŸæç¤ºæ–‡å­—ï¼ˆä¿æŒè¾“å…¥æ¡†ç»“æ„ï¼‰ */
        input[type="date"]::-webkit-inner-spin-button,
        input[type="date"]::-webkit-clear-button {
            display: none !important;
            -webkit-appearance: none !important;
        }
        
        /* å®Œå…¨éšè—æ‰€æœ‰æ—¥æœŸè¾“å…¥æ¡†çš„é»˜è®¤æ–‡å­—æ˜¾ç¤º */
        input[type="date"]::-webkit-datetime-edit,
        input[type="date"]::-webkit-datetime-edit-text,
        input[type="date"]::-webkit-datetime-edit-month-field,
        input[type="date"]::-webkit-datetime-edit-day-field,
        input[type="date"]::-webkit-datetime-edit-year-field {
            color: transparent !important;
            background: transparent !important;
        }
        
        /* å¼ºåˆ¶éšè—èšç„¦æ—¶çš„æ–‡å­—æ˜¾ç¤º */
        input[type="date"]:focus::-webkit-datetime-edit,
        input[type="date"]:focus::-webkit-datetime-edit-text,
        input[type="date"]:focus::-webkit-datetime-edit-month-field,
        input[type="date"]:focus::-webkit-datetime-edit-day-field,
        input[type="date"]:focus::-webkit-datetime-edit-year-field {
            color: transparent !important;
            background: transparent !important;
        }
        
        /* åªæœ‰åœ¨æœ‰æœ‰æ•ˆå€¼ä¸”ä¸æ˜¯ç„¦ç‚¹çŠ¶æ€æ—¶æ‰æ˜¾ç¤º */
        input[type="date"]:valid:not(:focus)::-webkit-datetime-edit,
        input[type="date"]:valid:not(:focus)::-webkit-datetime-edit-text,
        input[type="date"]:valid:not(:focus)::-webkit-datetime-edit-month-field,
        input[type="date"]:valid:not(:focus)::-webkit-datetime-edit-day-field,
        input[type="date"]:valid:not(:focus)::-webkit-datetime-edit-year-field {
            color: var(--text-light) !important;
        }
        
        /* è‡ªå®šä¹‰æ—¥æœŸé€‰æ‹©å™¨çš„å›¾æ ‡ */
        input[type="date"]::-webkit-calendar-picker-indicator {
            opacity: 0;
            position: absolute;
            right: 0;
            width: 30px;
            height: 100%;
            cursor: pointer;
        }
        
        /* æ—¥æœŸè¾“å…¥æ¡†focusçŠ¶æ€ */
        input[type="date"]:focus {
            border-color: var(--gold-light);
            box-shadow: 0 0 5px rgba(212, 175, 55, 0.3);
            outline: none;
        }
        
        /* è‡ªå®šä¹‰placeholderå®¹å™¨ */
        .date-input-wrapper {
            position: relative;
            display: inline-block;
        }
        
        /* è¦†ç›–å±‚éšè—é»˜è®¤æ–‡å­— */
        .date-input-wrapper::after {
            content: '';
            position: absolute;
            left: 1px;
            top: 1px;
            right: 28px;
            bottom: 1px;
            background: var(--dark-gray);
            pointer-events: none;
            z-index: 1;
            border-radius: 3px;
        }
        
        .date-input-wrapper.has-value::after,
        .date-input-wrapper.focused::after {
            display: none;
        }
        
        .date-input-wrapper::before {
            display: none !important;
        }
        
        .date-input-wrapper.has-value::before,
        .date-input-wrapper.focused::before {
            display: none;
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="top-nav">
        <!-- ä»£ç†åº—åç§°æ˜¾ç¤ºï¼ˆå·¦ä¾§ï¼‰ -->
        <div class="store-info">
            <span id="storeName" data-i18n="store-name">ë©”ì‹œì•„ì„œë¶€ì§€ì ê´€ë¦¬ì‹œìŠ¤í…œ</span>
        </div>
        
        <!-- å³ä¾§ä¿¡æ¯ç»„ -->
        <div class="nav-right">
            <!-- ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º -->
            <div class="user-info" id="userInfo" style="display: none;">
                <span id="userPosition" class="user-position"></span>
                <span id="userName" class="user-name" onclick="showUserMenu()" style="cursor: pointer; position: relative;"></span>
            </div>
            
            <!-- ä¸»é¢˜åˆ‡æ¢å™¨ -->
            <div class="theme-switcher" style="margin-right: 15px;">
                <button id="theme-toggle" onclick="toggleTheme()" style="background: none; border: 2px solid var(--gold); color: var(--gold); padding: 6px 10px; border-radius: 20px; cursor: pointer; font-size: 1.2em; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;" title="åˆ‡æ¢æ·±æµ…è‰²æ¨¡å¼">
                    <span id="theme-icon">ğŸŒ™</span>
                </button>
            </div>
            
            <!-- è¯­è¨€åˆ‡æ¢å™¨ -->
            <div class="language-switcher">
                <button class="language-btn active" onclick="switchLanguage('zh')" id="btn-zh">ä¸­æ–‡</button>
                <button class="language-btn" onclick="switchLanguage('ko')" id="btn-ko">í•œêµ­ì–´</button>
            </div>
        </div>
    </div>
    
    <div class="container" style="margin-top: 80px;">
        <div class="header">
            <div class="logo" onclick="goToHomePage()" title="ç‚¹å‡»è¿”å›é¦–é¡µ">M</div>
            <div class="subtitle">MAKE IT HAIR Professional</div>
        </div>
        
        <div id="main-menu" class="menu">
            <div class="menu-item" onclick="showSubmenu('employee')">
                <h2 data-i18n="employee-management">èŒå‘˜ç®¡ç†</h2>
                <p data-i18n="employee-management-desc">ç®¡ç†ä¸šåŠ¡å‘˜ä¿¡æ¯ã€æƒé™å’Œè´¦å·</p>
                <div id="employee-submenu" class="submenu">
                    <div class="submenu-item" onclick="showContent('new-employee', event)" id="new-employee-menu" style="display: none;">
                        <h3 data-i18n="new-employee">æ–°å¢èŒå‘˜</h3>
                        <p data-i18n="new-employee-desc">æ·»åŠ æ–°çš„ä¸šåŠ¡å‘˜è´¦å·</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('employee-list', event)">
                        <h3 data-i18n="employee-list">èŒå‘˜åˆ—è¡¨</h3>
                        <p data-i18n="employee-list-desc">æŸ¥çœ‹å’Œç¼–è¾‘èŒå‘˜ä¿¡æ¯</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('delete-employee', event)" id="delete-employee-menu" style="display: none;">
                        <h3 data-i18n="delete-employee">åˆ é™¤èŒå‘˜</h3>
                        <p data-i18n="delete-employee-desc">åˆ é™¤ä¸éœ€è¦çš„èŒå‘˜è´¦å·</p>
                    </div>
                </div>
            </div>
            
            <div class="menu-item" onclick="showSubmenu('customer')">
                <h2 data-i18n="customer-management">å®¢æˆ·ä¿¡æ¯ç®¡ç†</h2>
                <p data-i18n="customer-management-desc">ç®¡ç†å®¢æˆ·èµ„æ–™ã€äº¤æ˜“è®°å½•ã€æœåŠ¡å†å²ç­‰ä¿¡æ¯</p>
                <div id="customer-submenu" class="submenu">
                    <div class="submenu-item" onclick="showContent('new-salon', event)">
                        <h3 data-i18n="new-salon">æ–°å¢æ²™é¾™</h3>
                        <p data-i18n="new-salon-desc">æ·»åŠ æ–°çš„æ²™é¾™å®¢æˆ·ä¿¡æ¯</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('salon-info', event)">
                        <h3 data-i18n="salon-info">æ²™é¾™ä¿¡æ¯</h3>
                        <p data-i18n="salon-info-desc">æŸ¥çœ‹å’Œç¼–è¾‘ç°æœ‰æ²™é¾™ä¿¡æ¯</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('delete-salon', event)" id="delete-salon-menu" style="display: none;">
                        <h3 data-i18n="delete-salon">åˆ é™¤æ²™é¾™</h3>
                        <p data-i18n="delete-salon-desc">åˆ é™¤ä¸éœ€è¦çš„æ²™é¾™å®¢æˆ·</p>
                    </div>
                </div>
            </div>
            <div class="menu-item" onclick="showSubmenu('product')">
                <h2 data-i18n="product-management">äº§å“ä¿¡æ¯ç®¡ç†</h2>
                <p data-i18n="product-management-desc">ç®¡ç†ç¾å‘äº§å“ç›®å½•ã€åº“å­˜ã€ä»·æ ¼ç­‰ä¿¡æ¯</p>
                <div id="product-submenu" class="submenu">
                    <div class="submenu-item" onclick="showContent('add-product', event)">
                        <h3 data-i18n="add-product">æ–°å¢äº§å“</h3>
                        <p data-i18n="add-product-desc">æ·»åŠ æ–°çš„ç¾å‘äº§å“</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('product-list', event)">
                        <h3 data-i18n="product-list">äº§å“åˆ—è¡¨</h3>
                        <p data-i18n="product-list-desc">æŸ¥çœ‹æ‰€æœ‰äº§å“ä¿¡æ¯</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('product-category', event)">
                        <h3 data-i18n="product-category">äº§å“åˆ†ç±»</h3>
                        <p data-i18n="product-category-desc">ç®¡ç†äº§å“åˆ†ç±»</p>
                    </div>
                </div>
            </div>
            <div class="menu-item" onclick="showSubmenu('inventory')">
                <h2 data-i18n="inventory-management">åº“å­˜ä¿¡æ¯ç®¡ç†</h2>
                <p data-i18n="inventory-management-desc">è·Ÿè¸ªäº§å“åº“å­˜ã€è¡¥è´§é¢„è­¦ã€ä½¿ç”¨è®°å½•ç­‰</p>
                <div id="inventory-submenu" class="submenu">
                    <div class="submenu-item" onclick="showContent('stock-check', event)">
                        <h3 data-i18n="stock-check">åº“å­˜ç›˜ç‚¹</h3>
                        <p data-i18n="stock-check-desc">æ£€æŸ¥å½“å‰åº“å­˜çŠ¶æ€</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('restock-alert', event)">
                        <h3 data-i18n="restock-alert">è¡¥è´§æé†’</h3>
                        <p data-i18n="restock-alert-desc">è®¾ç½®åº“å­˜é¢„è­¦</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('usage-record', event)">
                        <h3 data-i18n="usage-record">ä½¿ç”¨è®°å½•</h3>
                        <p data-i18n="usage-record-desc">æŸ¥çœ‹äº§å“ä½¿ç”¨å†å²</p>
                    </div>
                </div>
            </div>
            <div class="menu-item" onclick="showSubmenu('finance')">
                <h2 data-i18n="finance-management">è´¢åŠ¡ä¿¡æ¯ç®¡ç†</h2>
                <p data-i18n="finance-management-desc">ç®¡ç†æ”¶æ”¯è®°å½•ã€æœåŠ¡æ”¶å…¥ã€äº§å“é”€å”®ç­‰</p>
                <div id="finance-submenu" class="submenu">
                    <div class="submenu-item" onclick="showContent('income-record', event)">
                        <h3 data-i18n="income-record">æ”¶å…¥è®°å½•</h3>
                        <p data-i18n="income-record-desc">è®°å½•æœåŠ¡å’Œé”€å”®æ”¶å…¥</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('expense-record', event)">
                        <h3 data-i18n="expense-record">æ”¯å‡ºè®°å½•</h3>
                        <p data-i18n="expense-record-desc">è®°å½•å„é¡¹æ”¯å‡º</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('financial-report', event)">
                        <h3 data-i18n="financial-report">è´¢åŠ¡æŠ¥è¡¨</h3>
                        <p data-i18n="financial-report-desc">ç”Ÿæˆè´¢åŠ¡åˆ†ææŠ¥å‘Š</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('performance-target', event)">
                        <h3 data-i18n="performance-target">ä¸šç»©ç›®æ ‡</h3>
                        <p data-i18n="performance-target-desc">ç®¡ç†ä¸ªäººå’Œå›¢é˜Ÿä¸šç»©ç›®æ ‡</p>
                    </div>
                </div>
            </div>
            
            <div class="menu-item" onclick="showSubmenu('audit')">
                <h2 data-i18n="audit-management">æ“ä½œå†å²ç®¡ç†</h2>
                <p data-i18n="audit-management-desc">ç®¡ç†ç³»ç»Ÿæ“ä½œè®°å½•ã€æ•°æ®å®¡è®¡å’Œå®‰å…¨ç›‘æ§</p>
                <div id="audit-submenu" class="submenu">
                    <div class="submenu-item" onclick="showContent('operation-history', event)">
                        <h3 data-i18n="operation-history">æ“ä½œå†å²è®°å½•</h3>
                        <p data-i18n="operation-history-desc">æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„æ“ä½œå†å²å’Œæ•°æ®å˜æ›´è®°å½•</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('data-comparison', event)">
                        <h3 data-i18n="data-comparison">æ•°æ®å¯¹æ¯”æŸ¥çœ‹</h3>
                        <p data-i18n="data-comparison-desc">å¯¹æ¯”æŸ¥çœ‹ä¿®æ”¹å‰åçš„æ•°æ®å˜åŒ–</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('audit-report', event)">
                        <h3 data-i18n="audit-report">å®¡è®¡æŠ¥å‘Š</h3>
                        <p data-i18n="audit-report-desc">ç”Ÿæˆæ“ä½œç»Ÿè®¡å’Œå®‰å…¨å®¡è®¡æŠ¥å‘Š</p>
                    </div>
                    <div class="submenu-item" onclick="showContent('approval-management', event)" id="approval-management-menu" style="display: none;">
                        <h3 data-i18n="approval-management">å®¡æ‰¹ç®¡ç†</h3>
                        <p data-i18n="approval-management-desc">å¤„ç†å¾…å®¡æ‰¹çš„æ“ä½œè¯·æ±‚</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- å†…å®¹æ˜¾ç¤ºåŒºåŸŸ -->
        <!-- èŒå‘˜ç®¡ç†é¡µé¢ -->
        <div id="new-employee" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="new-employee">æ–°å¢èŒå‘˜</h1>
            <form id="newEmployeeForm">
                <div style="margin-bottom: 20px;">
                    <label for="employeeName" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-name">å§“åï¼š</label>
                    <input type="text" id="employeeName" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="employeePosition" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-position">èŒä½ï¼š</label>
                    <select id="employeePosition" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                        <option value="salesperson" data-i18n="salesperson">ä¸šåŠ¡å‘˜</option>
                        <option value="manager" data-i18n="manager">ç»ç†</option>
                        <option value="admin" data-i18n="admin">ç®¡ç†å‘˜</option>
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="employeeUsername" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-username">ç™»å½•è´¦å·ï¼š</label>
                    <input type="text" id="employeeUsername" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="employeePassword" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-password">å¯†ç ï¼š</label>
                    <input type="password" id="employeePassword" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="employeeMobile" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-mobile">æ‰‹æœºå·ï¼š</label>
                    <input type="tel" id="employeeMobile" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                
                <!-- é“¶è¡Œè´¦æˆ·ä¿¡æ¯ -->
                <div style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); margin-bottom: 20px;">
                    <h3 style="color: var(--gold); margin: 0 0 15px 0;" data-i18n="bank-account-info">é“¶è¡Œè´¦æˆ·ä¿¡æ¯</h3>
                    <div style="margin-bottom: 15px;">
                        <label for="employeeBankName" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="bank-name">é“¶è¡Œåç§°ï¼š</label>
                        <input type="text" id="employeeBankName" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;" placeholder="ä¾‹ï¼šä¸­å›½é“¶è¡Œ">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label for="employeeAccountNumber" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="account-number">é“¶è¡Œè´¦å·ï¼š</label>
                        <input type="text" id="employeeAccountNumber" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label for="employeeAccountHolder" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="account-holder">è´¦æˆ·æŒæœ‰äººï¼š</label>
                        <input type="text" id="employeeAccountHolder" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;" placeholder="é»˜è®¤ä½¿ç”¨èŒå‘˜å§“å">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label for="employeeBankBranch" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="bank-branch">å¼€æˆ·æ”¯è¡Œï¼ˆé€‰å¡«ï¼‰ï¼š</label>
                        <input type="text" id="employeeBankBranch" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                    </div>
                </div>
                
                <button type="submit" style="background: var(--gold); color: var(--black); border: none; padding: 12px 30px; border-radius: 5px; cursor: pointer; font-size: 1.1em;" data-i18n="add">æ·»åŠ </button>
            </form>
        </div>
        
        <div id="employee-list" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="employee-list">èŒå‘˜åˆ—è¡¨</h1>
            <p data-i18n="employee-list-desc">è¿™é‡Œæ˜¾ç¤ºæ‰€æœ‰èŒå‘˜çš„è¯¦ç»†ä¿¡æ¯åˆ—è¡¨ã€‚</p>
            <div id="employee-list-content" style="margin-top: 20px;">
                <!-- èŒå‘˜åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div id="delete-employee" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="delete-employee">åˆ é™¤èŒå‘˜</h1>
            <p style="color: #ff6666; margin-bottom: 20px;" data-i18n="delete-warning">âš ï¸ åˆ é™¤æ“ä½œæ— æ³•æ’¤é”€ï¼Œè¯·è°¨æ…æ“ä½œï¼</p>
            <div style="background: rgba(255, 102, 102, 0.1); padding: 20px; border-radius: 5px; border: 1px solid #ff6666;">
                <h3 style="color: #ff6666;" data-i18n="select-employee-to-delete">é€‰æ‹©è¦åˆ é™¤çš„èŒå‘˜</h3>
                <select id="deleteEmployeeSelect" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid #ff6666; color: var(--text-light); border-radius: 5px; margin: 10px 0;">
                    <option value="" data-i18n="please-select-employee">è¯·é€‰æ‹©èŒå‘˜...</option>
                </select>
                <button onclick="deleteSelectedEmployee()" style="background: #ff6666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;" data-i18n="confirm-delete">ç¡®è®¤åˆ é™¤</button>
            </div>
        </div>
        
        <div id="new-salon" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="new-salon">æ–°å¢æ²™é¾™</h1>
            
            <!-- æ‰¹é‡ä¸Šä¼ åŠŸèƒ½ï¼ˆä»…ç®¡ç†å‘˜å’Œç»ç†å¯è§ï¼‰ -->
            <div id="batch-upload-section" style="display: none; background: rgba(135, 206, 235, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(135, 206, 235, 0.3); margin-bottom: 30px;">
                <h3 style="color: #87CEEB; margin: 0 0 15px 0;" data-i18n="batch-upload-salons">æ‰¹é‡ä¸Šä¼ æ²™é¾™</h3>
                <p style="color: #cccccc; font-size: 0.9em; margin-bottom: 15px;" data-i18n="batch-upload-description">
                    ä¸Šä¼ åŒ…å«æ²™é¾™ä¿¡æ¯çš„Excelè¡¨æ ¼æ–‡ä»¶ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è§£æ"ì—…ì†Œëª…"å’Œ"ì˜ì—…ì†Œ ì£¼ì†Œ"åˆ—ï¼Œå¹¶æ ¹æ®åœ°å€å…³é”®å­—è‡ªåŠ¨è®¾ç½®åŒºåŸŸã€‚
                </p>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; color: #87CEEB; margin-bottom: 5px;" data-i18n="select-file">é€‰æ‹©æ–‡ä»¶ï¼š</label>
                    <!-- éšè—åŸç”Ÿæ–‡ä»¶è¾“å…¥æ¡† -->
                    <input type="file" id="salon-file-upload" accept=".xlsx,.xls" style="display: none;">
                    <!-- è‡ªå®šä¹‰æ–‡ä»¶ä¸Šä¼ æ§ä»¶ -->
                    <div style="position: relative; width: 100%;">
                        <button type="button" onclick="document.getElementById('salon-file-upload').click()" style="width: 100%; padding: 8px 12px; background: var(--dark-gray); border: 1px solid #87CEEB; color: var(--text-light); border-radius: 5px; text-align: left; cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                            <span id="file-upload-text" data-i18n="choose-file">é€‰æ‹©æ–‡ä»¶</span>
                            <span style="color: #87CEEB;">ğŸ“</span>
                        </button>
                        <div id="selected-file-name" style="margin-top: 5px; color: #4CAF50; font-size: 0.9em; display: none;"></div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button type="button" onclick="processSalonFile()" style="background: #87CEEB; color: var(--black); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="process-file">å¤„ç†æ–‡ä»¶</button>
                    <button type="button" onclick="downloadSampleFile()" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="download-sample">ä¸‹è½½æ ·ä¾‹æ¨¡æ¿</button>
                </div>
                
                <!-- é¢„è§ˆåŒºåŸŸ -->
                <div id="file-preview" style="margin-top: 20px; display: none;">
                    <h4 style="color: #87CEEB;" data-i18n="preview-data">æ•°æ®é¢„è§ˆï¼š</h4>
                    <div id="preview-table" style="max-height: 300px; overflow-y: auto; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px; margin-bottom: 15px;"></div>
                    
                    <!-- æ‰¹é‡åˆ›å»ºè¿›åº¦æ¡ -->
                    <div id="batch-progress-container" style="display: none; margin: 15px 0; padding: 15px; background: rgba(212, 175, 55, 0.1); border-radius: 5px; border: 1px solid rgba(212, 175, 55, 0.3);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span style="color: var(--gold); font-weight: bold;" id="batch-progress-text">æ­£åœ¨åˆ›å»ºæ²™é¾™...</span>
                            <span style="color: var(--text-light);" id="batch-progress-count">0/0</span>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); height: 20px; border-radius: 10px; overflow: hidden; margin-bottom: 10px;">
                            <div id="batch-progress-bar" style="height: 100%; background: linear-gradient(90deg, var(--gold), #FFD700); width: 0%; transition: width 0.3s ease; display: flex; align-items: center; justify-content: center;">
                                <span id="batch-progress-percent" style="color: var(--black); font-weight: bold; font-size: 0.8em;">0%</span>
                            </div>
                        </div>
                        <div style="color: #cccccc; font-size: 0.9em;" id="batch-progress-status">å‡†å¤‡å¼€å§‹...</div>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button type="button" id="confirm-batch-btn" onclick="confirmBatchCreate()" style="background: var(--gold); color: var(--black); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="confirm-batch-create">ç¡®è®¤æ‰¹é‡åˆ›å»º</button>
                        <button type="button" onclick="cancelBatchUpload()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="cancel">å–æ¶ˆ</button>
                    </div>
                </div>
            </div>
            
            <form id="newSalonForm">
                <div style="margin-bottom: 20px;">
                    <label for="salonName" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salon-name">æ²™é¾™åç§°ï¼š</label>
                    <input type="text" id="salonName" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="salonAddress" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salon-address">æ²™é¾™åœ°å€ï¼š</label>
                    <input type="text" id="salonAddress" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="businessLicense" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="business-license">è¥ä¸šæ‰§ç…§å·ç ï¼š</label>
                    <input type="text" id="businessLicense" maxlength="14" oninput="formatBusinessLicense(this)" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;" placeholder="000-00-00000">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="salonDistrict" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salon-district">æ²™é¾™åŒºåŸŸï¼š</label>
                    <select id="salonDistrict" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                        <option value="" data-i18n="please-select-district">è¯·é€‰æ‹©åŒºåŸŸ...</option>
                        <option value="guro" data-i18n="guro-district">ä¹è€åŒº</option>
                        <option value="yeongdeungpo" data-i18n="yeongdeungpo-district">æ°¸ç™»æµ¦åŒº</option>
                        <option value="geumcheon" data-i18n="geumcheon-district">è¡¿å·åŒº</option>
                        <option value="overseas" data-i18n="overseas-district">æµ·å¤–åŒºåŸŸ</option>
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="responsibleEmployee" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="responsible-employee">è´Ÿè´£èŒå‘˜ï¼š</label>
                    <select id="responsibleEmployee" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                        <option value="" data-i18n="please-select-employee">è¯·é€‰æ‹©èŒå‘˜...</option>
                    </select>
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="salonPhone" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salon-phone">åº—é“ºç”µè¯ï¼š</label>
                    <input type="tel" id="salonPhone" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="directorName" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="director-name">é™¢é•¿å§“åï¼š</label>
                    <input type="text" id="directorName" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label for="directorMobile" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="director-mobile">æ‰‹æœºï¼š</label>
                    <input type="tel" id="directorMobile" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                </div>
                <button type="submit" style="background: var(--gold); color: var(--black); border: none; padding: 12px 30px; border-radius: 5px; cursor: pointer; font-size: 1.1em;" data-i18n="add">æ·»åŠ </button>
            </form>
        </div>
        
        <div id="salon-info" class="content-area">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <label style="color: var(--gold); white-space: nowrap;" data-i18n="filter-by-responsible">æŒ‰è´Ÿè´£äººå‘˜ï¼š</label>
                    <select id="responsible-filter" onchange="filterSalons()" style="padding: 8px 12px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                        <option value="" data-i18n="all-employees">å…¨éƒ¨äººå‘˜</option>
                    </select>
                    <label style="color: var(--gold); white-space: nowrap;" data-i18n="filter-by-district">æŒ‰åŒºåŸŸç­›é€‰ï¼š</label>
                    <select id="district-filter" onchange="filterSalons()" style="padding: 8px 12px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                        <option value="" data-i18n="all-districts">å…¨éƒ¨åŒºåŸŸ</option>
                        <option value="guro" data-i18n="guro-district">ä¹è€åŒº</option>
                        <option value="yeongdeungpo" data-i18n="yeongdeungpo-district">æ°¸ç™»æµ¦åŒº</option>
                        <option value="geumcheon" data-i18n="geumcheon-district">è¡¿å·åŒº</option>
                        <option value="overseas" data-i18n="overseas-district">æµ·å¤–åŒºåŸŸ</option>
                    </select>
                    <input type="text" id="salon-search" placeholder="æœç´¢æ²™é¾™åã€é™¢é•¿åæˆ–æ‰‹æœºå·..." style="padding: 8px 12px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; width: 250px;" onkeyup="searchSalons()" data-i18n-placeholder="search-salon-placeholder">
                    <button onclick="clearSearch()" style="background: var(--gold); color: var(--black); border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;" data-i18n="clear-search">æ¸…ç©º</button>
                </div>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h1 data-i18n="salon-info" style="margin: 0;">æ²™é¾™ä¿¡æ¯</h1>
                <div id="batch-controls" style="display: flex; gap: 10px; align-items: center;">
                    <label style="display: flex; align-items: center; gap: 5px; color: var(--gold); cursor: pointer;">
                        <input type="checkbox" id="select-all-salons" onchange="toggleSelectAllSalons()" style="cursor: pointer;">
                        <span data-i18n="select-all">å…¨é€‰</span>
                    </label>
                    <button id="batch-delete-btn" onclick="batchDeleteSalons()" disabled style="background: #ff6666; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: not-allowed; font-size: 0.9em; opacity: 0.6;" data-i18n="batch-delete">æ‰¹é‡åˆ é™¤</button>
                    <button id="batch-assign-btn" onclick="showBatchAssignModal()" disabled style="background: var(--gold); color: var(--black); border: none; padding: 6px 12px; border-radius: 4px; cursor: not-allowed; font-size: 0.9em; opacity: 0.6;" data-i18n="batch-assign">æ‰¹é‡æŒ‡å®šè´Ÿè´£äºº</button>
                    <span id="selected-count" style="color: #cccccc; font-size: 0.9em;" data-i18n="selected-count">å·²é€‰æ‹© 0 ä¸ªæ²™é¾™</span>
                </div>
            </div>
            <p data-i18n="salon-info-list-desc">è¿™é‡Œæ˜¾ç¤ºæ‰€æœ‰å·²æ·»åŠ çš„æ²™é¾™è¯¦ç»†ä¿¡æ¯åˆ—è¡¨ã€‚</p>
            <div id="salon-count-display" style="margin: 15px 0; padding: 10px; background: rgba(212, 175, 55, 0.1); border-radius: 5px; border: 1px solid rgba(212, 175, 55, 0.3);">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: var(--gold); font-weight: bold; font-size: 1.1em;" id="salon-count-text" data-i18n="total-salons-count" data-i18n-params='{"count": "0"}'>æ€»è®¡ 0 å®¶æ²™é¾™</span>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <button onclick="displaySalonList(null)" style="background: rgba(212, 175, 55, 0.2); color: var(--gold); border: 1px solid var(--gold); padding: 4px 12px; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(212, 175, 55, 0.4)'" onmouseout="this.style.background='rgba(212, 175, 55, 0.2)'" data-i18n="all-districts">å…¨éƒ¨åŒºåŸŸ</button>
                        <button onclick="displaySalonList('guro')" style="background: rgba(212, 175, 55, 0.2); color: var(--gold); border: 1px solid var(--gold); padding: 4px 12px; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(212, 175, 55, 0.4)'" onmouseout="this.style.background='rgba(212, 175, 55, 0.2)'" data-i18n="district-guro">ä¹è€åŒº</button>
                        <button onclick="displaySalonList('yeongdeungpo')" style="background: rgba(212, 175, 55, 0.2); color: var(--gold); border: 1px solid var(--gold); padding: 4px 12px; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(212, 175, 55, 0.4)'" onmouseout="this.style.background='rgba(212, 175, 55, 0.2)'" data-i18n="district-yeongdeungpo">æ°¸ç™»æµ¦åŒº</button>
                        <button onclick="displaySalonList('geumcheon')" style="background: rgba(212, 175, 55, 0.2); color: var(--gold); border: 1px solid var(--gold); padding: 4px 12px; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(212, 175, 55, 0.4)'" onmouseout="this.style.background='rgba(212, 175, 55, 0.2)'" data-i18n="district-geumcheon">è¡¿å·åŒº</button>
                        <button onclick="displaySalonList('overseas')" style="background: rgba(212, 175, 55, 0.2); color: var(--gold); border: 1px solid var(--gold); padding: 4px 12px; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(212, 175, 55, 0.4)'" onmouseout="this.style.background='rgba(212, 175, 55, 0.2)'" data-i18n="district-other">í•´ì™¸ì§€ì—­</button>
                    </div>
                </div>
            </div>
            
            <!-- æ’åºæ§ä»¶ -->
            <div id="salon-sort-controls" style="margin: 15px 0; padding: 15px; background: rgba(135, 206, 235, 0.1); border-radius: 5px; border: 1px solid rgba(135, 206, 235, 0.3);">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                    <div style="display: flex; align-items: center; gap: 10px; color: #87CEEB;">
                        <span style="font-weight: bold; font-size: 1em;" data-i18n="sort-by">æ’åºæ–¹å¼ï¼š</span>
                    </div>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        <button id="sort-name" onclick="toggleSalonSort('name')" style="background: rgba(135, 206, 235, 0.2); color: #87CEEB; border: 1px solid #87CEEB; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(135, 206, 235, 0.4)'" onmouseout="updateSortButtonStyle(this)" data-i18n="sort-name">æ²™é¾™åç§° â†‘</button>
                        <button id="sort-address" onclick="toggleSalonSort('address')" style="background: rgba(135, 206, 235, 0.2); color: #87CEEB; border: 1px solid #87CEEB; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(135, 206, 235, 0.4)'" onmouseout="updateSortButtonStyle(this)" data-i18n="sort-address">åœ°å€åç§° â†‘</button>
                        <button id="sort-addTime" onclick="toggleSalonSort('addTime')" style="background: rgba(135, 206, 235, 0.2); color: #87CEEB; border: 1px solid #87CEEB; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(135, 206, 235, 0.4)'" onmouseout="updateSortButtonStyle(this)" data-i18n="sort-add-time">æ–°å¢æ—¶é—´ â†‘</button>
                        <button id="sort-lastTransaction" onclick="toggleSalonSort('lastTransaction')" style="background: rgba(135, 206, 235, 0.2); color: #87CEEB; border: 1px solid #87CEEB; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(135, 206, 235, 0.4)'" onmouseout="updateSortButtonStyle(this)" data-i18n="sort-last-transaction">æœ€åäº¤æ˜“ â†‘</button>
                        <button id="sort-outstandingDays" onclick="toggleSalonSort('outstandingDays')" style="background: rgba(135, 206, 235, 0.2); color: #87CEEB; border: 1px solid #87CEEB; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(135, 206, 235, 0.4)'" onmouseout="updateSortButtonStyle(this)" data-i18n="sort-outstanding-days">æ¬ æ¬¾å¤©æ•° â†‘</button>
                        <button id="sort-outstandingAmount" onclick="toggleSalonSort('outstandingAmount')" style="background: rgba(135, 206, 235, 0.2); color: #87CEEB; border: 1px solid #87CEEB; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(135, 206, 235, 0.4)'" onmouseout="updateSortButtonStyle(this)" data-i18n="sort-outstanding-amount">æ¬ æ¬¾é‡‘é¢ â†‘</button>
                        <button id="sort-default" onclick="resetSalonSort()" style="background: rgba(255, 182, 193, 0.2); color: #FFB6C1; border: 1px solid #FFB6C1; padding: 6px 12px; border-radius: 15px; cursor: pointer; font-size: 0.9em; transition: all 0.3s;" onmouseover="this.style.background='rgba(255, 182, 193, 0.4)'" onmouseout="updateSortButtonStyle(this)" data-i18n="sort-default">é»˜è®¤æ’åº</button>
                    </div>
                </div>
            </div>
            <div id="salon-list" style="margin-top: 20px;">
                <!-- æ²™é¾™åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div id="delete-salon" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="delete-salon">åˆ é™¤æ²™é¾™</h1>
            <p style="color: #ff6666; margin-bottom: 20px;" data-i18n="delete-warning">âš ï¸ åˆ é™¤æ“ä½œæ— æ³•æ’¤é”€ï¼Œè¯·è°¨æ…æ“ä½œï¼</p>
            
            <!-- ç­›é€‰å’Œæœç´¢æ¡† -->
            <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 20px;">
                <label style="color: var(--gold);" data-i18n="filter-by-district">æŒ‰åŒºåŸŸç­›é€‰ï¼š</label>
                <select id="delete-district-filter" onchange="filterDeleteSalonList()" style="padding: 8px 12px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                    <option value="" data-i18n="all-districts">å…¨éƒ¨åŒºåŸŸ</option>
                    <option value="guro" data-i18n="guro-district">ä¹è€åŒº</option>
                    <option value="yeongdeungpo" data-i18n="yeongdeungpo-district">æ°¸ç™»æµ¦åŒº</option>
                    <option value="geumcheon" data-i18n="geumcheon-district">è¡¿å·åŒº</option>
                    <option value="overseas" data-i18n="overseas-district">æµ·å¤–åŒºåŸŸ</option>
                </select>
                <input type="text" id="delete-salon-search" placeholder="æœç´¢æ²™é¾™åã€é™¢é•¿åæˆ–æ‰‹æœºå·..." style="padding: 8px 12px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; width: 250px;" onkeyup="searchDeleteSalons()" data-i18n-placeholder="search-salon-placeholder">
                <button onclick="clearDeleteSearch()" style="background: #666; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;" data-i18n="clear-search">æ¸…ç©º</button>
            </div>
            
            <div style="background: rgba(255, 102, 102, 0.1); padding: 20px; border-radius: 5px; border: 1px solid #ff6666;">
                <h3 style="color: #ff6666;" data-i18n="select-salon-to-delete">é€‰æ‹©è¦åˆ é™¤çš„æ²™é¾™</h3>
                <select id="deleteSalonSelect" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid #ff6666; color: var(--text-light); border-radius: 5px; margin: 10px 0;">
                    <option value="" data-i18n="please-select-salon">è¯·é€‰æ‹©æ²™é¾™...</option>
                </select>
                <button onclick="deleteSelectedSalon()" style="background: #ff6666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;" data-i18n="confirm-delete">ç¡®è®¤åˆ é™¤</button>
            </div>
        </div>
        
        <!-- å…¶ä»–å†…å®¹åŒºåŸŸå¯ä»¥ç±»ä¼¼åœ°æ·»åŠ  -->
        <div id="add-product" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="add-product">æ–°å¢äº§å“</h1>
            <p data-i18n="add-product-content">åœ¨è¿™é‡Œæ·»åŠ æ–°çš„ç¾å‘äº§å“ä¿¡æ¯...</p>
        </div>
        
        <div id="product-list" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="product-list">äº§å“åˆ—è¡¨</h1>
            <p data-i18n="product-list-content">æ˜¾ç¤ºæ‰€æœ‰äº§å“çš„åˆ—è¡¨...</p>
        </div>
        
        <div id="product-category" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="product-category">äº§å“åˆ†ç±»</h1>
            <p data-i18n="product-category-content">ç®¡ç†äº§å“åˆ†ç±»ä¿¡æ¯...</p>
        </div>
        
        <div id="stock-check" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="stock-check">åº“å­˜ç›˜ç‚¹</h1>
            <p data-i18n="stock-check-content">è¿›è¡Œåº“å­˜ç›˜ç‚¹æ“ä½œ...</p>
        </div>
        
        <div id="restock-alert" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="restock-alert">è¡¥è´§æé†’</h1>
            <p data-i18n="restock-alert-content">è®¾ç½®å’ŒæŸ¥çœ‹è¡¥è´§æé†’...</p>
        </div>
        
        <div id="usage-record" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="usage-record">ä½¿ç”¨è®°å½•</h1>
            <p data-i18n="usage-record-content">æŸ¥çœ‹äº§å“ä½¿ç”¨è®°å½•...</p>
        </div>
        
        <div id="income-record" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="income-record">æ”¶å…¥è®°å½•</h1>
            <p data-i18n="income-record-content">è®°å½•å’ŒæŸ¥çœ‹æ”¶å…¥ä¿¡æ¯...</p>
        </div>
        
        <div id="expense-record" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="expense-record">æ”¯å‡ºè®°å½•</h1>
            <p data-i18n="expense-record-content">è®°å½•å’ŒæŸ¥çœ‹æ”¯å‡ºä¿¡æ¯...</p>
        </div>
        
        <div id="financial-report" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="financial-report">è´¢åŠ¡æŠ¥è¡¨</h1>
            <p data-i18n="financial-report-content">ç”Ÿæˆå’ŒæŸ¥çœ‹è´¢åŠ¡æŠ¥è¡¨...</p>
        </div>
        
        <!-- ä¸šç»©ç›®æ ‡é¡µé¢ -->
        <div id="performance-target" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="performance-target">ä¸šç»©ç›®æ ‡</h1>
            
            <!-- å½“å‰æœˆä»½é€‰æ‹© -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <div style="display: flex; gap: 15px; align-items: center;">
                    <label style="color: var(--gold); font-weight: bold;" data-i18n="select-month">é€‰æ‹©æœˆä»½ï¼š</label>
                    <select id="performance-month" onchange="displayPerformanceTargets()" style="padding: 8px 12px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                        <!-- æœˆä»½é€‰é¡¹å°†åŠ¨æ€ç”Ÿæˆ -->
                    </select>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button onclick="recalculatePerformanceTargets()" style="background: var(--gold); color: var(--black); border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;" data-i18n="recalculate-targets">é‡æ–°è®¡ç®—ç›®æ ‡</button>
                    <button onclick="resetPerformanceTargets()" style="background: #ff6666; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;" data-i18n="reset-targets">é‡ç½®ç›®æ ‡</button>
                </div>
            </div>
            
            <!-- å›¢é˜Ÿæ€»ç›®æ ‡ -->
            <div style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); margin-bottom: 30px;">
                <h2 style="color: var(--gold); margin: 0 0 20px 0; text-align: center;" data-i18n="team-target">ä»£ç†åº—è¥ä¸šé¢ç›®æ ‡</h2>
                <div style="display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; align-items: center;">
                    <div style="text-align: center;">
                        <div style="color: #cccccc; font-size: 0.9em; margin-bottom: 5px;" data-i18n="target-label">ç›®æ ‡</div>
                        <div id="team-target-amount" style="font-size: 1.8em; color: var(--gold); font-weight: bold;">0</div>
                        <div style="color: #aaa; font-size: 0.8em;" data-i18n="thousand-won">åƒéŸ©å…ƒ</div>
                    </div>
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: #cccccc;" data-i18n="actual-label">å®é™…</span>
                            <span id="team-progress-text" style="color: var(--gold); font-weight: bold;">0%</span>
                        </div>
                        <div style="background: rgba(0,0,0,0.3); height: 20px; border-radius: 10px; overflow: hidden;">
                            <div id="team-progress-bar" style="height: 100%; background: linear-gradient(90deg, #4CAF50, #8BC34A); width: 0%; transition: width 0.3s ease;"></div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8em; color: #aaa;">
                            <span>0</span>
                            <span id="team-target-display">0</span>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: #cccccc; font-size: 0.9em; margin-bottom: 5px;" data-i18n="actual-label">å®é™…</div>
                        <div id="team-actual-amount" style="font-size: 1.8em; color: #4CAF50; font-weight: bold;">0</div>
                        <div style="color: #aaa; font-size: 0.8em;" data-i18n="thousand-won">åƒéŸ©å…ƒ</div>
                    </div>
                </div>
            </div>
            
            <!-- ä¸ªäººä¸šç»©ç›®æ ‡åˆ—è¡¨ -->
            <div id="performance-list" style="margin-top: 20px;">
                <!-- ä¸ªäººä¸šç»©ç›®æ ‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- æ“ä½œå†å²è®°å½•é¡µé¢ -->
        <div id="operation-history" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="operation-history">æ“ä½œå†å²è®°å½•</h1>
            
            <!-- ç­›é€‰æ§ä»¶ -->
            <div style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 5px; margin-bottom: 20px; border: 1px solid rgba(212, 175, 55, 0.3);">
                <!-- ç¬¬ä¸€è¡Œï¼š3ä¸ªä¸‹æ‹‰ç­›é€‰ -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="filter-by-user">æŒ‰ç”¨æˆ·ç­›é€‰ï¼š</label>
                        <select id="history-user-filter" onchange="filterOperationHistory()" style="width: 100%; padding: 8px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                            <option value="" data-i18n="all-users">å…¨éƒ¨ç”¨æˆ·</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="filter-by-operation">æŒ‰æ“ä½œç±»å‹ï¼š</label>
                        <select id="history-operation-filter" onchange="filterOperationHistory()" style="width: 100%; padding: 8px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                            <option value="" data-i18n="all-operations">å…¨éƒ¨æ“ä½œ</option>
                            <option value="create" data-i18n="operation-create">åˆ›å»º</option>
                            <option value="edit" data-i18n="operation-edit">ç¼–è¾‘</option>
                            <option value="delete" data-i18n="operation-delete">åˆ é™¤</option>
                            <option value="login" data-i18n="operation-login">ç™»å½•</option>
                            <option value="logout" data-i18n="operation-logout">ç™»å‡º</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="filter-by-object">æŒ‰å¯¹è±¡ç±»å‹ï¼š</label>
                        <select id="history-object-filter" onchange="filterOperationHistory()" style="width: 100%; padding: 8px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                            <option value="" data-i18n="all-objects">å…¨éƒ¨å¯¹è±¡</option>
                            <option value="salon" data-i18n="object-salon">æ²™é¾™</option>
                            <option value="transaction" data-i18n="object-transaction">äº¤æ˜“</option>
                            <option value="employee" data-i18n="object-employee">èŒå‘˜</option>
                        </select>
                    </div>
                </div>
                <!-- ç¬¬äºŒè¡Œï¼šæ—¥æœŸç­›é€‰å’Œæ¸…ç©ºæŒ‰é’® -->
                <div style="display: flex; gap: 15px; align-items: end; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 300px;">
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="filter-by-date">æŒ‰æ—¥æœŸç­›é€‰ï¼š</label>
                        <div style="display: flex; gap: 8px;">
                            <div class="date-input-wrapper" style="flex: 1;">
                                <input type="date" id="history-start-date" lang="zh-CN" onchange="filterOperationHistory()" style="width: 100%; padding: 8px; padding-right: 30px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                                <span style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: var(--gold); font-size: 12px; pointer-events: none; z-index: 2;">â–¼</span>
                            </div>
                            <span style="color: var(--gold); align-self: center; white-space: nowrap;" data-i18n="to">è‡³</span>
                            <div class="date-input-wrapper" style="flex: 1;">
                                <input type="date" id="history-end-date" lang="zh-CN" onchange="filterOperationHistory()" style="width: 100%; padding: 8px; padding-right: 30px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                                <span style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: var(--gold); font-size: 12px; pointer-events: none; z-index: 2;">â–¼</span>
                            </div>
                        </div>
                    </div>
                    <div style="flex-shrink: 0;">
                        <button onclick="clearHistoryFilters()" style="min-width: 120px; background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; white-space: nowrap;" data-i18n="clear-all-filters">æ¸…ç©ºç­›é€‰</button>
                    </div>
                </div>
            </div>
            
            <div id="operation-history-list" style="margin-top: 20px;">
                <!-- æ“ä½œå†å²è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- æ•°æ®å¯¹æ¯”æŸ¥çœ‹é¡µé¢ -->
        <div id="data-comparison" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="data-comparison">æ•°æ®å¯¹æ¯”æŸ¥çœ‹</h1>
            <div id="comparison-content" style="margin-top: 20px;">
                <p style="color: #cccccc; text-align: center; padding: 40px;" data-i18n="select-history-record">è¯·ä»æ“ä½œå†å²è®°å½•ä¸­é€‰æ‹©è¦å¯¹æ¯”çš„è®°å½•</p>
            </div>
        </div>
        
        <!-- å®¡è®¡æŠ¥å‘Šé¡µé¢ -->
        <div id="audit-report" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="audit-report">å®¡è®¡æŠ¥å‘Š</h1>
            
            <!-- æŠ¥å‘Šç»Ÿè®¡ -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                <div style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3); text-align: center;">
                    <h3 style="color: var(--gold); margin: 0 0 10px 0;" data-i18n="total-operations">æ€»æ“ä½œæ•°</h3>
                    <div id="total-operations-count" style="font-size: 2em; color: var(--text-light); font-weight: bold;">0</div>
                </div>
                <div style="background: rgba(144, 238, 144, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(144, 238, 144, 0.3); text-align: center;">
                    <h3 style="color: #90EE90; margin: 0 0 10px 0;" data-i18n="today-operations">ä»Šæ—¥æ“ä½œ</h3>
                    <div id="today-operations-count" style="font-size: 2em; color: var(--text-light); font-weight: bold;">0</div>
                </div>
                <div style="background: rgba(135, 206, 235, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(135, 206, 235, 0.3); text-align: center;">
                    <h3 style="color: #87CEEB; margin: 0 0 10px 0;" data-i18n="active-users">æ´»è·ƒç”¨æˆ·</h3>
                    <div id="active-users-count" style="font-size: 2em; color: var(--text-light); font-weight: bold;">0</div>
                </div>
                <div style="background: rgba(255, 182, 193, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(255, 182, 193, 0.3); text-align: center;">
                    <h3 style="color: #FFB6C1; margin: 0 0 10px 0;" data-i18n="critical-operations">é‡è¦æ“ä½œ</h3>
                    <div id="critical-operations-count" style="font-size: 2em; color: var(--text-light); font-weight: bold;">0</div>
                </div>
            </div>
            
            <div id="audit-report-content" style="margin-top: 20px;">
                <!-- å®¡è®¡æŠ¥å‘Šå†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- å®¡æ‰¹ç®¡ç†é¡µé¢ -->
        <div id="approval-management" class="content-area">
            <button class="back-button" onclick="backToMenu()" data-i18n="back-to-main">è¿”å›ä¸»èœå•</button>
            <h1 data-i18n="approval-management">å®¡æ‰¹ç®¡ç†</h1>
            
            <div class="approval-controls" style="margin-bottom: 20px; padding: 20px; background: rgba(212, 175, 55, 0.1); border-radius: 8px; border: 1px solid rgba(212, 175, 55, 0.3);">
                <div style="display: flex; gap: 20px; align-items: center;">
                    <div>
                        <label for="approvalStatusFilter" style="color: var(--gold); margin-right: 10px;" data-i18n="status">çŠ¶æ€ï¼š</label>
                        <select id="approvalStatusFilter" onchange="displayApprovalList()" style="padding: 8px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                            <option value="" data-i18n="all-status">å…¨éƒ¨çŠ¶æ€</option>
                            <option value="pending" data-i18n="pending">å¾…å®¡æ‰¹</option>
                            <option value="approved" data-i18n="approved">å·²æ‰¹å‡†</option>
                            <option value="rejected" data-i18n="rejected">å·²æ‹’ç»</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="approval-list" id="approvalList">
                <!-- å®¡æ‰¹åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- äº¤æ˜“è®°å½•åˆ—è¡¨é¡µé¢ -->
        <div id="transaction-list" class="content-area">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button class="back-button" onclick="backToSalonInfo()" data-i18n="back-to-salon-info">è¿”å›æ²™é¾™ä¿¡æ¯</button>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <label style="color: var(--gold);" data-i18n="filter-by-date">æŒ‰æ—¥æœŸç­›é€‰ï¼š</label>
                    <div class="date-input-wrapper">
                        <input type="date" id="start-date" lang="zh-CN" style="padding: 5px; padding-right: 25px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 3px; box-sizing: border-box;">
                        <span style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: var(--gold); font-size: 10px; pointer-events: none; z-index: 2;">â–¼</span>
                    </div>
                    <span style="color: var(--gold);" data-i18n="to">è‡³</span>
                    <div class="date-input-wrapper">
                        <input type="date" id="end-date" lang="zh-CN" style="padding: 5px; padding-right: 25px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 3px; box-sizing: border-box;">
                        <span style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: var(--gold); font-size: 10px; pointer-events: none; z-index: 2;">â–¼</span>
                    </div>
                    <button onclick="filterTransactions()" style="background: var(--gold); color: var(--black); border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;" data-i18n="filter">ç­›é€‰</button>
                    <button onclick="clearDateFilter()" style="background: #666; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;" data-i18n="clear-filter">æ¸…ç©ºç­›é€‰</button>
                </div>
            </div>
            <h1 id="transaction-list-title" data-i18n="transaction-records">äº¤æ˜“è®°å½•</h1>
            <div id="transaction-records" style="margin-top: 20px;">
                <!-- äº¤æ˜“è®°å½•å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- äº¤æ˜“è¯¦æƒ…é¡µé¢ -->
        <div id="transaction-detail" class="content-area">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button class="back-button" onclick="backToTransactionList()" data-i18n="back-to-transaction-list">è¿”å›äº¤æ˜“è®°å½•</button>
                <button onclick="printTransaction()" style="background: var(--gold); color: var(--black); border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;" data-i18n="print">æ‰“å°</button>
            </div>
            <h1 data-i18n="transaction-detail">äº¤æ˜“è¯¦æƒ…</h1>
            <div id="transaction-detail-content" style="margin-top: 20px;">
                <!-- äº¤æ˜“è¯¦æƒ…å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="footer">
            Â© 2025 MAKE IT HAIR Professional. All rights reserved.
                </div>

        <!-- æ‰¹é‡æŒ‡å®šè´Ÿè´£äººæ¨¡æ€æ¡† -->
        <div id="batchAssignModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
            <div style="background: var(--dark-gray); padding: 30px; border-radius: 10px; border: 1px solid var(--gold); width: 500px; max-width: 95vw; max-height: 95vh; overflow-y: auto;">
                <h2 style="color: var(--gold); margin-top: 0;" data-i18n="batch-assign-responsible">æ‰¹é‡æŒ‡å®šè´Ÿè´£äºº</h2>
                <form id="batchAssignForm">
                    <div style="margin-bottom: 20px;">
                        <label for="batchAssignEmployee" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="select-responsible-employee">é€‰æ‹©è´Ÿè´£èŒå‘˜ï¼š</label>
                        <select id="batchAssignEmployee" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                            <option value="" data-i18n="please-select-employee">è¯·é€‰æ‹©èŒå‘˜...</option>
                        </select>
                    </div>
                    
                    <div style="background: rgba(212, 175, 55, 0.1); padding: 15px; border-radius: 6px; border: 1px solid rgba(212, 175, 55, 0.3); margin-bottom: 20px;">
                        <p style="color: #cccccc; margin: 0; font-size: 0.9em;" data-i18n="batch-assign-tip">å°†ä¸ºæ‰€æœ‰é€‰ä¸­çš„æ²™é¾™ç»Ÿä¸€æŒ‡å®šè´Ÿè´£äººå‘˜ã€‚æ­¤æ“ä½œéœ€è¦ç®¡ç†å‘˜æˆ–ç»ç†æƒé™ã€‚</p>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" onclick="closeBatchAssignModal()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="cancel">å–æ¶ˆ</button>
                        <button type="button" onclick="executeBatchAssign()" style="background: var(--gold); color: var(--black); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="confirm">ç¡®è®¤</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ç¼–è¾‘èŒå‘˜æ¨¡æ€æ¡† -->
        <div id="editEmployeeModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
            <div style="background: var(--dark-gray); padding: 30px; border-radius: 10px; border: 1px solid var(--gold); width: 500px; max-width: 95vw; max-height: 95vh; overflow-y: auto;">
                <h2 style="color: var(--gold); margin-top: 0;" data-i18n="edit-employee">ç¼–è¾‘èŒå‘˜ä¿¡æ¯</h2>
                <form id="editEmployeeForm">
                    <input type="hidden" id="editEmployeeId">
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editEmployeeName" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-name">å§“åï¼š</label>
                        <input type="text" id="editEmployeeName" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editEmployeePosition" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-position">èŒä½ï¼š</label>
                        <select id="editEmployeePosition" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                            <option value="salesperson" data-i18n="salesperson">ä¸šåŠ¡å‘˜</option>
                            <option value="manager" data-i18n="manager">ç»ç†</option>
                            <option value="admin" data-i18n="admin">ç®¡ç†å‘˜</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editEmployeeUsername" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-username">ç™»å½•è´¦å·ï¼š</label>
                        <input type="text" id="editEmployeeUsername" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editEmployeePassword" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-password">å¯†ç ï¼š</label>
                        <input type="password" id="editEmployeePassword" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;" placeholder="ç•™ç©ºåˆ™ä¸ä¿®æ”¹å¯†ç ">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editEmployeeMobile" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="employee-mobile">æ‰‹æœºå·ï¼š</label>
                        <input type="tel" id="editEmployeeMobile" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                    </div>
                    
                    <!-- é“¶è¡Œè´¦æˆ·ä¿¡æ¯ -->
                    <div style="background: rgba(212, 175, 55, 0.1); padding: 15px; border-radius: 6px; border: 1px solid rgba(212, 175, 55, 0.3); margin-bottom: 20px;">
                        <h4 style="color: var(--gold); margin: 0 0 10px 0;" data-i18n="bank-account-info">é“¶è¡Œè´¦æˆ·ä¿¡æ¯</h4>
                        <div style="margin-bottom: 12px;">
                            <label for="editEmployeeBankName" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="bank-name">é“¶è¡Œåç§°ï¼š</label>
                            <input type="text" id="editEmployeeBankName" style="width: 100%; padding: 8px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                        </div>
                        <div style="margin-bottom: 12px;">
                            <label for="editEmployeeAccountNumber" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="account-number">é“¶è¡Œè´¦å·ï¼š</label>
                            <input type="text" id="editEmployeeAccountNumber" style="width: 100%; padding: 8px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                        </div>
                        <div style="margin-bottom: 12px;">
                            <label for="editEmployeeAccountHolder" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="account-holder">è´¦æˆ·æŒæœ‰äººï¼š</label>
                            <input type="text" id="editEmployeeAccountHolder" style="width: 100%; padding: 8px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                        </div>
                        <div style="margin-bottom: 12px;">
                            <label for="editEmployeeBankBranch" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="bank-branch">å¼€æˆ·æ”¯è¡Œï¼ˆé€‰å¡«ï¼‰ï¼š</label>
                            <input type="text" id="editEmployeeBankBranch" style="width: 100%; padding: 8px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" onclick="closeEditEmployeeModal()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="cancel">å–æ¶ˆ</button>
                        <button type="submit" style="background: var(--gold); color: var(--black); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="save">ä¿å­˜</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ç¼–è¾‘æ²™é¾™æ¨¡æ€æ¡† -->
        <div id="editSalonModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
            <div style="background: var(--dark-gray); padding: 30px; border-radius: 10px; border: 1px solid var(--gold); width: 500px; max-width: 95vw; max-height: 95vh; overflow-y: auto;">
                <h2 style="color: var(--gold); margin-top: 0;" data-i18n="edit-salon">ç¼–è¾‘æ²™é¾™ä¿¡æ¯</h2>
                <form id="editSalonForm">
                    <input type="hidden" id="editSalonId">
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editSalonName" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salon-name">æ²™é¾™åç§°ï¼š</label>
                        <input type="text" id="editSalonName" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editSalonAddress" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salon-address">æ²™é¾™åœ°å€ï¼š</label>
                        <input type="text" id="editSalonAddress" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editSalonDistrict" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salon-district">æ²™é¾™åŒºåŸŸï¼š</label>
                        <select id="editSalonDistrict" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                            <option value="" data-i18n="please-select-district">è¯·é€‰æ‹©åŒºåŸŸ...</option>
                            <option value="guro" data-i18n="guro-district">ä¹è€åŒº</option>
                            <option value="yeongdeungpo" data-i18n="yeongdeungpo-district">æ°¸ç™»æµ¦åŒº</option>
                            <option value="geumcheon" data-i18n="geumcheon-district">è¡¿å·åŒº</option>
                            <option value="overseas" data-i18n="overseas-district">æµ·å¤–åŒºåŸŸ</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editSalonPhone" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salon-phone">åº—é“ºç”µè¯ï¼ˆé€‰å¡«ï¼‰ï¼š</label>
                        <input type="tel" id="editSalonPhone" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editDirectorName" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="director-name">é™¢é•¿å§“åï¼š</label>
                        <input type="text" id="editDirectorName" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editDirectorMobile" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="director-mobile">æ‰‹æœºï¼š</label>
                        <input type="tel" id="editDirectorMobile" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label for="editResponsibleEmployee" style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="responsible-employee">è´Ÿè´£èŒå‘˜ï¼š</label>
                        <select id="editResponsibleEmployee" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px;">
                            <option value="" data-i18n="please-select-employee">è¯·é€‰æ‹©èŒå‘˜...</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" onclick="closeEditSalonModal()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="cancel">å–æ¶ˆ</button>
                        <button type="submit" style="background: var(--gold); color: var(--black); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="save">ä¿å­˜</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- æ·»åŠ äº¤æ˜“è®°å½•æ¨¡æ€æ¡† -->
        <div id="transactionModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
            <div style="background: var(--dark-gray); padding: 30px; border-radius: 10px; border: 1px solid var(--gold); width: 600px; max-width: 95vw; max-height: 95vh; overflow-y: auto;">
                <h2 style="color: var(--gold); margin-top: 0;" data-i18n="add-transaction-record">æ·»åŠ äº¤æ˜“è®°å½•</h2>
                <form id="transactionForm">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salesperson-name">ä¸šåŠ¡å‘˜ï¼š</label>
                        <select id="salespersonSelect" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                            <option value="" data-i18n="please-select-salesperson">è¯·é€‰æ‹©ä¸šåŠ¡å‘˜...</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: var(--gold); margin-bottom: 10px;" data-i18n="transaction-content">äº¤æ˜“å†…å®¹ï¼š</label>
                        
                        <!-- äº§å“è¡¨æ ¼ -->
                        <div style="border: 1px solid var(--gold); border-radius: 5px; overflow: hidden;">
                            <table id="productTable" style="width: 100%; border-collapse: collapse;">
                                <thead style="background: rgba(212, 175, 55, 0.2);">
                                    <tr>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: left;" data-i18n="product-name">äº§å“å</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="unit-price">å•ä»·</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="quantity">æ•°é‡</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="gift-quantity">èµ é€</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="total-amount">æ€»é‡‘é¢</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="operation">æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="productTableBody">
                                    <!-- äº§å“è¡Œå°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="margin-top: 10px; display: flex; justify-content: space-between; align-items: center;">
                            <button type="button" onclick="addProductRow()" style="background: var(--gold); color: var(--black); border: none; padding: 5px 15px; border-radius: 3px; cursor: pointer; font-size: 0.9em;" data-i18n="add-product">æ·»åŠ äº§å“</button>
                            <div style="color: var(--gold); font-weight: bold;">
                                <span data-i18n="total-products-amount">äº§å“æ€»é‡‘é¢ï¼š</span>
                                <span id="totalProductsAmount">â‚©0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="received-amount">å®æ”¶æ¬¾ï¼š</label>
                            <input type="text" id="receivedAmount" placeholder="0,000" oninput="formatReceivedAmountAndCalculate(this)" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                        </div>
                        <div>
                            <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="current-outstanding">æœ¬æ¬¡æ¬ æ¬¾ï¼š</label>
                            <input type="text" id="currentOutstanding" placeholder="0,000" readonly style="width: 100%; padding: 10px; background: rgba(100,100,100,0.3); border: 1px solid var(--gold); color: #888; border-radius: 5px; box-sizing: border-box;">
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="notes">å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰ï¼š</label>
                        <textarea id="transactionNotes" placeholder="å…¶ä»–å¤‡æ³¨ä¿¡æ¯..." style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box; height: 50px; resize: vertical;"></textarea>
                    </div>
                    
                    <!-- äº§å“å†å²äº¤æ˜“è®°å½• -->
                    <div id="product-history-section" style="margin-bottom: 15px; display: none;">
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="product-history">äº§å“å†å²äº¤æ˜“è®°å½•ï¼š</label>
                        <div id="product-history-display" style="max-height: 120px; overflow-y: auto; background: rgba(212, 175, 55, 0.1); border: 1px solid rgba(212, 175, 55, 0.3); border-radius: 5px; padding: 10px;">
                            <!-- å†å²è®°å½•å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" onclick="closeTransactionModal()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="cancel">å–æ¶ˆ</button>
                        <button type="submit" style="background: var(--gold); color: var(--black); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="add">æ·»åŠ </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- ç¼–è¾‘äº¤æ˜“è®°å½•æ¨¡æ€æ¡† -->
        <div id="editTransactionModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1001; justify-content: center; align-items: center;">
            <div style="background: var(--dark-gray); padding: 30px; border-radius: 10px; border: 1px solid var(--gold); width: 600px; max-width: 95vw; max-height: 95vh; overflow-y: auto;">
                <h2 style="color: var(--gold); margin-top: 0;" data-i18n="edit-transaction-record">ç¼–è¾‘äº¤æ˜“è®°å½•</h2>
                <form id="editTransactionForm">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="salesperson-name">ä¸šåŠ¡å‘˜ï¼š</label>
                        <select id="editSalespersonSelect" style="width: 100%; padding: 10px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                            <option value="" data-i18n="please-select-salesperson">è¯·é€‰æ‹©ä¸šåŠ¡å‘˜...</option>
                        </select>
                    </div>
                    

                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: var(--gold); margin-bottom: 10px;" data-i18n="transaction-content">äº¤æ˜“å†…å®¹ï¼š</label>
                        
                        <!-- äº§å“è¡¨æ ¼ -->
                        <div style="border: 1px solid var(--gold); border-radius: 5px; overflow: hidden;">
                            <table id="editProductTable" style="width: 100%; border-collapse: collapse;">
                                <thead style="background: rgba(212, 175, 55, 0.2);">
                                    <tr>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: left;" data-i18n="product-name">äº§å“å</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="unit-price">å•ä»·</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="quantity">æ•°é‡</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="gift-quantity">èµ é€</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="total-amount">æ€»é‡‘é¢</th>
                                        <th style="padding: 10px; border-bottom: 1px solid var(--gold); color: var(--gold); text-align: center;" data-i18n="operation">æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="editProductTableBody">
                                    <!-- äº§å“è¡Œå°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="margin-top: 10px; display: flex; justify-content: space-between; align-items: center;">
                            <button type="button" onclick="addEditProductRow()" style="background: var(--gold); color: var(--black); border: none; padding: 5px 15px; border-radius: 3px; cursor: pointer; font-size: 0.9em;" data-i18n="add-product">æ·»åŠ äº§å“</button>
                            <div style="color: var(--gold); font-weight: bold;">
                                <span data-i18n="total-products-amount">äº§å“æ€»é‡‘é¢ï¼š</span>
                                <span id="editTotalProductsAmount">â‚©0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="received-amount">å®æ”¶æ¬¾ï¼š</label>
                            <input type="text" id="editReceivedAmount" placeholder="0,000" oninput="formatEditReceivedAmountAndCalculate(this)" style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box;">
                        </div>
                        <div>
                            <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="current-outstanding">æœ¬æ¬¡æ¬ æ¬¾ï¼š</label>
                            <input type="text" id="editCurrentOutstanding" placeholder="0,000" readonly style="width: 100%; padding: 10px; background: rgba(100,100,100,0.3); border: 1px solid var(--gold); color: #888; border-radius: 5px; box-sizing: border-box;">
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: var(--gold); margin-bottom: 5px;" data-i18n="notes">å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰ï¼š</label>
                        <textarea id="editTransactionNotes" placeholder="å…¶ä»–å¤‡æ³¨ä¿¡æ¯..." style="width: 100%; padding: 10px; background: transparent; border: 1px solid var(--gold); color: var(--text-light); border-radius: 5px; box-sizing: border-box; height: 50px; resize: vertical;"></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" onclick="closeEditTransactionModal()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="cancel">å–æ¶ˆ</button>
                        <button type="submit" style="background: var(--gold); color: var(--black); border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;" data-i18n="save">ä¿å­˜</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <script>
        // è¯­è¨€ç³»ç»Ÿ
        let currentLanguage = 'zh'; // é»˜è®¤è¯­è¨€ä¸ºä¸­æ–‡
        
        const translations = {
            zh: {
                // ç³»ç»Ÿä¿¡æ¯
                'store-name': 'Mesiaé¦–å°”è¥¿éƒ¨åœ°åŒºåˆ†åº—ç®¡ç†ç³»ç»Ÿ',
                // åŒºåŸŸç®¡ç†
                'salon-district': 'æ²™é¾™åŒºåŸŸï¼š',
                'please-select-district': 'è¯·é€‰æ‹©åŒºåŸŸ...',
                'guro-district': 'ä¹è€åŒº',
                'yeongdeungpo-district': 'æ°¸ç™»æµ¦åŒº',
                'geumcheon-district': 'è¡¿å·åŒº',
                'overseas-district': 'æµ·å¤–åŒºåŸŸ',
                'all-districts': 'å…¨éƒ¨åŒºåŸŸ',
                'filter-by-district': 'æŒ‰åŒºåŸŸç­›é€‰ï¼š',
        'filter-by-responsible': 'æŒ‰è´Ÿè´£äººå‘˜ï¼š',
        'all-employees': 'å…¨éƒ¨äººå‘˜',
                // ä¸»èœå•
                'customer-management': 'å®¢æˆ·ä¿¡æ¯ç®¡ç†',
                'customer-management-desc': 'ç®¡ç†å®¢æˆ·èµ„æ–™ã€äº¤æ˜“è®°å½•ã€æœåŠ¡å†å²ç­‰ä¿¡æ¯',
                'new-salon': 'æ–°å¢æ²™é¾™',
                'new-salon-desc': 'æ·»åŠ æ–°çš„æ²™é¾™å®¢æˆ·ä¿¡æ¯',
                'salon-info': 'æ²™é¾™ä¿¡æ¯',
                'salon-info-desc': 'æŸ¥çœ‹å’Œç¼–è¾‘ç°æœ‰æ²™é¾™ä¿¡æ¯',
                'delete-salon': 'åˆ é™¤æ²™é¾™',
                'delete-salon-desc': 'åˆ é™¤ä¸éœ€è¦çš„æ²™é¾™å®¢æˆ·',
                'product-management': 'äº§å“ä¿¡æ¯ç®¡ç†',
                'product-management-desc': 'ç®¡ç†ç¾å‘äº§å“ç›®å½•ã€åº“å­˜ã€ä»·æ ¼ç­‰ä¿¡æ¯',
                'add-product': 'æ–°å¢äº§å“',
                'add-product-desc': 'æ·»åŠ æ–°çš„ç¾å‘äº§å“',
                'product-list': 'äº§å“åˆ—è¡¨',
                'product-list-desc': 'æŸ¥çœ‹æ‰€æœ‰äº§å“ä¿¡æ¯',
                'product-category': 'äº§å“åˆ†ç±»',
                'product-category-desc': 'ç®¡ç†äº§å“åˆ†ç±»',
                'inventory-management': 'åº“å­˜ä¿¡æ¯ç®¡ç†',
                'inventory-management-desc': 'è·Ÿè¸ªäº§å“åº“å­˜ã€è¡¥è´§é¢„è­¦ã€ä½¿ç”¨è®°å½•ç­‰',
                'stock-check': 'åº“å­˜ç›˜ç‚¹',
                'stock-check-desc': 'æ£€æŸ¥å½“å‰åº“å­˜çŠ¶æ€',
                'restock-alert': 'è¡¥è´§æé†’',
                'restock-alert-desc': 'è®¾ç½®åº“å­˜é¢„è­¦',
                'usage-record': 'ä½¿ç”¨è®°å½•',
                'usage-record-desc': 'æŸ¥çœ‹äº§å“ä½¿ç”¨å†å²',
                'finance-management': 'è´¢åŠ¡ä¿¡æ¯ç®¡ç†',
                'finance-management-desc': 'ç®¡ç†æ”¶æ”¯è®°å½•ã€æœåŠ¡æ”¶å…¥ã€äº§å“é”€å”®ç­‰',
                'income-record': 'æ”¶å…¥è®°å½•',
                'income-record-desc': 'è®°å½•æœåŠ¡å’Œé”€å”®æ”¶å…¥',
                'expense-record': 'æ”¯å‡ºè®°å½•',
                'expense-record-desc': 'è®°å½•å„é¡¹æ”¯å‡º',
                'financial-report': 'è´¢åŠ¡æŠ¥è¡¨',
                'financial-report-desc': 'ç”Ÿæˆè´¢åŠ¡åˆ†ææŠ¥å‘Š',
                'performance-target': 'ä¸šç»©ç›®æ ‡',
                'performance-target-desc': 'ç®¡ç†ä¸ªäººå’Œå›¢é˜Ÿä¸šç»©ç›®æ ‡',
                'select-month': 'é€‰æ‹©æœˆä»½ï¼š',
                'recalculate-targets': 'é‡æ–°è®¡ç®—ç›®æ ‡',
                'reset-targets': 'é‡ç½®ç›®æ ‡',
                'team-target': 'ä»£ç†åº—è¥ä¸šé¢ç›®æ ‡',
                'target-label': 'ç›®æ ‡',
                'actual-label': 'å®é™…',
                'thousand-won': 'åƒéŸ©å…ƒ',
                'individual-targets': 'ä¸ªäººä¸šç»©ç›®æ ‡',
                'employee-name-column': 'èŒå‘˜å§“å',
                'monthly-target': 'æœˆåº¦ç›®æ ‡',
                'monthly-actual': 'æœˆåº¦å®é™…',
                'progress-rate': 'è¿›åº¦ç‡(%)',
                'last-month-performance': 'ä¸Šæœˆä¸šç»©',
                'target-adjustment': 'ç›®æ ‡è°ƒæ•´',
                        'target-increased': 'ç›®æ ‡ä¸Šè°ƒ10%',
        'target-maintained': 'ç›®æ ‡ä¿æŒ',
        'target-recalculation-complete': 'ç›®æ ‡é‡æ–°è®¡ç®—å®Œæˆï¼å…±æœ‰ {count} åå‘˜å·¥çš„ç›®æ ‡è¢«ä¸Šè°ƒã€‚',
        'confirm-reset-targets': 'ç¡®å®šè¦å°†æ‰€æœ‰å‘˜å·¥çš„ç›®æ ‡é‡ç½®ä¸º200ä¸‡éŸ©å…ƒå—ï¼Ÿ',
        'targets-reset-complete': 'æ‰€æœ‰ç›®æ ‡å·²é‡ç½®ä¸º200ä¸‡éŸ©å…ƒï¼',
                'auto-calculate': 'è‡ªåŠ¨è®¡ç®—',
                'manual-adjust': 'æ‰‹åŠ¨è°ƒæ•´',
                // é€šç”¨æŒ‰é’®
                'back-to-main': 'è¿”å›ä¸»èœå•',
                'add': 'æ·»åŠ ',
                'delete': 'åˆ é™¤',
                'cancel': 'å–æ¶ˆ',
                'close': 'å…³é—­',
                'confirm': 'ç¡®è®¤',
                'no-data': 'æ— æ•°æ®',
                'records': 'æ¡è®°å½•',
                'not-set': 'æœªè®¾ç½®',
                // æ“ä½œæè¿°ç¿»è¯‘
                'operation-desc-homepage-navigation': 'é€šè¿‡ç‚¹å‡»Logoè¿”å›é¦–é¡µ',
                'operation-desc-system-logout': 'ç³»ç»Ÿç™»å‡º',
                'operation-desc-user-logout': 'ç”¨æˆ· {user} ({position}) ç™»å‡ºç³»ç»Ÿ',
                'operation-desc-create-salon': 'åˆ›å»ºæ–°æ²™é¾™ï¼š{name}ï¼Œé™¢é•¿ï¼š{director}',
                'operation-desc-delete-salon': 'åˆ é™¤æ²™é¾™ï¼š{name}ï¼Œé™¢é•¿ï¼š{director}',
                'operation-desc-edit-employee': 'ç¼–è¾‘èŒå‘˜ä¿¡æ¯ï¼š{name}',
                // å¯¹è±¡åç§°ç¿»è¯‘
                'object-name-home-navigation': 'é¦–é¡µå¯¼èˆª',
                'object-name-system-logout': 'ç³»ç»Ÿç™»å‡º',
                // æ•°æ®å­—æ®µç¿»è¯‘
                'field-name': 'å§“å',
                'field-position': 'èŒä½',
                'field-username': 'ç”¨æˆ·å',
                'field-password': 'å¯†ç ',
                'field-mobile': 'æ‰‹æœºå·',
                'field-createTime': 'åˆ›å»ºæ—¶é—´',
                'field-bankInfo': 'é“¶è¡Œä¿¡æ¯',
                'field-bankName': 'é“¶è¡Œåç§°',
                'field-accountNumber': 'è´¦å·',
                'field-accountHolder': 'è´¦æˆ·æŒæœ‰äºº',
                'field-bankBranch': 'å¼€æˆ·æ”¯è¡Œ',
                'field-id': 'ID',
                'field-address': 'åœ°å€',
                'field-district': 'åŒºåŸŸ',
                'field-phone': 'ç”µè¯',
                'field-directorName': 'é™¢é•¿å§“å',
                'field-directorMobile': 'é™¢é•¿æ‰‹æœº',
                'field-responsibleEmployeeId': 'è´Ÿè´£å‘˜å·¥ID',
                'field-addTime': 'æ–°å¢æ—¶é—´',
                'field-joinDate': 'åŠ å…¥æ—¥æœŸ',
                'field-transactions': 'äº¤æ˜“è®°å½•',
                'field-lastTransactionDate': 'æœ€åäº¤æ˜“æ—¥æœŸ',
                // è¡¨å•ç›¸å…³
                'salon-name': 'æ²™é¾™åç§°ï¼š',
                'salon-address': 'æ²™é¾™åœ°å€ï¼š',
                'salon-phone': 'åº—é“ºç”µè¯ï¼š',
                'director-name': 'é™¢é•¿å§“åï¼š',
                'director-mobile': 'æ‰‹æœºï¼š',
                'transaction-desc': 'äº¤æ˜“æè¿°ï¼š',
                'transaction-amount': 'äº¤æ˜“é‡‘é¢ï¼ˆé€‰å¡«ï¼‰ï¼š',
                'add-transaction-record': 'æ·»åŠ äº¤æ˜“è®°å½•',
                // çŠ¶æ€æ–‡æœ¬
                'no-salon-info': 'æš‚æ— æ²™é¾™ä¿¡æ¯',
                'add-salon-tip': 'è¯·å‰å¾€"æ–°å¢æ²™é¾™"é¡µé¢æ·»åŠ æ²™é¾™ä¿¡æ¯',
                'active-customer': 'æ´»è·ƒå®¢æˆ·',
                'needs-attention': 'éœ€è¦å…³æ³¨',
                'long-inactive': 'é•¿æœŸæœªäº¤æ˜“',
                'no-transaction': 'æ— äº¤æ˜“è®°å½•',
                'recent-transactions': 'è¿‘æœŸäº¤æ˜“è®°å½•',
                'no-transactions': 'æš‚æ— äº¤æ˜“è®°å½•',
                'first-join': 'é¦–æ¬¡åŠ å…¥',
                'last-transaction': 'æœ€åäº¤æ˜“',
                'transaction-count': 'äº¤æ˜“è®°å½•æ€»æ•°',
                'days-since-last': 'è·ä¸Šæ¬¡äº¤æ˜“',
                // å…¶ä»–ç•Œé¢æ–‡æœ¬
                'salon-info-list-desc': 'è¿™é‡Œæ˜¾ç¤ºæ‰€æœ‰å·²æ·»åŠ çš„æ²™é¾™è¯¦ç»†ä¿¡æ¯åˆ—è¡¨ã€‚',
                'delete-warning': 'âš ï¸ åˆ é™¤æ“ä½œæ— æ³•æ’¤é”€ï¼Œè¯·è°¨æ…æ“ä½œï¼',
                'select-salon-to-delete': 'é€‰æ‹©è¦åˆ é™¤çš„æ²™é¾™',
                'please-select-salon': 'è¯·é€‰æ‹©æ²™é¾™...',
                'confirm-delete': 'ç¡®è®¤åˆ é™¤',
                // å†…å®¹é¡µé¢æè¿°
                'add-product-content': 'åœ¨è¿™é‡Œæ·»åŠ æ–°çš„ç¾å‘äº§å“ä¿¡æ¯...',
                'product-list-content': 'æ˜¾ç¤ºæ‰€æœ‰äº§å“çš„åˆ—è¡¨...',
                'product-category-content': 'ç®¡ç†äº§å“åˆ†ç±»ä¿¡æ¯...',
                'stock-check-content': 'è¿›è¡Œåº“å­˜ç›˜ç‚¹æ“ä½œ...',
                'restock-alert-content': 'è®¾ç½®å’ŒæŸ¥çœ‹è¡¥è´§æé†’...',
                'usage-record-content': 'æŸ¥çœ‹äº§å“ä½¿ç”¨è®°å½•...',
                'income-record-content': 'è®°å½•å’ŒæŸ¥çœ‹æ”¶å…¥ä¿¡æ¯...',
                'expense-record-content': 'è®°å½•å’ŒæŸ¥çœ‹æ”¯å‡ºä¿¡æ¯...',
                'financial-report-content': 'ç”Ÿæˆå’ŒæŸ¥çœ‹è´¢åŠ¡æŠ¥è¡¨...',
                // åŠ¨æ€å†…å®¹æ ‡ç­¾
                'salon-address-label': 'æ²™é¾™åœ°å€',
                'salon-phone-label': 'åº—é“ºç”µè¯',
                'director-name-label': 'é™¢é•¿å§“å',
                'director-mobile-label': 'é™¢é•¿æ‰‹æœº',
                'first-join-label': 'é¦–æ¬¡åŠ å…¥',
                'status-label': 'çŠ¶æ€',
                'status-active': 'æ´»è·ƒ',
                'days-since-last-label': 'è·ä¸Šæ¬¡äº¤æ˜“',
                'transaction-count-label': 'äº¤æ˜“è®°å½•æ€»æ•°',
                'last-transaction-label': 'æœ€åäº¤æ˜“',
                'recent-transactions-label': 'è¿‘æœŸäº¤æ˜“è®°å½•',
                'add-transaction-btn': 'æ·»åŠ äº¤æ˜“',
                'delete-btn': 'åˆ é™¤',
                'days-unit': 'å¤©',
                'transaction-unit': 'ç¬”',
                'transaction-default': 'äº¤æ˜“',
                'more-records': 'è¿˜æœ‰ {count} æ¡å†å²è®°å½•...',
                // æç¤ºå’Œç¡®è®¤æ¶ˆæ¯
                'salon-added-success': 'æ²™é¾™ä¿¡æ¯å·²æˆåŠŸæ·»åŠ ï¼',
                'salon-name-text': 'æ²™é¾™åç§°',
                'salon-address-text': 'æ²™é¾™åœ°å€',
                'salon-phone-text': 'åº—é“ºç”µè¯',
                'director-name-text': 'é™¢é•¿å§“å',
                'director-mobile-text': 'é™¢é•¿æ‰‹æœº',
                'fill-required-fields': 'è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µï¼ï¼ˆåº—é“ºç”µè¯ä¸ºé€‰å¡«ï¼‰',
                'confirm-delete-salon': 'ç¡®å®šè¦åˆ é™¤æ²™é¾™"{name}"å—ï¼Ÿ\næ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼',
                'salon-deleted-success': 'æ²™é¾™å·²æˆåŠŸåˆ é™¤ï¼',
                'select-salon-first': 'è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„æ²™é¾™ï¼',
                'transaction-added-success': 'äº¤æ˜“è®°å½•å·²æˆåŠŸæ·»åŠ ï¼',
                'fill-transaction-desc': 'è¯·å¡«å†™äº¤æ˜“æè¿°ï¼',
                // æ–°åŠŸèƒ½ç¿»è¯‘
                'search-salon-placeholder': 'æœç´¢æ²™é¾™åã€é™¢é•¿åæˆ–æ‰‹æœºå·...',
                'clear-search': 'æ¸…ç©º',
                'back-to-salon-info': 'è¿”å›æ²™é¾™ä¿¡æ¯',
                'filter-by-date': 'æŒ‰æ—¥æœŸç­›é€‰ï¼š',
                'to': 'è‡³',
                'filter': 'ç­›é€‰',
                'clear-filter': 'æ¸…ç©ºç­›é€‰',
                'transaction-records': 'äº¤æ˜“è®°å½•',
                'back-to-transaction-list': 'è¿”å›äº¤æ˜“è®°å½•',
                'print': 'æ‰“å°',
                'transaction-detail': 'äº¤æ˜“è¯¦æƒ…',
                'products': 'äº§å“ï¼š',
                'receivable-amount': 'åº”æ”¶æ¬¾ï¼š',
                'received-amount': 'å®æ”¶æ¬¾ï¼š',
                'outstanding-amount': 'æ¬ æ¬¾ï¼š',
                'notes': 'å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰ï¼š',
                'view-all-transactions': 'æŸ¥çœ‹å…¨éƒ¨äº¤æ˜“',
                'click-to-view-detail': 'ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…',
                'transaction-date': 'äº¤æ˜“æ—¥æœŸ',
                'transaction-amount-label': 'äº¤æ˜“é‡‘é¢',
                'no-transactions-found': 'æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„äº¤æ˜“è®°å½•',
                'total-transactions': 'å…± {count} ç¬”äº¤æ˜“',
                'print-transaction-title': 'äº¤æ˜“è®°å½•è¯¦æƒ…',
                'no-matching-salons': 'æœªæ‰¾åˆ°åŒ¹é…çš„æ²™é¾™',
                'select-start-end-date': 'è¯·é€‰æ‹©å¼€å§‹å’Œç»“æŸæ—¥æœŸ',
                // æ–°çš„äº§å“è¡¨æ ¼ç›¸å…³ç¿»è¯‘
                'transaction-content': 'äº¤æ˜“å†…å®¹ï¼š',
                'product-name': 'äº§å“å',
                'unit-price': 'å•ä»·',
                'quantity': 'æ•°é‡',
                'total-amount': 'æ€»é‡‘é¢',
                'operation': 'æ“ä½œ',
                'add-product': 'æ·»åŠ äº§å“',
                'total-products-amount': 'äº§å“æ€»é‡‘é¢ï¼š',
                'current-outstanding': 'æœ¬æ¬¡æ¬ æ¬¾ï¼š',
                'remove': 'åˆ é™¤',
                'total-outstanding': 'ç´¯è®¡æ¬ æ¬¾ï¼š',
                'copy-for-director': 'é™¢é•¿ç•™å­˜è”',
                'copy-for-agent': 'ä»£ç†åº—ç•™å­˜è”',
                'historical-outstanding': 'å†å²æ¬ æ¬¾ï¼š',
                'add-at-least-one-product': 'è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªäº§å“ï¼',
                // èŒå‘˜ç®¡ç†ç›¸å…³ç¿»è¯‘
                'employee-management': 'èŒå‘˜ç®¡ç†',
                'employee-management-desc': 'ç®¡ç†ä¸šåŠ¡å‘˜ä¿¡æ¯ã€æƒé™å’Œè´¦å·',
                'new-employee': 'æ–°å¢èŒå‘˜',
                'new-employee-desc': 'æ·»åŠ æ–°çš„ä¸šåŠ¡å‘˜è´¦å·',
                'employee-list': 'èŒå‘˜åˆ—è¡¨',
                'employee-list-desc': 'æŸ¥çœ‹å’Œç¼–è¾‘èŒå‘˜ä¿¡æ¯',
                'delete-employee': 'åˆ é™¤èŒå‘˜',
                'delete-employee-desc': 'åˆ é™¤ä¸éœ€è¦çš„èŒå‘˜è´¦å·',
                'employee-name': 'å§“åï¼š',
                'employee-position': 'èŒä½ï¼š',
                'employee-username': 'ç™»å½•è´¦å·ï¼š',
                'employee-password': 'å¯†ç ï¼š',
                'employee-mobile': 'æ‰‹æœºå·ï¼š',
                'bank-account-info': 'é“¶è¡Œè´¦æˆ·ä¿¡æ¯',
                'bank-name': 'é“¶è¡Œåç§°ï¼š',
                'account-number': 'é“¶è¡Œè´¦å·ï¼š',
                'account-holder': 'è´¦æˆ·æŒæœ‰äººï¼š',
                'bank-branch': 'å¼€æˆ·æ”¯è¡Œï¼ˆé€‰å¡«ï¼‰ï¼š',
                'batch-upload-salons': 'æ‰¹é‡ä¸Šä¼ æ²™é¾™',
                'batch-upload-description': 'ä¸Šä¼ åŒ…å«æ²™é¾™ä¿¡æ¯çš„Excelè¡¨æ ¼æ–‡ä»¶ã€‚æ ¼å¼è¦æ±‚ï¼šç¬¬1è¡Œä¸ºè¡¨æ ¼æ ‡é¢˜ï¼Œç¬¬2è¡Œä¸ºåˆ—æ ‡é¢˜ï¼ˆå¿…é¡»åŒ…å«æ²™é¾™åç§°å’Œåœ°å€åˆ—ï¼‰ï¼Œç¬¬3è¡Œå¼€å§‹ä¸ºå®é™…æ•°æ®ã€‚ç³»ç»Ÿå°†æ ¹æ®åœ°å€å…³é”®å­—è‡ªåŠ¨è®¾ç½®åŒºåŸŸã€‚',
                        'select-file': 'é€‰æ‹©æ–‡ä»¶ï¼š',
        'choose-file': 'é€‰æ‹©æ–‡ä»¶',
        'no-file-selected': 'æœªé€‰æ‹©æ–‡ä»¶',
        'process-file': 'å¤„ç†æ–‡ä»¶',
        'download-sample': 'ä¸‹è½½æ ·ä¾‹æ¨¡æ¿',
                'preview-data': 'æ•°æ®é¢„è§ˆï¼š',
                'confirm-batch-create': 'ç¡®è®¤æ‰¹é‡åˆ›å»º',
                'file-processed-success': 'æ–‡ä»¶å¤„ç†æˆåŠŸï¼å…±è¯†åˆ«åˆ° {count} ä¸ªæ²™é¾™è®°å½•ã€‚',
                'batch-create-success': 'æ‰¹é‡åˆ›å»ºæˆåŠŸï¼å…±åˆ›å»ºäº† {count} ä¸ªæ²™é¾™ã€‚',
                'file-processing-error': 'æ–‡ä»¶å¤„ç†å‡ºé”™ï¼š{error}',
                'no-valid-data': 'æœªæ‰¾åˆ°æœ‰æ•ˆçš„æ²™é¾™æ•°æ®ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼ã€‚',
                'select-file-first': 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶ï¼',
                'unsupported-file-type': 'ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼Œè¯·é€‰æ‹©Excelæ–‡ä»¶ï¼ˆ.xlsxæˆ–.xlsï¼‰ã€‚',
                'salesperson': 'ä¸šåŠ¡å‘˜',
                'manager': 'ç»ç†',
                'admin': 'ç®¡ç†å‘˜',
                'select-employee-to-delete': 'é€‰æ‹©è¦åˆ é™¤çš„èŒå‘˜',
                'please-select-employee': 'è¯·é€‰æ‹©èŒå‘˜...',
                'employee-added-success': 'èŒå‘˜å·²æˆåŠŸæ·»åŠ ï¼',
                'employee-deleted-success': 'èŒå‘˜å·²æˆåŠŸåˆ é™¤ï¼',
                'username-already-exists': 'ç™»å½•è´¦å·å·²å­˜åœ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–è´¦å·ï¼',
                'fill-all-employee-fields': 'è¯·å¡«å†™æ‰€æœ‰èŒå‘˜ä¿¡æ¯ï¼',
                'confirm-delete-employee': 'ç¡®å®šè¦åˆ é™¤èŒå‘˜"{name}"å—ï¼Ÿ\næ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼',
                'select-employee-first': 'è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„èŒå‘˜ï¼',
                'salesperson-name': 'ä¸šåŠ¡å‘˜ï¼š',
                'please-select-salesperson': 'è¯·é€‰æ‹©ä¸šåŠ¡å‘˜...',
                'edit-employee': 'ç¼–è¾‘èŒå‘˜ä¿¡æ¯',
                'edit-btn': 'ç¼–è¾‘',
                'save': 'ä¿å­˜',
                'employee-updated-success': 'èŒå‘˜ä¿¡æ¯å·²æˆåŠŸæ›´æ–°ï¼',
                'username-already-exists-edit': 'è¯¥ç™»å½•è´¦å·å·²è¢«å…¶ä»–èŒå‘˜ä½¿ç”¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–è´¦å·ï¼',
                'fill-employee-basic-info': 'è¯·å¡«å†™æ‰€æœ‰å¿…å¡«ä¿¡æ¯ï¼ˆå§“åã€è´¦å·ã€æ‰‹æœºå·ï¼‰ï¼',
                'cannot-edit-admin-permission': 'ç»ç†æ— æƒä¿®æ”¹ç®¡ç†å‘˜æƒé™ï¼',
                'gift-quantity': 'èµ é€',
                'salesperson-mobile': 'ä¸šåŠ¡å‘˜æ‰‹æœº',
                        'salesperson-label': 'ä¸šåŠ¡å‘˜',
        'unassigned': 'æœªæŒ‡å®š',
        'create-time': 'åˆ›å»ºæ—¶é—´',
        'permission-level': 'æƒé™çº§åˆ«',
        'status-normal': 'æ­£å¸¸',
                'agent-store-name': 'ä»£ç†åº—åç§°',
                'edit-transaction': 'ç¼–è¾‘äº¤æ˜“',
            'delete-transaction': 'åˆ é™¤äº¤æ˜“',
            'confirm-delete-transaction': 'ç¡®è®¤åˆ é™¤æ­¤äº¤æ˜“è®°å½•å—ï¼Ÿè¿™ä¸ªæ“ä½œæ— æ³•æ’¤é”€ï¼',
            'transaction-deleted-success': 'äº¤æ˜“è®°å½•å·²æˆåŠŸåˆ é™¤ï¼',
                'edit-transaction-record': 'ç¼–è¾‘äº¤æ˜“è®°å½•',
                'transaction-updated-success': 'äº¤æ˜“è®°å½•å·²æˆåŠŸæ›´æ–°ï¼',
                'edit-salon': 'ç¼–è¾‘æ²™é¾™ä¿¡æ¯',
                'salon-updated-success': 'æ²™é¾™ä¿¡æ¯å·²æˆåŠŸæ›´æ–°ï¼',
                'fill-salon-basic-info': 'è¯·å¡«å†™æ‰€æœ‰å¿…å¡«ä¿¡æ¯ï¼ˆæ²™é¾™åç§°ã€åœ°å€ã€åŒºåŸŸã€é™¢é•¿å§“åã€é™¢é•¿æ‰‹æœºï¼‰ï¼',
                // æ“ä½œå†å²ç›¸å…³ç¿»è¯‘
                'audit-management': 'æ“ä½œå†å²ç®¡ç†',
                'audit-management-desc': 'ç®¡ç†ç³»ç»Ÿæ“ä½œè®°å½•ã€æ•°æ®å®¡è®¡å’Œå®‰å…¨ç›‘æ§',
                'operation-history': 'æ“ä½œå†å²è®°å½•',
                'operation-history-desc': 'æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„æ“ä½œå†å²å’Œæ•°æ®å˜æ›´è®°å½•',
                'data-comparison': 'æ•°æ®å¯¹æ¯”æŸ¥çœ‹',
                'data-comparison-desc': 'å¯¹æ¯”æŸ¥çœ‹ä¿®æ”¹å‰åçš„æ•°æ®å˜åŒ–',
                'audit-report': 'å®¡è®¡æŠ¥å‘Š',
                'audit-report-desc': 'ç”Ÿæˆæ“ä½œç»Ÿè®¡å’Œå®‰å…¨å®¡è®¡æŠ¥å‘Š',
                'filter-by-user': 'æŒ‰ç”¨æˆ·ç­›é€‰ï¼š',
                'filter-by-operation': 'æŒ‰æ“ä½œç±»å‹ï¼š',
                'filter-by-object': 'æŒ‰å¯¹è±¡ç±»å‹ï¼š',
                'all-users': 'å…¨éƒ¨ç”¨æˆ·',
                'all-operations': 'å…¨éƒ¨æ“ä½œ',
                'all-objects': 'å…¨éƒ¨å¯¹è±¡',
                'operation-create': 'åˆ›å»º',
                'operation-edit': 'ç¼–è¾‘',
                'operation-delete': 'åˆ é™¤',
                'operation-login': 'ç™»å½•',
                'operation-logout': 'ç™»å‡º',
                'operation-navigation': 'é¡µé¢å¯¼èˆª',
                'object-salon': 'æ²™é¾™',
                'object-transaction': 'äº¤æ˜“',
                'object-employee': 'èŒå‘˜',
                'clear-all-filters': 'æ¸…ç©ºç­›é€‰',
                'select-history-record': 'è¯·ä»æ“ä½œå†å²è®°å½•ä¸­é€‰æ‹©è¦å¯¹æ¯”çš„è®°å½•',
                'total-operations': 'æ€»æ“ä½œæ•°',
                'today-operations': 'ä»Šæ—¥æ“ä½œ',
                'active-users': 'æ´»è·ƒç”¨æˆ·',
                'critical-operations': 'é‡è¦æ“ä½œ',
                'operation-time': 'æ“ä½œæ—¶é—´',
                'operator': 'æ“ä½œäºº',
                'operation-type': 'æ“ä½œç±»å‹',
                'object-type': 'å¯¹è±¡ç±»å‹',
                'object-name': 'å¯¹è±¡åç§°',
                'operation-description': 'æ“ä½œæè¿°',
                'view-details': 'æŸ¥çœ‹è¯¦æƒ…',
                'compare-data': 'æ•°æ®å¯¹æ¯”',
                'data-before': 'ä¿®æ”¹å‰',
                'data-after': 'ä¿®æ”¹å',
                'no-operation-history': 'æš‚æ— æ“ä½œå†å²è®°å½•',
                'operation-details': 'æ“ä½œè¯¦æƒ…',
                'ip-address': 'IPåœ°å€',
                'browser-info': 'æµè§ˆå™¨ä¿¡æ¯',
                'user-operation-stats': 'ç”¨æˆ·æ“ä½œç»Ÿè®¡',
                'user': 'ç”¨æˆ·',
                'total': 'æ€»æ“ä½œæ•°',
                'create-count': 'åˆ›å»º',
                'edit-count': 'ç¼–è¾‘', 
                'delete-count': 'åˆ é™¤',
                'login-count': 'ç™»å½•',
                'recent-critical-operations': 'æœ€è¿‘é‡è¦æ“ä½œè®°å½•',
                'no-critical-operations': 'æš‚æ— é‡è¦æ“ä½œè®°å½•',
                'details': 'è¯¦æƒ…',
                'unknown-user': 'æœªçŸ¥ç”¨æˆ·',
                'logout': 'é€€å‡ºç™»å½•',
                'confirm-logout': 'ç¡®è®¤é€€å‡ºç™»å½•å—ï¼Ÿ',
                'no-permission-delete-salon': 'æ‚¨æ²¡æœ‰æƒé™åˆ é™¤æ²™é¾™ï¼åªæœ‰ç®¡ç†å‘˜å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œã€‚',
                'no-permission-delete-employee': 'æ‚¨æ²¡æœ‰æƒé™åˆ é™¤èŒå‘˜ï¼åªæœ‰ç®¡ç†å‘˜å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œã€‚',
                'no-permission-delete-transaction': 'æ‚¨æ²¡æœ‰æƒé™åˆ é™¤äº¤æ˜“è®°å½•ï¼åªæœ‰ç®¡ç†å‘˜å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œã€‚',
                'no-salesperson-salons': 'æ‚¨è¿˜æ²¡æœ‰è´Ÿè´£çš„æ²™é¾™',
                'salesperson-salon-tip': 'å½“æ‚¨åœ¨æ²™é¾™ä¸­äº§ç”Ÿäº¤æ˜“è®°å½•åï¼Œè¯¥æ²™é¾™å°±ä¼šå‡ºç°åœ¨è¿™é‡Œ',
                'responsible-employee': 'è´Ÿè´£èŒå‘˜',
                'business-license': 'è¥ä¸šæ‰§ç…§å·ç ',
                'product-history': 'äº§å“å†å²äº¤æ˜“è®°å½•',
                'please-select-employee': 'è¯·é€‰æ‹©èŒå‘˜...',
                'approval-required': 'æ“ä½œéœ€è¦ç®¡ç†å‘˜å®¡æ‰¹',
                'approval-submitted': 'æ“ä½œå·²æäº¤ï¼Œç­‰å¾…ç®¡ç†å‘˜å®¡æ‰¹',
                'approval-approved': 'æ“ä½œå·²è·å¾—å®¡æ‰¹',
                'approval-rejected': 'æ“ä½œè¢«ç®¡ç†å‘˜æ‹’ç»',
                'pending-approvals': 'å¾…å®¡æ‰¹æ“ä½œ',
                'no-pending-approvals': 'æš‚æ— å¾…å®¡æ‰¹æ“ä½œ',
                'approve': 'æ‰¹å‡†',
                'reject': 'æ‹’ç»',
                'approval-reason': 'å®¡æ‰¹æ„è§',
                'approval-management': 'å®¡æ‰¹ç®¡ç†',
                'approval-management-desc': 'å¤„ç†å¾…å®¡æ‰¹çš„æ“ä½œè¯·æ±‚',
                'all-status': 'å…¨éƒ¨çŠ¶æ€',
                'pending': 'å¾…å®¡æ‰¹',
                'approved': 'å·²æ‰¹å‡†',
                'rejected': 'å·²æ‹’ç»',
                'request-time': 'ç”³è¯·æ—¶é—´',
                'requester': 'ç”³è¯·äºº',
                'operation-type': 'æ“ä½œç±»å‹',
                'operation-description': 'æ“ä½œæè¿°',
                'process-time': 'å¤„ç†æ—¶é—´',
                'processor': 'å¤„ç†äºº',
                'approval-actions': 'æ“ä½œ',
                'enter-approval-reason': 'è¯·è¾“å…¥å®¡æ‰¹æ„è§',
                'approval-reason-required': 'è¯·å¡«å†™å®¡æ‰¹æ„è§',
                'approval-processed-success': 'å®¡æ‰¹å¤„ç†å®Œæˆ',
                // æ‰¹é‡æ“ä½œç›¸å…³ç¿»è¯‘
                'select-all': 'å…¨é€‰',
                'batch-delete': 'æ‰¹é‡åˆ é™¤',
                'batch-assign': 'æ‰¹é‡æŒ‡å®šè´Ÿè´£äºº',
                'selected-count': 'å·²é€‰æ‹© {count} ä¸ªæ²™é¾™',
                'no-salons-selected': 'è¯·å…ˆé€‰æ‹©è¦æ“ä½œçš„æ²™é¾™ï¼',
                'confirm-batch-delete': 'ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ {count} ä¸ªæ²™é¾™å—ï¼Ÿ\næ²™é¾™åˆ—è¡¨ï¼š{names}\næ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼',
                'batch-delete-success': 'æ‰¹é‡åˆ é™¤æˆåŠŸï¼å…±åˆ é™¤äº† {count} ä¸ªæ²™é¾™ã€‚',
                'batch-assign-responsible': 'æ‰¹é‡æŒ‡å®šè´Ÿè´£äºº',
                'select-responsible-employee': 'é€‰æ‹©è´Ÿè´£èŒå‘˜ï¼š',
                'batch-assign-tip': 'å°†ä¸ºæ‰€æœ‰é€‰ä¸­çš„æ²™é¾™ç»Ÿä¸€æŒ‡å®šè´Ÿè´£äººå‘˜ã€‚æ­¤æ“ä½œéœ€è¦ç®¡ç†å‘˜æˆ–ç»ç†æƒé™ã€‚',
                'batch-assign-success': 'æ‰¹é‡æŒ‡å®šæˆåŠŸï¼å…±ä¸º {count} ä¸ªæ²™é¾™æŒ‡å®šäº†è´Ÿè´£äººï¼š{employee}',
                'all-districts': 'å…¨éƒ¨åŒºåŸŸ',
                        'total-salons-count': 'æ€»è®¡ {count} å®¶æ²™é¾™',
        'district-salons-count': 'å…± {count} å®¶æ²™é¾™',
        'sort-by': 'æ’åºæ–¹å¼ï¼š',
        'sort-name': 'æ²™é¾™åç§° â†‘',
        'sort-address': 'åœ°å€åç§° â†‘',
        'sort-add-time': 'æ–°å¢æ—¶é—´ â†‘',
        'sort-last-transaction': 'æœ€åäº¤æ˜“ â†‘',
        'sort-outstanding-days': 'æ¬ æ¬¾å¤©æ•° â†‘',
        'sort-outstanding-amount': 'æ¬ æ¬¾é‡‘é¢ â†‘',
        'sort-default': 'é»˜è®¤æ’åº',
        'items-per-page': 'æ¯é¡µæ˜¾ç¤ºï¼š',
        'items': 'æ¡',
                'district-other': 'æµ·å¤–åœ°åŒº',
                'district-guro': 'ä¹è€åŒº',
                'district-yeongdeungpo': 'æ°¸ç™»æµ¦åŒº',
                'district-geumcheon': 'è¡¿å·åŒº',
                'loading': 'åŠ è½½ä¸­',
                'unassigned': 'æœªæŒ‡å®š',
                'salon-name-required': 'è¯·å¡«å†™æ²™é¾™åç§°ï¼',
                // åˆ†é¡µæ§ä»¶
                'first-page': 'é¦–é¡µ',
                'prev-page': 'ä¸Šä¸€é¡µ',
                'next-page': 'ä¸‹ä¸€é¡µ',
                'last-page': 'æœ«é¡µ',
                'page-info': 'ç¬¬ {current} é¡µ / å…± {total} é¡µ ({items} ä¸ªé¡¹ç›®)',
                'go-to-page': 'è·³è½¬åˆ°ç¬¬',
                'jump': 'è·³è½¬',
                'invalid-page-number': 'æ— æ•ˆçš„é¡µç ï¼è¯·è¾“å…¥1åˆ°{max}ä¹‹é—´çš„æ•°å­—ã€‚',
                // æ“ä½œæè¿°
                'batch-assign-description': 'æ‰¹é‡æŒ‡å®šè´Ÿè´£äººï¼šå°†{salons}ï¼ˆå…±{count}ä¸ªæ²™é¾™ï¼‰çš„è´Ÿè´£äººè®¾ä¸º{employee}'
            },
            ko: {
                // ì‹œìŠ¤í…œ ì •ë³´
                'store-name': 'ë©”ì‹œì•„ì„œë¶€ì§€ì ê´€ë¦¬ì‹œìŠ¤í…œ',
                // ì§€ì—­ ê´€ë¦¬
                'salon-district': 'ì‚´ë¡± ì§€ì—­ï¼š',
                'please-select-district': 'ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”...',
                'guro-district': 'êµ¬ë¡œêµ¬',
                'yeongdeungpo-district': 'ì˜ë“±í¬êµ¬',
                'geumcheon-district': 'ê¸ˆì²œêµ¬',
                'overseas-district': 'í•´ì™¸ì§€ì—­',
                'all-districts': 'ì „ì²´ ì§€ì—­',
                'filter-by-district': 'ì§€ì—­ë³„ í•„í„°ë§ï¼š',
        'filter-by-responsible': 'ë‹´ë‹¹ìë³„ï¼š',
        'all-employees': 'ëª¨ë“  ì§ì›',
                // ì£¼ ë©”ë‰´
                'customer-management': 'ê³ ê° ì •ë³´ ê´€ë¦¬',
                'customer-management-desc': 'ê³ ê° ìë£Œ, ê±°ë˜ ê¸°ë¡, ì„œë¹„ìŠ¤ ì´ë ¥ ë“± ì •ë³´ ê´€ë¦¬',
                'new-salon': 'ìƒˆ ì‚´ë¡± ì¶”ê°€',
                'new-salon-desc': 'ìƒˆë¡œìš´ ì‚´ë¡± ê³ ê° ì •ë³´ ì¶”ê°€',
                'salon-info': 'ì‚´ë¡± ì •ë³´',
                'salon-info-desc': 'ê¸°ì¡´ ì‚´ë¡± ì •ë³´ ì¡°íšŒ ë° í¸ì§‘',
                'delete-salon': 'ì‚´ë¡± ì‚­ì œ',
                'delete-salon-desc': 'ë¶ˆí•„ìš”í•œ ì‚´ë¡± ê³ ê° ì‚­ì œ',
                'product-management': 'ì œí’ˆ ì •ë³´ ê´€ë¦¬',
                'product-management-desc': 'í—¤ì–´ ì œí’ˆ ëª©ë¡, ì¬ê³ , ê°€ê²© ë“± ì •ë³´ ê´€ë¦¬',
                'add-product': 'ìƒˆ ì œí’ˆ ì¶”ê°€',
                'add-product-desc': 'ìƒˆë¡œìš´ í—¤ì–´ ì œí’ˆ ì¶”ê°€',
                'product-list': 'ì œí’ˆ ëª©ë¡',
                'product-list-desc': 'ëª¨ë“  ì œí’ˆ ì •ë³´ ì¡°íšŒ',
                'product-category': 'ì œí’ˆ ë¶„ë¥˜',
                'product-category-desc': 'ì œí’ˆ ë¶„ë¥˜ ê´€ë¦¬',
                'inventory-management': 'ì¬ê³  ì •ë³´ ê´€ë¦¬',
                'inventory-management-desc': 'ì œí’ˆ ì¬ê³  ì¶”ì , ë³´ì¶© ì•Œë¦¼, ì‚¬ìš© ê¸°ë¡ ë“±',
                'stock-check': 'ì¬ê³  í™•ì¸',
                'stock-check-desc': 'í˜„ì¬ ì¬ê³  ìƒíƒœ í™•ì¸',
                'restock-alert': 'ë³´ì¶© ì•Œë¦¼',
                'restock-alert-desc': 'ì¬ê³  ê²½ê³  ì„¤ì •',
                'usage-record': 'ì‚¬ìš© ê¸°ë¡',
                'usage-record-desc': 'ì œí’ˆ ì‚¬ìš© ì´ë ¥ ì¡°íšŒ',
                'finance-management': 'ì¬ë¬´ ì •ë³´ ê´€ë¦¬',
                'finance-management-desc': 'ìˆ˜ìµ ê¸°ë¡, ì„œë¹„ìŠ¤ ìˆ˜ì…, ì œí’ˆ íŒë§¤ ë“± ê´€ë¦¬',
                'income-record': 'ìˆ˜ì… ê¸°ë¡',
                'income-record-desc': 'ì„œë¹„ìŠ¤ ë° íŒë§¤ ìˆ˜ì… ê¸°ë¡',
                'expense-record': 'ì§€ì¶œ ê¸°ë¡',
                'expense-record-desc': 'ê°ì¢… ì§€ì¶œ ê¸°ë¡',
                'financial-report': 'ì¬ë¬´ ë³´ê³ ì„œ',
                'financial-report-desc': 'ì¬ë¬´ ë¶„ì„ ë³´ê³ ì„œ ìƒì„±',
                'performance-target': 'ì‹¤ì  ëª©í‘œ',
                'performance-target-desc': 'ê°œì¸ ë° íŒ€ ì‹¤ì  ëª©í‘œ ê´€ë¦¬',
                'select-month': 'ì›” ì„ íƒï¼š',
                'recalculate-targets': 'ëª©í‘œ ì¬ê³„ì‚°',
                'reset-targets': 'ëª©í‘œ ì´ˆê¸°í™”',
                'team-target': 'ëŒ€ë¦¬ì  ë§¤ì¶œ ëª©í‘œ',
                'target-label': 'ëª©í‘œ',
                'actual-label': 'ì‹¤ì ',
                'thousand-won': 'ì²œì›',
                'individual-targets': 'ê°œì¸ ì‹¤ì  ëª©í‘œ',
                'employee-name-column': 'ì§ì›ëª…',
                'monthly-target': 'ì›” ëª©í‘œ',
                'monthly-actual': 'ì›” ì‹¤ì ',
                'progress-rate': 'ì§„ë„ìœ¨(%)',
                'last-month-performance': 'ì „ì›” ì‹¤ì ',
                'target-adjustment': 'ëª©í‘œ ì¡°ì •',
                'target-increased': 'ëª©í‘œ 10% ì¦ê°€',
                'target-maintained': 'ëª©í‘œ ìœ ì§€',
                'target-recalculation-complete': 'ëª©í‘œ ì¬ê³„ì‚° ì™„ë£Œ! ì´ {count}ëª…ì˜ ì§ì› ëª©í‘œê°€ ìƒí–¥ ì¡°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.',
                'confirm-reset-targets': 'ëª¨ë“  ì§ì›ì˜ ëª©í‘œë¥¼ 200ë§Œì›ìœ¼ë¡œ ì¬ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
                'targets-reset-complete': 'ëª¨ë“  ëª©í‘œê°€ 200ë§Œì›ìœ¼ë¡œ ì¬ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!',
                'auto-calculate': 'ìë™ ê³„ì‚°',
                'manual-adjust': 'ìˆ˜ë™ ì¡°ì •',
                // ê³µí†µ ë²„íŠ¼
                'back-to-main': 'ë©”ì¸ ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°',
                'add': 'ì¶”ê°€',
                'delete': 'ì‚­ì œ',
                'cancel': 'ì·¨ì†Œ',
                'close': 'ë‹«ê¸°',
                'confirm': 'í™•ì¸',
                'no-data': 'ë°ì´í„° ì—†ìŒ',
                'records': 'ê°œ ê¸°ë¡',
                'not-set': 'ì„¤ì •ë˜ì§€ ì•ŠìŒ',
                // ì‘ì—… ì„¤ëª… ë²ˆì—­
                'operation-desc-homepage-navigation': 'ë¡œê³  í´ë¦­ìœ¼ë¡œ í™ˆí˜ì´ì§€ ëŒì•„ê°€ê¸°',
                'operation-desc-system-logout': 'ì‹œìŠ¤í…œ ë¡œê·¸ì•„ì›ƒ',
                'operation-desc-user-logout': 'ì‚¬ìš©ì {user} ({position}) ì‹œìŠ¤í…œ ë¡œê·¸ì•„ì›ƒ',
                'operation-desc-create-salon': 'ìƒˆ ì‚´ë¡± ìƒì„±ï¼š{name}ï¼Œì›ì¥ï¼š{director}',
                'operation-desc-delete-salon': 'ì‚´ë¡± ì‚­ì œï¼š{name}ï¼Œì›ì¥ï¼š{director}',
                'operation-desc-edit-employee': 'ì§ì› ì •ë³´ í¸ì§‘ï¼š{name}',
                // ê°ì²´ ì´ë¦„ ë²ˆì—­
                'object-name-home-navigation': 'í™ˆí˜ì´ì§€ ë‚´ë¹„ê²Œì´ì…˜',
                'object-name-system-logout': 'ì‹œìŠ¤í…œ ë¡œê·¸ì•„ì›ƒ',
                // ë°ì´í„° í•„ë“œ ë²ˆì—­
                'field-name': 'ì´ë¦„',
                'field-position': 'ì§ìœ„',
                'field-username': 'ì‚¬ìš©ìëª…',
                'field-password': 'ë¹„ë°€ë²ˆí˜¸',
                'field-mobile': 'íœ´ëŒ€í°',
                'field-createTime': 'ìƒì„± ì‹œê°„',
                'field-bankInfo': 'ì€í–‰ ì •ë³´',
                'field-bankName': 'ì€í–‰ëª…',
                'field-accountNumber': 'ê³„ì¢Œë²ˆí˜¸',
                'field-accountHolder': 'ê³„ì¢Œ ì†Œìœ ì',
                'field-bankBranch': 'ê°œì„¤ ì§€ì ',
                'field-id': 'ID',
                'field-address': 'ì£¼ì†Œ',
                'field-district': 'ì§€ì—­',
                'field-phone': 'ì „í™”ë²ˆí˜¸',
                'field-directorName': 'ì›ì¥ëª…',
                'field-directorMobile': 'ì›ì¥ íœ´ëŒ€í°',
                'field-responsibleEmployeeId': 'ë‹´ë‹¹ ì§ì› ID',
                'field-addTime': 'ì¶”ê°€ ì‹œê°„',
                'field-joinDate': 'ê°€ì… ë‚ ì§œ',
                'field-transactions': 'ê±°ë˜ ê¸°ë¡',
                'field-lastTransactionDate': 'ë§ˆì§€ë§‰ ê±°ë˜ ë‚ ì§œ',
                // ì–‘ì‹ ê´€ë ¨
                'salon-name': 'ì‚´ë¡± ì´ë¦„ï¼š',
                'salon-address': 'ì‚´ë¡± ì£¼ì†Œï¼š',
                'salon-phone': 'ë§¤ì¥ ì „í™”ë²ˆí˜¸ï¼š',
                'director-name': 'ì›ì¥ ì´ë¦„ï¼š',
                'director-mobile': 'íœ´ëŒ€í°ï¼š',
                'transaction-desc': 'ê±°ë˜ ì„¤ëª…ï¼š',
                'transaction-amount': 'ê±°ë˜ ê¸ˆì•¡ (ì„ íƒì‚¬í•­)ï¼š',
                'add-transaction-record': 'ê±°ë˜ ê¸°ë¡ ì¶”ê°€',
                // ìƒíƒœ í…ìŠ¤íŠ¸
                'no-salon-info': 'ì‚´ë¡± ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤',
                'add-salon-tip': '"ìƒˆ ì‚´ë¡± ì¶”ê°€" í˜ì´ì§€ì—ì„œ ì‚´ë¡± ì •ë³´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”',
                'active-customer': 'í™œì„± ê³ ê°',
                'needs-attention': 'ì£¼ì˜ í•„ìš”',
                'long-inactive': 'ì¥ê¸° ë¯¸ê±°ë˜',
                'no-transaction': 'ê±°ë˜ ê¸°ë¡ ì—†ìŒ',
                'recent-transactions': 'ìµœê·¼ ê±°ë˜ ê¸°ë¡',
                'no-transactions': 'ê±°ë˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤',
                'first-join': 'ìµœì´ˆ ê°€ì…',
                'last-transaction': 'ìµœê·¼ ê±°ë˜',
                'transaction-count': 'ì´ ê±°ë˜ ê¸°ë¡',
                'days-since-last': 'ë§ˆì§€ë§‰ ê±°ë˜ í›„',
                // ê¸°íƒ€ ì¸í„°í˜ì´ìŠ¤ í…ìŠ¤íŠ¸
                'salon-info-list-desc': 'ì¶”ê°€ëœ ëª¨ë“  ì‚´ë¡±ì˜ ìƒì„¸ ì •ë³´ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.',
                'delete-warning': 'âš ï¸ ì‚­ì œ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ì§„í–‰í•´ì£¼ì„¸ìš”!',
                'select-salon-to-delete': 'ì‚­ì œí•  ì‚´ë¡± ì„ íƒ',
                'please-select-salon': 'ì‚´ë¡±ì„ ì„ íƒí•´ì£¼ì„¸ìš”...',
                'confirm-delete': 'ì‚­ì œ í™•ì¸',
                // ì»¨í…ì¸  í˜ì´ì§€ ì„¤ëª…
                'add-product-content': 'ì—¬ê¸°ì— ìƒˆë¡œìš´ í—¤ì–´ ì œí’ˆ ì •ë³´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤...',
                'product-list-content': 'ëª¨ë“  ì œí’ˆì˜ ëª©ë¡ì„ í‘œì‹œí•©ë‹ˆë‹¤...',
                'product-category-content': 'ì œí’ˆ ë¶„ë¥˜ ì •ë³´ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤...',
                'stock-check-content': 'ì¬ê³  í™•ì¸ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤...',
                'restock-alert-content': 'ë³´ì¶© ì•Œë¦¼ì„ ì„¤ì •í•˜ê³  í™•ì¸í•©ë‹ˆë‹¤...',
                'usage-record-content': 'ì œí’ˆ ì‚¬ìš© ê¸°ë¡ì„ í™•ì¸í•©ë‹ˆë‹¤...',
                'income-record-content': 'ìˆ˜ì… ì •ë³´ë¥¼ ê¸°ë¡í•˜ê³  í™•ì¸í•©ë‹ˆë‹¤...',
                'expense-record-content': 'ì§€ì¶œ ì •ë³´ë¥¼ ê¸°ë¡í•˜ê³  í™•ì¸í•©ë‹ˆë‹¤...',
                'financial-report-content': 'ì¬ë¬´ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ê³  í™•ì¸í•©ë‹ˆë‹¤...',
                // ë™ì  ì»¨í…ì¸  ë¼ë²¨
                'salon-address-label': 'ì‚´ë¡± ì£¼ì†Œ',
                'salon-phone-label': 'ë§¤ì¥ ì „í™”',
                'director-name-label': 'ì›ì¥ ì´ë¦„',
                'director-mobile-label': 'ì›ì¥ íœ´ëŒ€í°',
                'first-join-label': 'ìµœì´ˆ ê°€ì…',
                'status-label': 'ìƒíƒœ',
                'status-active': 'í™œì„±',
                'days-since-last-label': 'ë§ˆì§€ë§‰ ê±°ë˜ í›„',
                'transaction-count-label': 'ì´ ê±°ë˜ ê¸°ë¡',
                'last-transaction-label': 'ìµœê·¼ ê±°ë˜',
                'recent-transactions-label': 'ìµœê·¼ ê±°ë˜ ê¸°ë¡',
                'add-transaction-btn': 'ê±°ë˜ ì¶”ê°€',
                'delete-btn': 'ì‚­ì œ',
                'days-unit': 'ì¼',
                'transaction-unit': 'ê±´',
                'transaction-default': 'ê±°ë˜',
                'more-records': 'ì¶”ê°€ë¡œ {count}ê°œì˜ ê¸°ë¡ì´ ë” ìˆìŠµë‹ˆë‹¤...',
                // ì•Œë¦¼ ë° í™•ì¸ ë©”ì‹œì§€
                'salon-added-success': 'ì‚´ë¡± ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!',
                'salon-name-text': 'ì‚´ë¡± ì´ë¦„',
                'salon-address-text': 'ì‚´ë¡± ì£¼ì†Œ',
                'salon-phone-text': 'ë§¤ì¥ ì „í™”',
                'director-name-text': 'ì›ì¥ ì´ë¦„',
                'director-mobile-text': 'ì›ì¥ íœ´ëŒ€í°',
                'fill-required-fields': 'ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”! (ë§¤ì¥ ì „í™”ëŠ” ì„ íƒì‚¬í•­)',
                'confirm-delete-salon': 'ì‚´ë¡± "{name}"ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!',
                'salon-deleted-success': 'ì‚´ë¡±ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!',
                'select-salon-first': 'ë¨¼ì € ì‚­ì œí•  ì‚´ë¡±ì„ ì„ íƒí•´ì£¼ì„¸ìš”!',
                'transaction-added-success': 'ê±°ë˜ ê¸°ë¡ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!',
                'fill-transaction-desc': 'ê±°ë˜ ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!',
                // ìƒˆë¡œìš´ ê¸°ëŠ¥ ë²ˆì—­
                'search-salon-placeholder': 'ì‚´ë¡±ëª…, ì›ì¥ëª… ë˜ëŠ” íœ´ëŒ€í° ë²ˆí˜¸ ê²€ìƒ‰...',
                'clear-search': 'ì§€ìš°ê¸°',
                'back-to-salon-info': 'ì‚´ë¡± ì •ë³´ë¡œ ëŒì•„ê°€ê¸°',
                'filter-by-date': 'ë‚ ì§œë³„ í•„í„°ë§ï¼š',
                'to': 'ì—ì„œ',
                'filter': 'í•„í„°',
                'clear-filter': 'í•„í„° ì§€ìš°ê¸°',
                'transaction-records': 'ê±°ë˜ ê¸°ë¡',
                'back-to-transaction-list': 'ê±°ë˜ ê¸°ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°',
                'print': 'ì¸ì‡„',
                'transaction-detail': 'ê±°ë˜ ìƒì„¸ì •ë³´',
                'products': 'ì œí’ˆï¼š',
                'receivable-amount': 'ë¯¸ìˆ˜ê¸ˆï¼š',
                'received-amount': 'ì‹¤ìˆ˜ê¸ˆï¼š',
                'outstanding-amount': 'ì™¸ìƒï¼š',
                'notes': 'ë¹„ê³  (ì„ íƒì‚¬í•­)ï¼š',
                'view-all-transactions': 'ëª¨ë“  ê±°ë˜ ë³´ê¸°',
                'click-to-view-detail': 'ìƒì„¸ì •ë³´ ë³´ê¸°',
                'transaction-date': 'ê±°ë˜ ë‚ ì§œ',
                'transaction-amount-label': 'ê±°ë˜ ê¸ˆì•¡',
                'no-transactions-found': 'ì¡°ê±´ì— ë§ëŠ” ê±°ë˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤',
                'total-transactions': 'ì´ {count}ê±´ì˜ ê±°ë˜',
                'print-transaction-title': 'ê±°ë˜ ê¸°ë¡ ìƒì„¸ì •ë³´',
                'no-matching-salons': 'ì¼ì¹˜í•˜ëŠ” ì‚´ë¡±ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤',
                'select-start-end-date': 'ì‹œì‘ ë‚ ì§œì™€ ì¢…ë£Œ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”',
                // ìƒˆë¡œìš´ ì œí’ˆ í…Œì´ë¸” ê´€ë ¨ ë²ˆì—­
                'transaction-content': 'ê±°ë˜ ë‚´ìš©ï¼š',
                'product-name': 'ì œí’ˆëª…',
                'unit-price': 'ë‹¨ê°€',
                'quantity': 'ìˆ˜ëŸ‰',
                'total-amount': 'ì´ê¸ˆì•¡',
                'operation': 'ì‘ì—…',
                'add-product': 'ì œí’ˆ ì¶”ê°€',
                'total-products-amount': 'ì œí’ˆ ì´ê¸ˆì•¡ï¼š',
                'current-outstanding': 'ì´ë²ˆ ì™¸ìƒï¼š',
                'remove': 'ì‚­ì œ',
                'total-outstanding': 'ëˆ„ì  ì™¸ìƒï¼š',
                'copy-for-director': 'ì›ì¥ ë³´ê´€ìš©',
                'copy-for-agent': 'ëŒ€ë¦¬ì  ë³´ê´€ìš©',
                'historical-outstanding': 'ì´ì „ ì™¸ìƒï¼š',
                'add-at-least-one-product': 'ìµœì†Œ í•˜ë‚˜ì˜ ì œí’ˆì„ ì¶”ê°€í•´ì£¼ì„¸ìš”!',
                // ì§ì› ê´€ë¦¬ ê´€ë ¨ ë²ˆì—­
                'employee-management': 'ì§ì› ê´€ë¦¬',
                'employee-management-desc': 'ì˜ì—…ì‚¬ì› ì •ë³´, ê¶Œí•œ ë° ê³„ì • ê´€ë¦¬',
                'new-employee': 'ìƒˆ ì§ì› ì¶”ê°€',
                'new-employee-desc': 'ìƒˆë¡œìš´ ì˜ì—…ì‚¬ì› ê³„ì • ì¶”ê°€',
                'employee-list': 'ì§ì› ëª©ë¡',
                'employee-list-desc': 'ì§ì› ì •ë³´ ì¡°íšŒ ë° í¸ì§‘',
                'delete-employee': 'ì§ì› ì‚­ì œ',
                'delete-employee-desc': 'ë¶ˆí•„ìš”í•œ ì§ì› ê³„ì • ì‚­ì œ',
                'employee-name': 'ì´ë¦„ï¼š',
                'employee-position': 'ì§ìœ„ï¼š',
                'employee-username': 'ë¡œê·¸ì¸ ê³„ì •ï¼š',
                'employee-password': 'ë¹„ë°€ë²ˆí˜¸ï¼š',
                'employee-mobile': 'íœ´ëŒ€í°ï¼š',
                'bank-account-info': 'ì€í–‰ ê³„ì¢Œ ì •ë³´',
                'bank-name': 'ì€í–‰ëª…ï¼š',
                'account-number': 'ê³„ì¢Œë²ˆí˜¸ï¼š',
                'account-holder': 'ê³„ì¢Œ ì†Œìœ ìï¼š',
                'bank-branch': 'ê°œì„¤ ì§€ì  (ì„ íƒì‚¬í•­)ï¼š',
                'batch-upload-salons': 'ì‚´ë¡± ì¼ê´„ ì—…ë¡œë“œ',
                'batch-upload-description': 'ì‚´ë¡± ì •ë³´ê°€ í¬í•¨ëœ Excel í‘œ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”. í˜•ì‹ ìš”êµ¬ì‚¬í•­: 1í–‰ì€ í‘œ ì œëª©, 2í–‰ì€ ì—´ ì œëª©(ì‚´ë¡± ì´ë¦„ ë° ì£¼ì†Œ ì—´ í¬í•¨ í•„ìˆ˜), 3í–‰ë¶€í„° ì‹¤ì œ ë°ì´í„°. ì‹œìŠ¤í…œì´ ì£¼ì†Œ í‚¤ì›Œë“œì— ë”°ë¼ ìë™ìœ¼ë¡œ ì§€ì—­ì„ ì„¤ì •í•©ë‹ˆë‹¤.',
                        'select-file': 'íŒŒì¼ ì„ íƒï¼š',
        'choose-file': 'íŒŒì¼ ì„ íƒ',
        'no-file-selected': 'íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•ŠìŒ',
        'process-file': 'íŒŒì¼ ì²˜ë¦¬',
        'download-sample': 'ìƒ˜í”Œ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ',
                'preview-data': 'ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°ï¼š',
                'confirm-batch-create': 'ì¼ê´„ ìƒì„± í™•ì¸',
                'file-processed-success': 'íŒŒì¼ ì²˜ë¦¬ ì„±ê³µ! ì´ {count}ê°œì˜ ì‚´ë¡± ê¸°ë¡ì´ ì‹ë³„ë˜ì—ˆìŠµë‹ˆë‹¤.',
                'batch-create-success': 'ì¼ê´„ ìƒì„± ì„±ê³µ! ì´ {count}ê°œì˜ ì‚´ë¡±ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.',
                'file-processing-error': 'íŒŒì¼ ì²˜ë¦¬ ì˜¤ë¥˜: {error}',
                'no-valid-data': 'ìœ íš¨í•œ ì‚´ë¡± ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.',
                'select-file-first': 'ë¨¼ì € íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”!',
                'unsupported-file-type': 'ì§€ì›ë˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. Excel íŒŒì¼(.xlsx ë˜ëŠ” .xls)ì„ ì„ íƒí•´ì£¼ì„¸ìš”.',
                'salesperson': 'ì˜ì—…ì‚¬ì›',
                'manager': 'ë§¤ë‹ˆì €',
                'admin': 'ê´€ë¦¬ì',
                'select-employee-to-delete': 'ì‚­ì œí•  ì§ì› ì„ íƒ',
                'please-select-employee': 'ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”...',
                'employee-added-success': 'ì§ì›ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!',
                'employee-deleted-success': 'ì§ì›ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!',
                'username-already-exists': 'ë¡œê·¸ì¸ ê³„ì •ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤. ë‹¤ë¥¸ ê³„ì •ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”!',
                'fill-all-employee-fields': 'ëª¨ë“  ì§ì› ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!',
                'confirm-delete-employee': 'ì§ì› "{name}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ì·¨ì†Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!',
                'select-employee-first': 'ë¨¼ì € ì‚­ì œí•  ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”!',
                'salesperson-name': 'ì˜ì—…ì‚¬ì›ï¼š',
                'please-select-salesperson': 'ì˜ì—…ì‚¬ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”...',
                'edit-employee': 'ì§ì› ì •ë³´ í¸ì§‘',
                'edit-btn': 'í¸ì§‘',
                'save': 'ì €ì¥',
                'employee-updated-success': 'ì§ì› ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!',
                'username-already-exists-edit': 'í•´ë‹¹ ë¡œê·¸ì¸ ê³„ì •ì´ ë‹¤ë¥¸ ì§ì›ì— ì˜í•´ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ê³„ì •ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”!',
                'fill-employee-basic-info': 'ëª¨ë“  í•„ìˆ˜ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ì´ë¦„, ê³„ì •, íœ´ëŒ€í° ë²ˆí˜¸)!',
                'cannot-edit-admin-permission': 'ë§¤ë‹ˆì €ëŠ” ê´€ë¦¬ì ê¶Œí•œì„ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!',
                'gift-quantity': 'ì¦ì •',
                'salesperson-mobile': 'ì˜ì—…ì‚¬ì› íœ´ëŒ€í°',
                                'salesperson-label': 'ì˜ì—…ì‚¬ì›',
        'unassigned': 'ë¯¸ì§€ì •',
        'create-time': 'ìƒì„± ì‹œê°„',
        'permission-level': 'ê¶Œí•œ ë“±ê¸‰',
        'status-normal': 'ì •ìƒ',
                'agent-store-name': 'ëŒ€ë¦¬ì ëª…',
                'edit-transaction': 'ê±°ë˜ í¸ì§‘',
            'delete-transaction': 'ê±°ë˜ ì‚­ì œ',
            'confirm-delete-transaction': 'ì´ ê±°ë˜ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ì·¨ì†Œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!',
            'transaction-deleted-success': 'ê±°ë˜ ê¸°ë¡ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!',
                'edit-transaction-record': 'ê±°ë˜ ê¸°ë¡ í¸ì§‘',
                'transaction-updated-success': 'ê±°ë˜ ê¸°ë¡ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!',
                'edit-salon': 'ì‚´ë¡± ì •ë³´ í¸ì§‘',
                'salon-updated-success': 'ì‚´ë¡± ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!',
                'fill-salon-basic-info': 'ëª¨ë“  í•„ìˆ˜ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ì‚´ë¡±ëª…, ì£¼ì†Œ, ì§€ì—­, ì›ì¥ëª…, ì›ì¥ íœ´ëŒ€í°)!',
                // æ“ä½œå†å²ç›¸å…³ç¿»è¯‘
                'audit-management': 'ìš´ì˜ ê¸°ë¡ ê´€ë¦¬',
                'audit-management-desc': 'ì‹œìŠ¤í…œ ìš´ì˜ ê¸°ë¡, ë°ì´í„° ê°ì‚¬ ë° ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ê´€ë¦¬',
                'operation-history': 'ìš´ì˜ ê¸°ë¡ ì´ë ¥',
                'operation-history-desc': 'ëª¨ë“  ì‚¬ìš©ìì˜ ìš´ì˜ ê¸°ë¡ê³¼ ë°ì´í„° ë³€ê²½ ê¸°ë¡ ë³´ê¸°',
                'data-comparison': 'ë°ì´í„° ë¹„êµ ë³´ê¸°',
                'data-comparison-desc': 'ìˆ˜ì • ì „í›„ ë°ì´í„° ë³€í™” ë¹„êµ ë³´ê¸°',
                'audit-report': 'ê°ì‚¬ ë³´ê³ ì„œ',
                'audit-report-desc': 'ìš´ì˜ í†µê³„ ë° ë³´ì•ˆ ê°ì‚¬ ë³´ê³ ì„œ ìƒì„±',
                'filter-by-user': 'ì‚¬ìš©ìë³„ í•„í„°ë§ï¼š',
                'filter-by-operation': 'ìš´ì˜ ìœ í˜•ë³„ï¼š',
                'filter-by-object': 'ê°ì²´ ìœ í˜•ë³„ï¼š',
                'all-users': 'ëª¨ë“  ì‚¬ìš©ì',
                'all-operations': 'ëª¨ë“  ìš´ì˜',
                'all-objects': 'ëª¨ë“  ê°ì²´',
                'operation-create': 'ìƒì„±',
                'operation-edit': 'í¸ì§‘',
                'operation-delete': 'ì‚­ì œ',
                'operation-login': 'ë¡œê·¸ì¸',
                'operation-logout': 'ë¡œê·¸ì•„ì›ƒ',
                'operation-navigation': 'í˜ì´ì§€ íƒìƒ‰',
                'object-salon': 'ì‚´ë¡±',
                'object-transaction': 'ê±°ë˜',
                'object-employee': 'ì§ì›',
                'clear-all-filters': 'ëª¨ë“  í•„í„° ì§€ìš°ê¸°',
                'select-history-record': 'ìš´ì˜ ê¸°ë¡ ì´ë ¥ì—ì„œ ë¹„êµí•  ê¸°ë¡ì„ ì„ íƒí•˜ì„¸ìš”',
                'total-operations': 'ì´ ìš´ì˜ ìˆ˜',
                'today-operations': 'ì˜¤ëŠ˜ ìš´ì˜',
                'active-users': 'í™œì„± ì‚¬ìš©ì',
                'critical-operations': 'ì¤‘ìš” ìš´ì˜',
                'operation-time': 'ìš´ì˜ ì‹œê°„',
                'operator': 'ìš´ì˜ì',
                'operation-type': 'ìš´ì˜ ìœ í˜•',
                'object-type': 'ê°ì²´ ìœ í˜•',
                'object-name': 'ê°ì²´ ì´ë¦„',
                'operation-description': 'ìš´ì˜ ì„¤ëª…',
                'view-details': 'ì„¸ë¶€ ì •ë³´ ë³´ê¸°',
                'compare-data': 'ë°ì´í„° ë¹„êµ',
                'data-before': 'ìˆ˜ì • ì „',
                'data-after': 'ìˆ˜ì • í›„',
                'no-operation-history': 'ìš´ì˜ ê¸°ë¡ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤',
                'operation-details': 'ìš´ì˜ ì„¸ë¶€ ì •ë³´',
                'ip-address': 'IP ì£¼ì†Œ',
                'browser-info': 'ë¸Œë¼ìš°ì € ì •ë³´',
                'user-operation-stats': 'ì‚¬ìš©ì ìš´ì˜ í†µê³„',
                'user': 'ì‚¬ìš©ì',
                'total': 'ì´ ìš´ì˜ ìˆ˜',
                'create-count': 'ìƒì„±',
                'edit-count': 'í¸ì§‘',
                'delete-count': 'ì‚­ì œ', 
                'login-count': 'ë¡œê·¸ì¸',
                'recent-critical-operations': 'ìµœê·¼ ì¤‘ìš” ìš´ì˜ ê¸°ë¡',
                'no-critical-operations': 'ì¤‘ìš” ìš´ì˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤',
                'details': 'ì„¸ë¶€ ì •ë³´',
                'unknown-user': 'ì•Œ ìˆ˜ ì—†ëŠ” ì‚¬ìš©ì',
                'logout': 'ë¡œê·¸ì•„ì›ƒ',
                'confirm-logout': 'ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œï¼Ÿ',
                'no-permission-delete-salon': 'ì‚´ë¡±ì„ ì‚­ì œí•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤! ê´€ë¦¬ìë§Œ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                'no-permission-delete-employee': 'ì§ì›ì„ ì‚­ì œí•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤! ê´€ë¦¬ìë§Œ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                'no-permission-delete-transaction': 'ê±°ë˜ ê¸°ë¡ì„ ì‚­ì œí•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤! ê´€ë¦¬ìë§Œ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                'no-salesperson-salons': 'ì•„ì§ ë‹´ë‹¹í•˜ëŠ” ì‚´ë¡±ì´ ì—†ìŠµë‹ˆë‹¤',
                'salesperson-salon-tip': 'ì‚´ë¡±ì—ì„œ ê±°ë˜ ê¸°ë¡ì´ ìƒì„±ë˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤',
                'responsible-employee': 'ë‹´ë‹¹ ì§ì›',
                'please-select-employee': 'ì§ì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”...',
                'approval-required': 'ê´€ë¦¬ì ìŠ¹ì¸ì´ í•„ìš”í•œ ì‘ì—…ì…ë‹ˆë‹¤',
                'approval-submitted': 'ì‘ì—…ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤',
                'approval-approved': 'ì‘ì—…ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤',
                'approval-rejected': 'ì‘ì—…ì´ ê´€ë¦¬ìì— ì˜í•´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤',
                'pending-approvals': 'ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ì‘ì—…',
                'no-pending-approvals': 'ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ì‘ì—…ì´ ì—†ìŠµë‹ˆë‹¤',
                'approve': 'ìŠ¹ì¸',
                'reject': 'ê±°ë¶€',
                'approval-reason': 'ìŠ¹ì¸ ì˜ê²¬',
                'approval-management': 'ìŠ¹ì¸ ê´€ë¦¬',
                'approval-management-desc': 'ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ì‘ì—… ìš”ì²­ ì²˜ë¦¬',
                'all-status': 'ëª¨ë“  ìƒíƒœ',
                'pending': 'ìŠ¹ì¸ ëŒ€ê¸°',
                'approved': 'ìŠ¹ì¸ë¨',
                'rejected': 'ê±°ë¶€ë¨',
                'request-time': 'ì‹ ì²­ ì‹œê°„',
                'requester': 'ì‹ ì²­ì',
                'operation-type': 'ì‘ì—… ìœ í˜•',
                'operation-description': 'ì‘ì—… ì„¤ëª…',
                'process-time': 'ì²˜ë¦¬ ì‹œê°„',
                'processor': 'ì²˜ë¦¬ì',
                'approval-actions': 'ì‘ì—…',
                'enter-approval-reason': 'ìŠ¹ì¸ ì˜ê²¬ì„ ì…ë ¥í•´ì£¼ì„¸ìš”',
                'approval-reason-required': 'ìŠ¹ì¸ ì˜ê²¬ì„ ì…ë ¥í•´ì£¼ì„¸ìš”',
                'approval-processed-success': 'ìŠ¹ì¸ ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤',
                // ì¼ê´„ ì‘ì—… ê´€ë ¨ ë²ˆì—­
                'select-all': 'ì „ì²´ ì„ íƒ',
                'batch-delete': 'ì¼ê´„ ì‚­ì œ',
                'batch-assign': 'ì¼ê´„ ë‹´ë‹¹ì ì§€ì •',
                'selected-count': '{count}ê°œ ì‚´ë¡± ì„ íƒë¨',
                'no-salons-selected': 'ë¨¼ì € ì‘ì—…í•  ì‚´ë¡±ì„ ì„ íƒí•´ì£¼ì„¸ìš”!',
                'confirm-batch-delete': 'ì„ íƒí•œ {count}ê°œ ì‚´ë¡±ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì‚´ë¡± ëª©ë¡: {names}\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!',
                'batch-delete-success': 'ì¼ê´„ ì‚­ì œ ì„±ê³µ! ì´ {count}ê°œ ì‚´ë¡±ì„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.',
                'batch-assign-responsible': 'ì¼ê´„ ë‹´ë‹¹ì ì§€ì •',
                'select-responsible-employee': 'ë‹´ë‹¹ ì§ì› ì„ íƒï¼š',
                'batch-assign-tip': 'ì„ íƒëœ ëª¨ë“  ì‚´ë¡±ì— ë‹´ë‹¹ìë¥¼ ì¼ê´„ ì§€ì •í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ ê´€ë¦¬ì ë˜ëŠ” ë§¤ë‹ˆì € ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.',
                'batch-assign-success': 'ì¼ê´„ ì§€ì • ì„±ê³µ! ì´ {count}ê°œ ì‚´ë¡±ì˜ ë‹´ë‹¹ìë¥¼ {employee}ìœ¼ë¡œ ì§€ì •í–ˆìŠµë‹ˆë‹¤.',
                'all-districts': 'ì „ì²´ ì§€ì—­',
                'total-salons-count': 'ì´ {count}ê°œ ì‚´ë¡±',
                'district-salons-count': 'ì´ {count}ê°œ ì‚´ë¡±',
                'sort-by': 'ì •ë ¬ ë°©ì‹ï¼š',
                'sort-name': 'ì‚´ë¡±ëª… â†‘',
                'sort-address': 'ì£¼ì†Œëª… â†‘',
                'sort-add-time': 'ì¶”ê°€ì‹œê°„ â†‘',
                'sort-last-transaction': 'ìµœì¢…ê±°ë˜ â†‘',
                'sort-outstanding-days': 'ì™¸ìƒì¼ìˆ˜ â†‘',
                'sort-outstanding-amount': 'ì™¸ìƒê¸ˆì•¡ â†‘',
                'sort-default': 'ê¸°ë³¸ ì •ë ¬',
                'items-per-page': 'í˜ì´ì§€ë‹¹ï¼š',
                'items': 'ê°œ',
                'district-other': 'í•´ì™¸ì§€ì—­',
                'district-guro': 'êµ¬ë¡œêµ¬',
                'district-yeongdeungpo': 'ì˜ë“±í¬êµ¬',
                'district-geumcheon': 'ê¸ˆì²œêµ¬',
                'loading': 'ë¡œë”© ì¤‘',
                'unassigned': 'ë¯¸ì§€ì •',
                'salon-name-required': 'ì‚´ë¡± ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”ï¼',
                // ë¶„í˜ì´ì§€ ì»¨íŠ¸ë¡¤
                'first-page': 'ì²« í˜ì´ì§€',
                'prev-page': 'ì´ì „ í˜ì´ì§€',
                'next-page': 'ë‹¤ìŒ í˜ì´ì§€',
                'last-page': 'ë§ˆì§€ë§‰ í˜ì´ì§€',
                'page-info': '{current}í˜ì´ì§€ / ì´ {total}í˜ì´ì§€ ({items}ê°œ í•­ëª©)',
                'go-to-page': 'í˜ì´ì§€ë¡œ ì´ë™',
                'jump': 'ì´ë™',
                'invalid-page-number': 'ì˜ëª»ëœ í˜ì´ì§€ ë²ˆí˜¸ì…ë‹ˆë‹¤! 1ë¶€í„° {max}ê¹Œì§€ì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
                // ì‘ì—… ì„¤ëª…
                'batch-assign-description': 'ì¼ê´„ ë‹´ë‹¹ì ì§€ì •: {salons}(ì´ {count}ê°œ ì‚´ë¡±)ì˜ ë‹´ë‹¹ìë¥¼ {employee}ë¡œ ì„¤ì •'
            }
        };
        
        // ì–¸ì–´ ì „í™˜ í•¨ìˆ˜
        function switchLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            
            // ë²„íŠ¼ í™œì„± ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('btn-' + lang).classList.add('active');
            
            // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            updateTexts();
            
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
            updateUserInfo();
            
            // å¼ºåˆ¶æ›´æ–°æ‰€æœ‰åŠ¨æ€é€‰é¡¹ï¼ˆæ— è®ºå½“å‰æ˜¯å¦æ˜¾ç¤ºï¼‰
            updateAllDynamicOptions();
            
            // æ›´æ–°æ—¥æœŸè¾“å…¥æ¡†çš„è¯­è¨€è®¾ç½®
            updateDateInputLanguages(lang);
            
            // é‡æ–°æ¸²æŸ“å½“å‰æ´»è·ƒçš„é¡µé¢å†…å®¹
            refreshCurrentPageContent();
        }
        
        // æ›´æ–°æ—¥æœŸè¾“å…¥æ¡†çš„è¯­è¨€è®¾ç½®
        function updateDateInputLanguages(lang) {
            const langCode = lang === 'ko' ? 'ko-KR' : 'zh-CN';
            document.querySelectorAll('input[type="date"]').forEach(dateInput => {
                dateInput.setAttribute('lang', langCode);
            });
        }
        
        // åˆå§‹åŒ–æ—¥æœŸè¾“å…¥æ¡†
        function initializeDateInputs() {
            document.querySelectorAll('.date-input-wrapper').forEach(wrapper => {
                const dateInput = wrapper.querySelector('input[type="date"]');
                if (!dateInput) return;
                
                // æ›´æ–°wrapperçŠ¶æ€
                function updateWrapperState() {
                    if (dateInput.value) {
                        wrapper.classList.add('has-value');
                    } else {
                        wrapper.classList.remove('has-value');
                    }
                }
                
                // åˆå§‹çŠ¶æ€
                updateWrapperState();
                
                // ç›‘å¬å€¼å˜åŒ–
                dateInput.addEventListener('input', function(e) {
                    let value = e.target.value;
                    
                    // å¦‚æœæ˜¯çº¯æ•°å­—è¾“å…¥ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–
                    if (value && !value.includes('-') && value.length === 8) {
                        // å‡è®¾è¾“å…¥æ ¼å¼ä¸º YYYYMMDD
                        const year = value.substring(0, 4);
                        const month = value.substring(4, 6);
                        const day = value.substring(6, 8);
                        
                        // éªŒè¯æ—¥æœŸåˆæ³•æ€§
                        const date = new Date(year, month - 1, day);
                        if (date.getFullYear() == year && 
                            date.getMonth() == month - 1 && 
                            date.getDate() == day) {
                            e.target.value = `${year}-${month}-${day}`;
                        }
                    }
                    
                    updateWrapperState();
                });
                
                dateInput.addEventListener('change', updateWrapperState);
                dateInput.addEventListener('focus', function() {
                    wrapper.classList.add('focused');
                });
                
                dateInput.addEventListener('blur', function() {
                    wrapper.classList.remove('focused');
                    updateWrapperState();
                });
            });
        }
        
        // æ›´æ–°è´Ÿè´£äººå‘˜ç­›é€‰é€‰é¡¹
        function updateResponsibleFilterOptions() {
            const selectElement = document.getElementById('responsible-filter');
            if (!selectElement) return;
            
            const employees = getEmployees();
            let optionsHtml = `<option value="">${getText('all-employees')}</option>`;
            optionsHtml += `<option value="unassigned">${getText('unassigned')}</option>`;
            
            // æ ¹æ®æƒé™ç­›é€‰å¯è§çš„è´Ÿè´£äººå‘˜
            if (currentUser) {
                if (currentUser.position === 'admin') {
                    // ç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰äººå‘˜
                    employees.forEach(employee => {
                        const positionText = getPositionText(employee.position);
                        optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                    });
                } else if (currentUser.position === 'manager') {
                    // ç»ç†å¯ä»¥çœ‹åˆ°ä¸šåŠ¡å‘˜å’Œè‡ªå·±
                    employees.forEach(employee => {
                        if (employee.position === 'salesperson' || employee.id === currentUser.id) {
                            const positionText = getPositionText(employee.position);
                            optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                        }
                    });
                } else if (currentUser.position === 'salesperson') {
                    // ä¸šåŠ¡å‘˜åªèƒ½çœ‹åˆ°è‡ªå·±
                    const positionText = getPositionText(currentUser.position);
                    optionsHtml += `<option value="${currentUser.id}">${currentUser.name} - ${positionText}</option>`;
                }
            } else {
                // å¦‚æœæ²¡æœ‰ç™»å½•ç”¨æˆ·ï¼ˆå‘åå…¼å®¹ï¼‰ï¼Œæ˜¾ç¤ºæ‰€æœ‰
                employees.forEach(employee => {
                    const positionText = getPositionText(employee.position);
                    optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                });
            }
            
            selectElement.innerHTML = optionsHtml;
        }
        
        // æ›´æ–°æ‰€æœ‰åŠ¨æ€é€‰é¡¹
        function updateAllDynamicOptions() {
            // å®‰å…¨æ›´æ–°å‡½æ•°ï¼ˆæ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼‰
            function safeUpdate(updateFn) {
                try {
                    updateFn();
                } catch (e) {
                    // å¿½ç•¥ä¸å­˜åœ¨çš„å…ƒç´ é”™è¯¯
                }
            }
            
            safeUpdate(() => updateResponsibleEmployeeOptions());
            safeUpdate(() => updateEditResponsibleEmployeeOptions());
            safeUpdate(() => updateSalespersonOptions());
            safeUpdate(() => updateEditSalespersonOptions());
            safeUpdate(() => updateDeleteSalonOptions());
            safeUpdate(() => updateDeleteEmployeeOptions());
            safeUpdate(() => updateResponsibleFilterOptions());
        }
        
        // åˆ·æ–°å½“å‰é¡µé¢å†…å®¹
        async function refreshCurrentPageContent() {
            // æ£€æŸ¥å½“å‰æ¿€æ´»çš„é¡µé¢å¹¶é‡æ–°æ¸²æŸ“
            const activePages = document.querySelectorAll('.content-area.active');
            
            for (const page of activePages) {
                const pageId = page.id;
                
                switch(pageId) {
                    case 'employee-list':
                        await displayEmployeeList();
                        break;
                    case 'salon-info':
                        await displaySalonList(null, 1); // åˆå§‹åŒ–æ—¶æ˜¾ç¤ºç¬¬ä¸€é¡µ
                        break;
                    case 'delete-salon':
                        await updateDeleteSalonOptions();
                        break;
                    case 'delete-employee':
                        await updateDeleteEmployeeOptions();
                        break;
                    case 'transaction-list':
                        if (currentViewingSalonId) {
                            displayTransactionList(currentViewingSalonId);
                        }
                        break;
                    case 'transaction-detail':
                        if (currentViewingSalonId && currentTransactionId) {
                displayTransactionDetail(currentViewingSalonId, currentTransactionId);
            }
                        break;
                    case 'approval-management':
                        displayApprovalList();
                        break;
                    case 'operation-history':
                        displayOperationHistory(1); // åˆ·æ–°æ—¶æ˜¾ç¤ºç¬¬ä¸€é¡µ
                        break;
                    case 'audit-report':
                        displayAuditReport();
                        break;
                    case 'performance-target':
                        generateMonthOptions();
                        displayPerformanceTargets();
                        break;
                    case 'data-comparison':
                        // å¦‚æœæœ‰ä¿å­˜çš„æ“ä½œè®°å½•ï¼Œé‡æ–°æ˜¾ç¤ºæ•°æ®å¯¹æ¯”
                        if (currentComparisonOperation) {
                            displayDataComparison(currentComparisonOperation);
                        }
                        break;
                }
            }
            
            // æ›´æ–°æ¨¡æ€æ¡†ä¸­çš„é€‰é¡¹ï¼ˆå¦‚æœæœ‰æ‰“å¼€çš„æ¨¡æ€æ¡†ï¼‰
            await updateModalOptions();
            
            // é‡æ–°åˆå§‹åŒ–æ—¥æœŸè¾“å…¥æ¡†
            setTimeout(() => {
                initializeDateInputs();
            }, 100);
        }
        
        // æ›´æ–°æ¨¡æ€æ¡†é€‰é¡¹
        async function updateModalOptions() {
            // æ£€æŸ¥å¹¶æ›´æ–°æ–°å¢æ²™é¾™æ¨¡æ€æ¡†
            const newSalonModal = document.getElementById('newSalonForm');
            if (newSalonModal && newSalonModal.closest('.content-area').classList.contains('active')) {
                await updateResponsibleEmployeeOptions();
            }
            
            // æ£€æŸ¥å¹¶æ›´æ–°ç¼–è¾‘æ²™é¾™æ¨¡æ€æ¡†
            const editSalonModal = document.getElementById('editSalonModal');
            if (editSalonModal && editSalonModal.style.display === 'flex') {
                await updateEditResponsibleEmployeeOptions();
            }
            
            // æ£€æŸ¥å¹¶æ›´æ–°äº¤æ˜“æ¨¡æ€æ¡†
            const transactionModal = document.getElementById('transactionModal');
            if (transactionModal && transactionModal.style.display === 'flex') {
                await updateSalespersonOptions();
            }
            
            // æ£€æŸ¥å¹¶æ›´æ–°ç¼–è¾‘äº¤æ˜“æ¨¡æ€æ¡†
            const editTransactionModal = document.getElementById('editTransactionModal');
            if (editTransactionModal && editTransactionModal.style.display === 'flex') {
                await updateEditSalespersonOptions();
            }
        }
        
        // ëª¨ë“  í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        function updateTexts() {
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    let text = translations[currentLanguage][key];
                    
                    // å¤„ç†å¸¦å‚æ•°çš„ç¿»è¯‘
                    const params = element.getAttribute('data-i18n-params');
                    if (params) {
                        try {
                            const paramObj = JSON.parse(params);
                            Object.keys(paramObj).forEach(paramKey => {
                                text = text.replace(`{${paramKey}}`, paramObj[paramKey]);
                            });
                        } catch (e) {
                            console.warn('Invalid data-i18n-params:', params);
                        }
                    }
                    
                    element.textContent = text;
                }
            });
            
            // æ›´æ–°placeholderæ–‡æœ¬
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.placeholder = translations[currentLanguage][key];
                }
            });
            
            // ç‰¹åˆ«æ›´æ–°æ’åºæŒ‰é’®æ–‡æœ¬ï¼ˆç¡®ä¿ä¸è¢«é€šç”¨æ›´æ–°è¦†ç›–ï¼‰
            setTimeout(() => {
                if (typeof updateAllSortButtonStyles === 'function') {
                    updateAllSortButtonStyles();
                }
            }, 50);
            
            // æ›´æ–°æ–‡ä»¶ä¸Šä¼ æ§ä»¶æ–‡å­—
            const fileUploadText = document.getElementById('file-upload-text');
            if (fileUploadText) {
                fileUploadText.textContent = getText('choose-file');
            }
        }
        
        // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
        function updateUserInfo() {
            const userInfoElement = document.getElementById('userInfo');
            const userPositionElement = document.getElementById('userPosition');
            const userNameElement = document.getElementById('userName');
            
            if (currentUser) {
                // è·å–æƒé™åç§°çš„ç¿»è¯‘
                let positionText = '';
                switch (currentUser.position) {
                    case 'admin':
                        positionText = getText('admin');
                        break;
                    case 'manager':
                        positionText = getText('manager');
                        break;
                    case 'salesperson':
                        positionText = getText('salesperson');
                        break;
                    default:
                        positionText = currentUser.position;
                }
                
                userPositionElement.textContent = positionText;
                userNameElement.textContent = currentUser.name;
                userInfoElement.style.display = 'flex';
                
                // æ ¹æ®æƒé™æ˜¾ç¤º/éšè—èœå•é¡¹
                const deleteEmployeeMenu = document.getElementById('delete-employee-menu');
                const deleteSalonMenu = document.getElementById('delete-salon-menu');
                const newEmployeeMenu = document.getElementById('new-employee-menu');
                const approvalManagementMenu = document.getElementById('approval-management-menu');
                
                if (currentUser.position === 'admin') {
                    // ç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰é€‰é¡¹
                    if (deleteEmployeeMenu) deleteEmployeeMenu.style.display = 'block';
                    if (deleteSalonMenu) deleteSalonMenu.style.display = 'block';
                    if (newEmployeeMenu) newEmployeeMenu.style.display = 'block';
                    if (approvalManagementMenu) approvalManagementMenu.style.display = 'block';
                } else if (currentUser.position === 'manager') {
                    // ç»ç†å¯ä»¥æ–°å¢èŒå‘˜ï¼Œä½†ä¸èƒ½åˆ é™¤
                    if (deleteEmployeeMenu) deleteEmployeeMenu.style.display = 'none';
                    if (deleteSalonMenu) deleteSalonMenu.style.display = 'none';
                    if (newEmployeeMenu) newEmployeeMenu.style.display = 'block';
                    if (approvalManagementMenu) approvalManagementMenu.style.display = 'none';
                } else {
                    // ä¸šåŠ¡å‘˜ä¸èƒ½çœ‹åˆ°æ–°å¢å’Œåˆ é™¤é€‰é¡¹
                    if (deleteEmployeeMenu) deleteEmployeeMenu.style.display = 'none';
                    if (deleteSalonMenu) deleteSalonMenu.style.display = 'none';
                    if (newEmployeeMenu) newEmployeeMenu.style.display = 'none';
                    if (approvalManagementMenu) approvalManagementMenu.style.display = 'none';
                }
            } else {
                userInfoElement.style.display = 'none';
                
                // æœªç™»å½•æ—¶éšè—ç›¸å…³é€‰é¡¹
                const deleteEmployeeMenu = document.getElementById('delete-employee-menu');
                const deleteSalonMenu = document.getElementById('delete-salon-menu');
                const newEmployeeMenu = document.getElementById('new-employee-menu');
                const approvalManagementMenu = document.getElementById('approval-management-menu');
                if (deleteEmployeeMenu) deleteEmployeeMenu.style.display = 'none';
                if (deleteSalonMenu) deleteSalonMenu.style.display = 'none';
                if (newEmployeeMenu) newEmployeeMenu.style.display = 'none';
                if (approvalManagementMenu) approvalManagementMenu.style.display = 'none';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ì–¸ì–´ ë¶ˆëŸ¬ì˜¤ê¸°
        document.addEventListener('DOMContentLoaded', function() {
            const savedLanguage = localStorage.getItem('language') || 'zh';
            if (savedLanguage !== 'zh') {
                switchLanguage(savedLanguage);
            } else {
                // ç¡®ä¿ä¸­æ–‡ä¹Ÿèƒ½æ­£ç¡®æ˜¾ç¤º
                updateTexts();
                // åˆå§‹åŒ–æ—¥æœŸè¾“å…¥æ¡†çš„è¯­è¨€è®¾ç½®
                updateDateInputLanguages('zh');
            }
            
            // åˆå§‹åŒ–ä¸»é¢˜
            initializeTheme();
            
            // åˆå§‹åŒ–æ—¥æœŸè¾“å…¥æ¡†
            initializeDateInputs();
            
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
            updateUserInfo();
            
            // åˆå§‹åŒ–æ’åºæŒ‰é’®æ ·å¼
            setTimeout(() => {
                if (typeof updateAllSortButtonStyles === 'function') {
                    // ç¡®ä¿åˆå§‹çŠ¶æ€æ­£ç¡®
                    currentSortField = 'default';
                    currentSortOrder = '';
                    updateAllSortButtonStyles();
                }
            }, 100);
            
            // åˆå§‹åŒ–æ–‡ä»¶ä¸Šä¼ æ§ä»¶
            initializeFileUpload();
        });
        
        // ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
        function getText(key) {
            return translations[currentLanguage] && translations[currentLanguage][key] 
                ? translations[currentLanguage][key] 
                : key;
        }
        
        // ==================== ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½ ====================
        
        // æ£€æµ‹ç³»ç»Ÿä¸»é¢˜åå¥½
        function getSystemTheme() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
                return 'light';
            }
            return 'dark';
        }
        
        // è·å–å½“å‰ä¸»é¢˜
        function getCurrentTheme() {
            return localStorage.getItem('theme') || getSystemTheme();
        }
        
        // åº”ç”¨ä¸»é¢˜
        function applyTheme(theme) {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            
            if (theme === 'light') {
                body.classList.add('light-theme');
                themeIcon.textContent = 'â˜€ï¸';
            } else {
                body.classList.remove('light-theme');
                themeIcon.textContent = 'ğŸŒ™';
            }
            
            localStorage.setItem('theme', theme);
        }
        
        // åˆ‡æ¢ä¸»é¢˜
        function toggleTheme() {
            const currentTheme = getCurrentTheme();
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            applyTheme(newTheme);
        }
        
        // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–
        function initializeTheme() {
            const savedTheme = getCurrentTheme();
            applyTheme(savedTheme);
            
            // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–ï¼ˆå¦‚æœç”¨æˆ·æ²¡æœ‰æ‰‹åŠ¨è®¾ç½®è¿‡ï¼‰
            if (!localStorage.getItem('theme')) {
                window.matchMedia('(prefers-color-scheme: light)').addEventListener('change', (e) => {
                    const systemTheme = e.matches ? 'light' : 'dark';
                    applyTheme(systemTheme);
                });
            }
        }
        
        // ==================== è¥ä¸šæ‰§ç…§å·ç æ ¼å¼åŒ– ====================
        
        // æ ¼å¼åŒ–è¥ä¸šæ‰§ç…§å·ç ä¸º 000-00-00000 æ ¼å¼
        function formatBusinessLicense(input) {
            // ç§»é™¤æ‰€æœ‰éæ•°å­—å­—ç¬¦
            let value = input.value.replace(/\D/g, '');
            
            // é™åˆ¶æœ€å¤š11ä½æ•°å­—
            if (value.length > 11) {
                value = value.substring(0, 11);
            }
            
            // æ·»åŠ æ ¼å¼åŒ–
            if (value.length > 5) {
                value = value.substring(0, 3) + '-' + value.substring(3, 5) + '-' + value.substring(5);
            } else if (value.length > 3) {
                value = value.substring(0, 3) + '-' + value.substring(3);
            }
            
            input.value = value;
        }
        
        // ==================== äº§å“å†å²è®°å½•æ£€æŸ¥ ====================
        
        // æ£€æŸ¥äº§å“å†å²äº¤æ˜“è®°å½•
        async function checkProductHistory(input) {
            const productName = input.value.trim();
            const historySection = document.getElementById('product-history-section');
            const historyDisplay = document.getElementById('product-history-display');
            
            if (!productName || productName.length < 2) {
                historySection.style.display = 'none';
                return;
            }
            
            // è·å–å½“å‰æ²™é¾™ID
            if (!currentSalonId) {
                historySection.style.display = 'none';
                return;
            }
            
            // è·å–æ²™é¾™æ•°æ®
            const salons = await getSalons();
            const salon = salons.find(s => s.id === currentSalonId);
            
            if (!salon || !salon.transactions || salon.transactions.length === 0) {
                historySection.style.display = 'none';
                return;
            }
            
            // æŸ¥æ‰¾åŒ…å«ç›¸åŒäº§å“çš„å†å²äº¤æ˜“
            const matchingTransactions = [];
            salon.transactions.forEach(transaction => {
                if (transaction.products && transaction.products.length > 0) {
                    const matchingProducts = transaction.products.filter(product => 
                        product.name && product.name.toLowerCase().includes(productName.toLowerCase())
                    );
                    
                    if (matchingProducts.length > 0) {
                        matchingTransactions.push({
                            transaction: transaction,
                            products: matchingProducts
                        });
                    }
                }
            });
            
            if (matchingTransactions.length === 0) {
                historySection.style.display = 'none';
                return;
            }
            
            // æ˜¾ç¤ºå†å²è®°å½•
            displayProductHistory(matchingTransactions, productName);
            historySection.style.display = 'block';
        }
        
        // æ˜¾ç¤ºäº§å“å†å²è®°å½•
        function displayProductHistory(matchingTransactions, searchProductName) {
            const historyDisplay = document.getElementById('product-history-display');
            
            if (matchingTransactions.length === 0) {
                historyDisplay.innerHTML = `<p style="color: #cccccc; margin: 0;">æœªæ‰¾åˆ°ç›¸å…³äº§å“çš„å†å²äº¤æ˜“è®°å½•</p>`;
                return;
            }
            
            // æŒ‰äº¤æ˜“æ—¶é—´æ’åºï¼Œæœ€æ–°çš„åœ¨å‰é¢
            matchingTransactions.sort((a, b) => new Date(b.transaction.date) - new Date(a.transaction.date));
            
            let html = `<div style="margin-bottom: 8px; color: var(--gold); font-weight: bold;">äº§å“"${searchProductName}"çš„å†å²äº¤æ˜“è®°å½•ï¼š</div>`;
            
            // åªæ˜¾ç¤ºæœ€è¿‘çš„3æ¡è®°å½•
            const recentTransactions = matchingTransactions.slice(0, 3);
            
            recentTransactions.forEach((item, index) => {
                const transaction = item.transaction;
                const products = item.products;
                const transactionDate = new Date(transaction.date);
                const daysSince = Math.floor((new Date() - transactionDate) / (1000 * 60 * 60 * 24));
                
                html += `<div style="background: rgba(0,0,0,0.2); padding: 8px; margin: 5px 0; border-radius: 3px; border: 1px solid rgba(212, 175, 55, 0.2);">`;
                html += `<div style="color: #87CEEB; font-size: 0.9em; margin-bottom: 5px;">è·ä¸Šæ¬¡äº¤æ˜“ï¼š${daysSince}å¤©å‰ (${transactionDate.toLocaleDateString()})</div>`;
                
                products.forEach(product => {
                    html += `<div style="color: #cccccc; font-size: 0.9em;">`;
                    html += `${product.name} - å•ä»·: ${formatCurrency(product.unitPrice || 0)} - æ•°é‡: ${product.quantity || 0}`;
                    if (product.giftQuantity && product.giftQuantity > 0) {
                        html += ` - èµ é€: ${product.giftQuantity}`;
                    }
                    html += ` - é‡‘é¢: ${formatCurrency(product.totalAmount || 0)}`;
                    html += `</div>`;
                });
                
                if (transaction.salesperson) {
                    html += `<div style="color: #aaa; font-size: 0.8em; margin-top: 3px;">ä¸šåŠ¡å‘˜ï¼š${transaction.salesperson}</div>`;
                }
                html += `</div>`;
            });
            
            if (matchingTransactions.length > 3) {
                html += `<div style="text-align: center; color: #aaa; font-size: 0.8em; margin-top: 5px;">è¿˜æœ‰ ${matchingTransactions.length - 3} æ¡ç›¸å…³è®°å½•...</div>`;
            }
            
            historyDisplay.innerHTML = html;
        }
        
        // åˆå§‹åŒ–æ–‡ä»¶ä¸Šä¼ æ§ä»¶
        function initializeFileUpload() {
            const fileInput = document.getElementById('salon-file-upload');
            const fileUploadText = document.getElementById('file-upload-text');
            const selectedFileName = document.getElementById('selected-file-name');
            
            if (fileInput && fileUploadText && selectedFileName) {
                // ç›‘å¬æ–‡ä»¶é€‰æ‹©å˜åŒ–
                fileInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        // æœ‰æ–‡ä»¶è¢«é€‰æ‹©
                        fileUploadText.textContent = getText('choose-file');
                        selectedFileName.textContent = `âœ“ ${file.name}`;
                        selectedFileName.style.display = 'block';
                    } else {
                        // æ²¡æœ‰æ–‡ä»¶è¢«é€‰æ‹©
                        fileUploadText.textContent = getText('choose-file');
                        selectedFileName.style.display = 'none';
                    }
                });
                
                // åˆå§‹åŒ–æ˜¾ç¤º
                fileUploadText.textContent = getText('choose-file');
                selectedFileName.style.display = 'none';
            }
        }
        
        // è·å–èŒä½åç§°ç¿»è¯‘
        function getPositionText(position) {
            return getText(position);
        }
        
        // è·å–åŒºåŸŸåç§°ç¿»è¯‘
        function getDistrictText(district) {
            return getText(district + '-district');
        }
        
        // ì‚´ë¡± ë°ì´í„° ê´€ë¦¬ - äº‘ç«¯åŒæ­¥ç‰ˆæœ¬
        async function getSalons() {
            return await cloudDataManager.getSalons();
        }
        
        async function saveSalons(salons) {
            // æ¸…é™¤æ‰€æœ‰æ²™é¾™çš„ç¼“å­˜æ•°æ®ï¼Œç¡®ä¿ä¸‹æ¬¡è®¡ç®—æ—¶ä½¿ç”¨æœ€æ–°æ•°æ®
            salons.forEach(salon => {
                delete salon._cachedTotalOutstanding;
                delete salon._lastCalculatedTime;
                delete salon._cachedOutstandingMonths;
                delete salon._lastMonthsCalculatedTime;
            });
            
            // æ‰¹é‡ä¿å­˜åˆ°äº‘ç«¯
            for (const salon of salons) {
                await cloudDataManager.saveSalon(salon);
            }
        }
        
        async function addSalon(salon) {
            try {
                salon.id = Date.now(); // ç®€å•çš„IDç”Ÿæˆ
                salon.addTime = new Date().toLocaleString('zh-CN');
                salon.joinDate = new Date(); // åŠ å…¥æ—¥æœŸï¼Œç”¨äºè®¡ç®—
                salon.transactions = []; // åˆå§‹åŒ–äº¤æ˜“è®°å½•æ•°ç»„
                salon.lastTransactionDate = null; // æœ€åä¸€æ¬¡äº¤æ˜“æ—¥æœŸ
                
                // ç›´æ¥ä¿å­˜åˆ°äº‘ç«¯
                await cloudDataManager.saveSalon(salon);
                
                // è®°å½•æ“ä½œå†å²
                recordOperation(
                    'create', 
                    'salon', 
                    salon.id, 
                    salon.name, 
                    `åˆ›å»ºæ–°æ²™é¾™ï¼š${salon.name}ï¼Œé™¢é•¿ï¼š${salon.directorName}`,
                    null,
                    salon
                );
                
                return true; // æˆåŠŸè¿”å›true
            } catch (error) {
                console.error('addSalon å¤±è´¥:', error);
                return false; // å¤±è´¥è¿”å›false
            }
        }
        
        async function deleteSalon(salonId) {
            const salons = await getSalons();
            const salonToDelete = salons.find(salon => salon.id === salonId);
            
            // ç›´æ¥ä»äº‘ç«¯åˆ é™¤
            await cloudDataManager.deleteSalon(salonId);
            
            // è®°å½•æ“ä½œå†å²
            if (salonToDelete) {
                recordOperation(
                    'delete', 
                    'salon', 
                    salonToDelete.id, 
                    salonToDelete.name, 
                    `åˆ é™¤æ²™é¾™ï¼š${salonToDelete.name}ï¼Œé™¢é•¿ï¼š${salonToDelete.directorName}`,
                    salonToDelete,
                    null
                );
            }
        }
        
        async function updateSalon(updatedSalon) {
            const salons = await getSalons();
            const index = salons.findIndex(salon => salon.id === updatedSalon.id);
            
            if (index !== -1) {
                const beforeData = JSON.parse(JSON.stringify(salons[index]));
                
                // ä¿ç•™åŸæœ‰çš„åˆ›å»ºæ—¶é—´å’Œäº¤æ˜“è®°å½•
                updatedSalon.addTime = salons[index].addTime;
                updatedSalon.joinDate = salons[index].joinDate;
                updatedSalon.transactions = salons[index].transactions;
                updatedSalon.lastTransactionDate = salons[index].lastTransactionDate;
                
                // ç›´æ¥ä¿å­˜åˆ°äº‘ç«¯
                await cloudDataManager.saveSalon(updatedSalon);
                
                // è®°å½•æ“ä½œå†å²
                recordOperation(
                    'edit', 
                    'salon', 
                    updatedSalon.id, 
                    updatedSalon.name, 
                    `ç¼–è¾‘æ²™é¾™ä¿¡æ¯ï¼š${updatedSalon.name}`,
                    beforeData,
                    updatedSalon
                );
                
                return true;
            }
            return false;
        }
        
        // èŒå‘˜æ•°æ®ç®¡ç† - äº‘ç«¯åŒæ­¥ç‰ˆæœ¬
        async function getEmployees() {
            return await cloudDataManager.getEmployees();
        }
        
        async function saveEmployees(employees) {
            // æ‰¹é‡ä¿å­˜åˆ°äº‘ç«¯
            for (const employee of employees) {
                await cloudDataManager.saveEmployee(employee);
            }
        }
        
        async function addEmployee(employee) {
            const employees = await getEmployees();
            
            // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
            if (employees.some(emp => emp.username === employee.username)) {
                return false; // ç”¨æˆ·åå·²å­˜åœ¨
            }
            
            employee.id = Date.now();
            employee.createTime = new Date().toLocaleString('zh-CN');
            
            // ç›´æ¥ä¿å­˜åˆ°äº‘ç«¯
            await cloudDataManager.saveEmployee(employee);
            
            // è®°å½•æ“ä½œå†å²
            recordOperation(
                'create', 
                'employee', 
                employee.id, 
                employee.name, 
                `åˆ›å»ºæ–°èŒå‘˜ï¼š${employee.name}ï¼ŒèŒä½ï¼š${employee.position}`,
                null,
                employee
            );
            
            return true;
        }
        
        async function deleteEmployee(employeeId) {
            const employees = await getEmployees();
            const employeeToDelete = employees.find(employee => employee.id === employeeId);
            
            // ç›´æ¥ä»äº‘ç«¯åˆ é™¤
            await cloudDataManager.deleteEmployee(employeeId);
            
            // è®°å½•æ“ä½œå†å²
            if (employeeToDelete) {
                recordOperation(
                    'delete', 
                    'employee', 
                    employeeToDelete.id, 
                    employeeToDelete.name, 
                    `åˆ é™¤èŒå‘˜ï¼š${employeeToDelete.name}ï¼ŒèŒä½ï¼š${employeeToDelete.position}`,
                    employeeToDelete,
                    null
                );
            }
        }
        
        async function updateEmployee(updatedEmployee) {
            const employees = await getEmployees();
            const index = employees.findIndex(emp => emp.id === updatedEmployee.id);
            
            if (index !== -1) {
                // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦è¢«å…¶ä»–èŒå‘˜ä½¿ç”¨
                const existingUser = employees.find(emp => emp.username === updatedEmployee.username && emp.id !== updatedEmployee.id);
                if (existingUser) {
                    return false; // ç”¨æˆ·åå·²å­˜åœ¨
                }
                
                const beforeData = JSON.parse(JSON.stringify(employees[index]));
                
                // ä¿ç•™åˆ›å»ºæ—¶é—´
                updatedEmployee.createTime = employees[index].createTime;
                
                // å¦‚æœå¯†ç ä¸ºç©ºï¼Œä¿ç•™åŸå¯†ç 
                if (!updatedEmployee.password || updatedEmployee.password.trim() === '') {
                    updatedEmployee.password = employees[index].password;
                }
                
                // ç›´æ¥ä¿å­˜åˆ°äº‘ç«¯
                await cloudDataManager.saveEmployee(updatedEmployee);
                
                // è®°å½•æ“ä½œå†å²
                recordOperation(
                    'edit', 
                    'employee', 
                    updatedEmployee.id, 
                    updatedEmployee.name, 
                    `ç¼–è¾‘èŒå‘˜ä¿¡æ¯ï¼š${updatedEmployee.name}`,
                    beforeData,
                    updatedEmployee
                );
                
                // å¦‚æœä¿®æ”¹çš„æ˜¯å½“å‰ç™»å½•ç”¨æˆ·ï¼Œæ›´æ–°å½“å‰ç”¨æˆ·ä¿¡æ¯
                if (currentUser && currentUser.id === updatedEmployee.id) {
                    setCurrentUser(updatedEmployee);
                    // updateUserInfoä¼šåœ¨setCurrentUserä¸­è¢«è°ƒç”¨
                }
                
                return true;
            }
            return false;
        }
        
        // å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
        let currentUser = null;
        
        function getCurrentUser() {
            const userInfo = localStorage.getItem('currentUser');
            return userInfo ? JSON.parse(userInfo) : null;
        }
        
        function setCurrentUser(user, isLogin = false) {
            currentUser = user;
            localStorage.setItem('currentUser', JSON.stringify(user));
            
            // è®°å½•ç™»å½•å†å²ï¼ˆåªåœ¨çœŸæ­£ç™»å½•æ—¶è®°å½•ï¼Œä¸åœ¨ç³»ç»Ÿåˆå§‹åŒ–æ—¶è®°å½•ï¼‰
            if (isLogin) {
                recordOperation(
                    'login', 
                    'system', 
                    user.id, 
                    'ç³»ç»Ÿç™»å½•', 
                    `ç”¨æˆ· ${user.name} (${user.position}) ç™»å½•ç³»ç»Ÿ`,
                    null,
                    null
                );
            }
            
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
            updateUserInfo();
        }
        
        function logout() {
            if (currentUser) {
                // è®°å½•ç™»å‡ºå†å²
                recordOperation(
                    'logout', 
                    'system', 
                    currentUser.id, 
                    'ç³»ç»Ÿç™»å‡º', 
                    `ç”¨æˆ· ${currentUser.name} (${currentUser.position}) ç™»å‡ºç³»ç»Ÿ`,
                    null,
                    null
                );
            }
            
            currentUser = null;
            localStorage.removeItem('currentUser');
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
            updateUserInfo();
            
            // è·³è½¬åˆ°ç™»å½•é¡µé¢
            window.location.href = 'login.html';
        }
        
        // æ˜¾ç¤ºç”¨æˆ·èœå•
        function showUserMenu() {
            // ç§»é™¤å·²å­˜åœ¨çš„èœå•
            const existingMenu = document.getElementById('userDropdownMenu');
            if (existingMenu) {
                existingMenu.remove();
                return;
            }
            
            const userNameElement = document.getElementById('userName');
            const rect = userNameElement.getBoundingClientRect();
            
            const menu = document.createElement('div');
            menu.id = 'userDropdownMenu';
            menu.style.cssText = `
                position: fixed;
                top: ${rect.bottom + 5}px;
                right: ${window.innerWidth - rect.right}px;
                background: var(--dark-gray);
                border: 1px solid var(--gold);
                border-radius: 5px;
                padding: 8px 0;
                box-shadow: 0 4px 12px rgba(0,0,0,0.5);
                z-index: 10000;
                min-width: 120px;
            `;
            
            const logoutItem = document.createElement('div');
            logoutItem.style.cssText = `
                padding: 10px 15px;
                color: var(--text-light);
                cursor: pointer;
                transition: background-color 0.2s;
            `;
            logoutItem.textContent = getText('logout');
            logoutItem.onmouseover = () => logoutItem.style.backgroundColor = 'rgba(212, 175, 55, 0.2)';
            logoutItem.onmouseout = () => logoutItem.style.backgroundColor = 'transparent';
            logoutItem.onclick = () => {
                menu.remove();
                if (confirm(getText('confirm-logout'))) {
                    logout();
                }
            };
            
            menu.appendChild(logoutItem);
            document.body.appendChild(menu);
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
            function closeMenu(e) {
                if (!menu.contains(e.target) && e.target !== userNameElement) {
                    menu.remove();
                    document.removeEventListener('click', closeMenu);
                }
            }
            
            setTimeout(() => {
                document.addEventListener('click', closeMenu);
            }, 100);
        }
        
        // éªŒè¯ç”¨æˆ·æƒé™
        function hasPermission(requiredRole) {
            if (!currentUser) return false;
            
            // ç®¡ç†å‘˜æ‹¥æœ‰æ‰€æœ‰æƒé™
            if (currentUser.position === 'admin') return true;
            
            // ç»ç†å¯ä»¥æŸ¥çœ‹å’Œç¼–è¾‘æ•°æ®ï¼Œä½†ä¸èƒ½åˆ é™¤æ²™é¾™å’ŒèŒå‘˜
            if (currentUser.position === 'manager') {
                // ç»ç†ä¸èƒ½åˆ é™¤æ²™é¾™ã€ä¸èƒ½åˆ é™¤èŒå‘˜ã€ä¸èƒ½æ‰§è¡Œç®¡ç†å‘˜çº§åˆ«æ“ä½œ
                if (requiredRole === 'delete-salon' || requiredRole === 'delete-employee' || requiredRole === 'admin') {
                    return false;
                }
                return true;
            }
            
            // ä¸šåŠ¡å‘˜åªèƒ½æŸ¥çœ‹å’Œç¼–è¾‘è‡ªå·±çš„æ•°æ®ï¼Œä¸èƒ½åˆ é™¤ä»»ä½•ä¿¡æ¯
            if (currentUser.position === 'salesperson') {
                // ä¸šåŠ¡å‘˜ä¸èƒ½åˆ é™¤ä»»ä½•ä¿¡æ¯
                if (requiredRole.startsWith('delete-')) {
                    return false;
                }
                return requiredRole === 'salesperson';
            }
            
            return false;
        }
        
        // è·å–èŒå‘˜å§“å
        function getEmployeeName(employeeId) {
            if (employeeId === 'unassigned' || employeeId === '' || !employeeId) {
                return getText('unassigned');
            }
            const employees = getEmployees();
            const employee = employees.find(emp => emp.id == employeeId);
            return employee ? employee.name : getText('unassigned');
        }
        
        // æ•°å­—æ ¼å¼åŒ–å‡½æ•°ï¼ˆåƒåˆ†ä½ï¼‰
        function formatCurrency(amount) {
            return new Intl.NumberFormat('ko-KR', {
                style: 'currency',
                currency: 'KRW',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }
        
        // æ•°å­—æ ¼å¼åŒ–å‡½æ•°ï¼ˆçº¯æ•°å­—å¸¦åƒåˆ†ä½ï¼‰
        function formatNumber(number) {
            return new Intl.NumberFormat('ko-KR').format(number);
        }
        
        // æ‰‹æœºå·æ ¼å¼åŒ–å‡½æ•°
        function formatMobile(mobile) {
            if (!mobile) return '';
            // ç§»é™¤æ‰€æœ‰éæ•°å­—å­—ç¬¦
            const cleaned = mobile.replace(/\D/g, '');
            // æŒ‰ç…§000-0000-0000æ ¼å¼åŒ–
            if (cleaned.length >= 11) {
                return `${cleaned.slice(0, 3)}-${cleaned.slice(3, 7)}-${cleaned.slice(7, 11)}`;
            } else if (cleaned.length >= 7) {
                return `${cleaned.slice(0, 3)}-${cleaned.slice(3, 7)}-${cleaned.slice(7)}`;
            } else if (cleaned.length >= 3) {
                return `${cleaned.slice(0, 3)}-${cleaned.slice(3)}`;
            } else {
                return cleaned;
            }
        }
        
        // åˆå§‹åŒ–ç³»ç»Ÿ
        async function initializeSystem() {
            // æ£€æŸ¥æ˜¯å¦æœ‰å‘˜å·¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜
            const employees = await getEmployees();
            if (employees.length === 0) {
                const defaultAdmin = {
                    name: 'ì‹œìŠ¤í…œ ê´€ë¦¬ì',
                    position: 'admin',
                    username: 'admin',
                    password: 'admin',
                    mobile: '010-0000-0000'
                };
                await addEmployee(defaultAdmin);
            }
            
            // æ£€æŸ¥å½“å‰ç™»å½•çŠ¶æ€
            currentUser = getCurrentUser();
            if (currentUser) {
                // å¦‚æœæœ‰ç™»å½•ç”¨æˆ·ï¼Œè®¾ç½®ç•Œé¢çŠ¶æ€
                console.log('í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ì:', currentUser.name, '- ê¶Œí•œ:', currentUser.position);
                // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
                updateUserInfo();
            } else {
                // ä¸´æ—¶è®¾ç½®ä¸ºç®¡ç†å‘˜ç”¨æˆ·ï¼ˆå‘åå…¼å®¹ï¼‰
                const latestEmployees = await getEmployees();
                currentUser = latestEmployees.find(emp => emp.position === 'admin') || latestEmployees[0];
                if (currentUser) {
                    setCurrentUser(currentUser);
                    // updateUserInfoä¼šåœ¨setCurrentUserä¸­è¢«è°ƒç”¨
                }
            }
        }
        
        // æ·»åŠ äº¤æ˜“è®°å½•
        async function addTransaction(salonId, transaction) {
            const salons = await getSalons();
            const salonIndex = salons.findIndex(salon => salon.id === salonId);
            if (salonIndex !== -1) {
                if (!salons[salonIndex].transactions) {
                    salons[salonIndex].transactions = [];
                }
                transaction.id = Date.now();
                transaction.date = new Date();
                // ç¡®ä¿æ•°å­—å­—æ®µæ˜¯æ•°å­—ç±»å‹
                transaction.receivableAmount = parseFloat(transaction.receivableAmount) || 0;
                transaction.receivedAmount = parseFloat(transaction.receivedAmount) || 0;
                transaction.outstandingAmount = transaction.receivableAmount - transaction.receivedAmount;
                // æ·»åŠ å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
                if (currentUser) {
                    transaction.salesperson = currentUser.name;
                    transaction.salespersonId = currentUser.id;
                }
                salons[salonIndex].transactions.push(transaction);
                salons[salonIndex].lastTransactionDate = new Date();
                
                // ç›´æ¥ä¿å­˜åˆ°äº‘ç«¯
                await cloudDataManager.saveSalon(salons[salonIndex]);
                
                // è®°å½•æ“ä½œå†å²
                recordOperation(
                    'create', 
                    'transaction', 
                    transaction.id, 
                    `${salons[salonIndex].name} - äº¤æ˜“è®°å½•`, 
                    `åœ¨æ²™é¾™ ${salons[salonIndex].name} æ·»åŠ æ–°äº¤æ˜“è®°å½•ï¼Œé‡‘é¢ï¼š${transaction.totalAmount || 0}éŸ©å…ƒ`,
                    null,
                    transaction
                );
            }
        }
        
        // ç¡®è®¤åˆ é™¤äº¤æ˜“è®°å½•
        function confirmDeleteTransaction() {
            // æƒé™æ£€æŸ¥ï¼šåªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ é™¤äº¤æ˜“è®°å½•
            if (!hasPermission('admin')) {
                alert(getText('no-permission-delete-transaction'));
                return;
            }
            
            if (confirm(getText('confirm-delete-transaction'))) {
                deleteTransaction(currentViewingSalonId, currentTransactionId);
            }
        }
        
        // åˆ é™¤äº¤æ˜“è®°å½•
        async function deleteTransaction(salonId, transactionId) {
            const salons = await getSalons();
            const salon = salons.find(s => s.id === salonId);
            if (!salon) return false;
            
            // æ‰¾åˆ°å¹¶åˆ é™¤äº¤æ˜“è®°å½•
            const transactionIndex = salon.transactions.findIndex(t => t.id === transactionId);
            if (transactionIndex === -1) return false;
            
            const transactionToDelete = JSON.parse(JSON.stringify(salon.transactions[transactionIndex]));
            salon.transactions.splice(transactionIndex, 1);
            
            // æ›´æ–°æœ€åäº¤æ˜“æ—¥æœŸ
            if (salon.transactions.length > 0) {
                const latestTransaction = salon.transactions.sort((a, b) => new Date(b.date) - new Date(a.date))[0];
                salon.lastTransactionDate = latestTransaction.date;
            } else {
                delete salon.lastTransactionDate; // å¦‚æœæ²¡æœ‰äº¤æ˜“è®°å½•äº†ï¼Œåˆ é™¤æœ€åäº¤æ˜“æ—¥æœŸ
            }
            
            // ç›´æ¥ä¿å­˜åˆ°äº‘ç«¯
            await cloudDataManager.saveSalon(salon);
            
            // è®°å½•æ“ä½œå†å²
            recordOperation(
                'delete', 
                'transaction', 
                transactionId, 
                `${salon.name} - äº¤æ˜“è®°å½•`, 
                `åˆ é™¤æ²™é¾™ ${salon.name} çš„äº¤æ˜“è®°å½•`,
                transactionToDelete,
                null
            );
            
            // åˆ é™¤æˆåŠŸåè¿”å›åˆ°æ²™é¾™ä¿¡æ¯é¡µé¢
            document.getElementById('transaction-detail').classList.remove('active');
            document.getElementById('salon-info').classList.add('active');
            
            // åˆ·æ–°æ²™é¾™åˆ—è¡¨
            displaySalonList();
            
            alert(getText('transaction-deleted-success'));
            return true;
        }
        
        // æ›´æ–°äº¤æ˜“è®°å½•
        function updateTransaction(salonId, updatedTransaction) {
            const salons = getSalons();
            const salonIndex = salons.findIndex(salon => salon.id === salonId);
            
            if (salonIndex !== -1 && salons[salonIndex].transactions) {
                const transactionIndex = salons[salonIndex].transactions.findIndex(t => t.id === updatedTransaction.id);
                if (transactionIndex !== -1) {
                    const beforeData = JSON.parse(JSON.stringify(salons[salonIndex].transactions[transactionIndex]));
                    
                    salons[salonIndex].transactions[transactionIndex] = updatedTransaction;
                    saveSalons(salons);
                    
                    // è®°å½•æ“ä½œå†å²
                    recordOperation(
                        'edit', 
                        'transaction', 
                        updatedTransaction.id, 
                        `${salons[salonIndex].name} - äº¤æ˜“è®°å½•`, 
                        `ç¼–è¾‘æ²™é¾™ ${salons[salonIndex].name} çš„äº¤æ˜“è®°å½•`,
                        beforeData,
                        updatedTransaction
                    );
                    
                    return true;
                }
            }
            return false;
        }
        
        // æ˜¾ç¤ºèŒå‘˜åˆ—è¡¨
        async function displayEmployeeList() {
            const employeeListContainer = document.getElementById('employee-list-content');
            const employees = await getEmployees();
            
            if (employees.length === 0) {
                employeeListContainer.innerHTML = `<div style="text-align: center; color: #cccccc; padding: 40px;"><p>æš‚æ— èŒå‘˜ä¿¡æ¯</p><p style="font-size: 0.9em;">è¯·å‰å¾€"æ–°å¢èŒå‘˜"é¡µé¢æ·»åŠ èŒå‘˜ä¿¡æ¯</p></div>`;
                return;
            }
            
            let html = '';
            employees.forEach((employee, index) => {
                // æƒé™æ£€æŸ¥ï¼šç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰ï¼Œç»ç†ä¸èƒ½çœ‹åˆ°å…¶ä»–ç»ç†å’Œç®¡ç†å‘˜ï¼Œä¸šåŠ¡å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä½†åªèƒ½ç¼–è¾‘è‡ªå·±
                let canView = false;
                let canEdit = false;
                
                if (currentUser.position === 'admin') {
                    canView = true;
                    canEdit = true;
                } else if (currentUser.position === 'manager') {
                    canView = true; // ç»ç†å¯ä»¥çœ‹åˆ°æ‰€æœ‰èŒå‘˜
                    canEdit = employee.position === 'salesperson' || employee.id === currentUser.id;
                } else {
                    // ä¸šåŠ¡å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰èŒå‘˜ä¿¡æ¯ï¼Œä½†åªèƒ½ç¼–è¾‘è‡ªå·±çš„
                    canView = true;
                    canEdit = employee.id === currentUser.id;
                }
                
                if (!canView) return;
                
                // è·å–èŒä½æ˜¾ç¤ºåç§°
                let positionText = getText('salesperson');
                if (employee.position === 'manager') positionText = getText('manager');
                else if (employee.position === 'admin') positionText = getText('admin');
                
                html += `
                    <div style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 5px; margin-bottom: 15px; border: 1px solid rgba(212, 175, 55, 0.3);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="color: var(--gold-light); margin: 0; flex-grow: 1;">${employee.name}</h3>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <span style="background: var(--gold); color: var(--black); padding: 3px 8px; border-radius: 15px; font-size: 0.8em;">${positionText}</span>
                                ${canEdit ? `<button onclick="showEditEmployeeModal(${employee.id})" style="background: var(--gold); color: var(--black); border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 0.8em;">${getText('edit-btn')}</button>` : ''}
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <p><strong>${getText('employee-username').replace('ï¼š', '')}ï¼š</strong> ${employee.username}</p>
                                <p><strong>${getText('employee-mobile').replace('ï¼š', '')}ï¼š</strong> ${formatMobile(employee.mobile)}</p>
                                <p><strong>${getText('create-time')}ï¼š</strong> ${employee.createTime}</p>
                            </div>
                            
                            <div>
                                <p><strong>${getText('permission-level')}ï¼š</strong> 
                                    <span style="color: ${employee.position === 'admin' ? '#ff6666' : employee.position === 'manager' ? '#ffaa00' : '#90EE90'};">
                                        ${positionText}
                                    </span>
                                </p>
                                <p><strong>${getText('status-label')}ï¼š</strong> <span style="color: #90EE90;">${getText('status-normal')}</span></p>
                            </div>
                        </div>
                        
                        <!-- é“¶è¡Œè´¦æˆ·ä¿¡æ¯ -->
                        ${employee.bankInfo && (employee.bankInfo.bankName || employee.bankInfo.accountNumber) ? `
                            <div style="background: rgba(212, 175, 55, 0.2); padding: 15px; border-radius: 5px; margin-top: 15px; border: 1px solid rgba(212, 175, 55, 0.4);">
                                <h4 style="color: var(--gold); margin: 0 0 10px 0;">${getText('bank-account-info')}</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div>
                                        ${employee.bankInfo.bankName ? `<p><strong>${getText('bank-name').replace('ï¼š', '')}ï¼š</strong> ${employee.bankInfo.bankName}</p>` : ''}
                                        ${employee.bankInfo.accountHolder ? `<p><strong>${getText('account-holder').replace('ï¼š', '')}ï¼š</strong> ${employee.bankInfo.accountHolder}</p>` : ''}
                                    </div>
                                    <div>
                                        ${employee.bankInfo.accountNumber ? `<p><strong>${getText('account-number').replace('ï¼š', '')}ï¼š</strong> ${employee.bankInfo.accountNumber}</p>` : ''}
                                        ${employee.bankInfo.bankBranch ? `<p><strong>${getText('bank-branch').replace('ï¼š', '').replace('ï¼ˆé€‰å¡«ï¼‰', '')}ï¼š</strong> ${employee.bankInfo.bankBranch}</p>` : ''}
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            
            employeeListContainer.innerHTML = html;
        }
        
        // ç¡®è®¤åˆ é™¤èŒå‘˜
        function confirmDeleteEmployee(employeeId) {
            const employees = getEmployees();
            const employee = employees.find(e => e.id === employeeId);
            if (employee && confirm(getText('confirm-delete-employee').replace('{name}', employee.name))) {
                deleteEmployee(employeeId);
                displayEmployeeList(); // åˆ·æ–°åˆ—è¡¨
                updateDeleteEmployeeOptions(); // æ›´æ–°åˆ é™¤é¡µé¢çš„é€‰é¡¹
                alert(getText('employee-deleted-success'));
            }
        }
        
        // æ›´æ–°åˆ é™¤èŒå‘˜é¡µé¢çš„é€‰é¡¹
        async function updateDeleteEmployeeOptions() {
            const selectElement = document.getElementById('deleteEmployeeSelect');
            if (!selectElement) return;
            
            const employees = await getEmployees();
            let optionsHtml = `<option value="">${getText('please-select-employee')}</option>`;
            
            employees.forEach(employee => {
                // åªæœ‰ç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°åˆ é™¤é€‰é¡¹ï¼Œä¸”ä¸èƒ½åˆ é™¤è‡ªå·±
                if (currentUser && currentUser.position === 'admin' && employee.id !== currentUser.id) {
                    const positionText = getPositionText(employee.position);
                    optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                }
            });
            
            selectElement.innerHTML = optionsHtml;
        }
        
        // åˆ é™¤é€‰å®šçš„èŒå‘˜
        function deleteSelectedEmployee() {
            const selectElement = document.getElementById('deleteEmployeeSelect');
            const selectedEmployeeId = selectElement.value;
            
            if (!selectedEmployeeId) {
                alert(getText('select-employee-first'));
                return;
            }
            
            const employees = getEmployees();
            const employee = employees.find(e => e.id == selectedEmployeeId);
            
            if (employee && confirm(getText('confirm-delete-employee').replace('{name}', employee.name))) {
                deleteEmployee(parseInt(selectedEmployeeId));
                updateDeleteEmployeeOptions(); // æ›´æ–°ä¸‹æ‹‰åˆ—è¡¨
                alert(getText('employee-deleted-success'));
                
                // å¦‚æœå½“å‰åœ¨èŒå‘˜åˆ—è¡¨é¡µé¢ï¼Œä¹Ÿåˆ·æ–°é‚£ä¸ªé¡µé¢
                const employeeListPage = document.getElementById('employee-list');
                if (employeeListPage && employeeListPage.classList.contains('active')) {
                    displayEmployeeList();
                }
            }
        }
        
        // ==================== æ‰¹é‡ä¸Šä¼ æ²™é¾™åŠŸèƒ½ ====================
        
        // æ‰¹é‡ä¸Šä¼ çš„ä¸´æ—¶æ•°æ®å­˜å‚¨
        let batchSalonData = [];
        
        // æ£€æŸ¥æ‰¹é‡ä¸Šä¼ æƒé™
        function checkBatchUploadPermission() {
            const batchSection = document.getElementById('batch-upload-section');
            if (currentUser && (currentUser.position === 'admin' || currentUser.position === 'manager')) {
                batchSection.style.display = 'block';
            } else {
                batchSection.style.display = 'none';
            }
        }
        
        // æ ¹æ®åœ°å€å…³é”®å­—è‡ªåŠ¨è®¾ç½®åŒºåŸŸ
        function autoDetectDistrict(address) {
            const addressLower = address.toLowerCase();
            if (addressLower.includes('êµ¬ë¡œ')) {
                return 'guro';
            } else if (addressLower.includes('ì˜ë“±í¬')) {
                return 'yeongdeungpo';
            } else if (addressLower.includes('ê¸ˆì²œ')) {
                return 'geumcheon';
            } else {
                return 'overseas'; // é»˜è®¤ä¸ºæµ·å¤–åŒºåŸŸ
            }
        }
        
        // è§£æExcelæ–‡ä»¶å†…å®¹
        function parseExcel(workbook) {
            // æ£€æŸ¥æ˜¯å¦æœ‰å·¥ä½œè¡¨
            if (!workbook.SheetNames || workbook.SheetNames.length === 0) {
                throw new Error('Excelæ–‡ä»¶ä¸­æ²¡æœ‰æ‰¾åˆ°å·¥ä½œè¡¨');
            }
            
            // è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
            const sheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[sheetName];
            
            if (!worksheet) {
                throw new Error(`æ— æ³•è¯»å–å·¥ä½œè¡¨ï¼š${sheetName}`);
            }
            
            // è½¬æ¢ä¸ºJSONæ ¼å¼
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
            
            if (jsonData.length === 0) {
                throw new Error('å·¥ä½œè¡¨ä¸­æ²¡æœ‰æ•°æ®');
            }
            
            if (jsonData.length < 3) {
                throw new Error('å·¥ä½œè¡¨æ•°æ®ä¸è¶³ï¼Œè‡³å°‘éœ€è¦3è¡Œï¼ˆæ ‡é¢˜è¡Œ+åˆ—æ ‡é¢˜è¡Œ+æ•°æ®è¡Œï¼‰');
            }
            
            // ä»ç¬¬äºŒè¡Œå¼€å§‹æŸ¥æ‰¾åˆ—æ ‡é¢˜ï¼ˆç´¢å¼•ä¸º1ï¼‰
            const headers = jsonData[1] || [];
            
            const nameIndex = headers.findIndex(h => {
                if (!h) return false;
                const headerStr = h.toString().toLowerCase();
                return headerStr.includes('ì—…ì†Œëª…') || 
                       headerStr.includes('ì‚¬ì—…ìëª…') || 
                       headerStr.includes('ì—…ì²´ëª…') ||
                       headerStr.includes('ìƒí˜¸ëª…') ||
                       headerStr.includes('ìƒí˜¸') ||
                       headerStr.includes('ë¯¸ìš©ì‹¤') ||
                       headerStr.includes('í—¤ì–´ìƒµ') ||
                       headerStr.includes('ì‚´ë¡±') ||
                       headerStr.includes('ë§¤ì¥ëª…') ||
                       headerStr.includes('ì í¬ëª…') ||
                       headerStr.includes('ë¦¬ìŠ¤íŠ¸') ||
                       (headerStr.includes('ì´ë¦„') && !headerStr.includes('ëŒ€í‘œ')) ||
                       headerStr.includes('name');
            });
            const addressIndex = headers.findIndex(h => {
                if (!h) return false;
                const headerStr = h.toString().toLowerCase();
                return (headerStr.includes('ì˜ì—…ì†Œ') && headerStr.includes('ì£¼ì†Œ')) || 
                       headerStr.includes('ì£¼ì†Œ') ||
                       headerStr.includes('ìœ„ì¹˜') ||
                       headerStr.includes('ì†Œì¬ì§€') ||
                       headerStr.includes('address') ||
                       headerStr.includes('location');
            });
            
            if (nameIndex === -1 || addressIndex === -1) {
                const missingColumns = [];
                const foundColumns = headers.filter(h => h).join('ã€');
                
                if (nameIndex === -1) missingColumns.push('æ²™é¾™åç§°åˆ—ï¼ˆå¦‚ï¼šì—…ì†Œëª…ã€ë¯¸ìš©ì‹¤ã€ìƒí˜¸ëª…ç­‰ï¼‰');
                if (addressIndex === -1) missingColumns.push('åœ°å€åˆ—ï¼ˆå¦‚ï¼šì£¼ì†Œã€ì˜ì—…ì†Œ ì£¼ì†Œã€ìœ„ì¹˜ç­‰ï¼‰');
                
                throw new Error(`Excelæ–‡ä»¶æ ¼å¼ä¸ç¬¦åˆè¦æ±‚ï¼\n\nç¼ºå°‘å¿…éœ€çš„åˆ—ï¼š${missingColumns.join('ã€')}\n\nå½“å‰ç¬¬2è¡Œçš„åˆ—æ ‡é¢˜ï¼š${foundColumns}\n\næœŸæœ›çš„Excelæ ¼å¼ï¼š\nç¬¬1è¡Œï¼šè¡¨æ ¼æ ‡é¢˜\nç¬¬2è¡Œï¼šåˆ—æ ‡é¢˜ï¼ˆå¿…é¡»åŒ…å«æ²™é¾™åç§°å’Œåœ°å€åˆ—ï¼‰\nç¬¬3è¡Œå¼€å§‹ï¼šå®é™…æ•°æ®\n\nå»ºè®®ï¼š\n1. ç‚¹å‡»"ä¸‹è½½æ ·ä¾‹æ¨¡æ¿"è·å–æ ‡å‡†æ ¼å¼\n2. ç¡®ä¿ç¬¬2è¡ŒåŒ…å«æ­£ç¡®çš„åˆ—æ ‡é¢˜\n3. è‡³å°‘éœ€è¦åŒ…å«æ²™é¾™åç§°å’Œåœ°å€ä¸¤åˆ—`);
            }
            
            const salons = [];
            // ä»ç¬¬3è¡Œå¼€å§‹è¯»å–æ•°æ®ï¼ˆç´¢å¼•ä¸º2ï¼‰
            for (let i = 2; i < jsonData.length; i++) {
                const row = jsonData[i];
                if (!row || row.length === 0) continue;
                
                const name = row[nameIndex] ? row[nameIndex].toString().trim() : '';
                const address = row[addressIndex] ? row[addressIndex].toString().trim() : '';
                
                if (name && address) {
                    const district = autoDetectDistrict(address);
                    salons.push({
                        name: name,
                        address: address,
                        district: district,
                        phone: '', // ç•™ç©º
                        directorName: 'æœªæŒ‡å®š', // é»˜è®¤å€¼
                        directorMobile: '', // ç•™ç©º
                        responsibleEmployeeId: '' // ç•™ç©ºï¼Œéœ€è¦åç»­è®¾ç½®
                    });
                }
            }
            
            return salons;
        }
        
        // å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶
        async function processSalonFile() {
            // æ£€æŸ¥SheetJSåº“æ˜¯å¦å·²åŠ è½½
            if (typeof XLSX === 'undefined') {
                alert('Excelå¤„ç†åº“å°šæœªåŠ è½½å®Œæˆï¼Œè¯·ç¨åå†è¯•ï¼');
                return;
            }
            
            const fileInput = document.getElementById('salon-file-upload');
            const file = fileInput.files[0];
            
            if (!file) {
                alert(getText('select-file-first'));
                return;
            }
            
            // æ£€æŸ¥æ–‡ä»¶ç±»å‹
            const fileName = file.name.toLowerCase();
            if (!fileName.endsWith('.xlsx') && !fileName.endsWith('.xls')) {
                alert(getText('unsupported-file-type'));
                return;
            }
            
            const reader = new FileReader();
            reader.onload = async function(e) {
                try {
                    const data = e.target.result;
                    const workbook = XLSX.read(data, { type: 'binary' });
                    
                    batchSalonData = parseExcel(workbook);
                    
                    if (batchSalonData.length === 0) {
                        alert(getText('no-valid-data'));
                        return;
                    }
                    
                    // æ˜¾ç¤ºé¢„è§ˆ
                    await displayBatchPreview();
                    alert(getText('file-processed-success').replace('{count}', batchSalonData.length));
                    
                } catch (error) {
                    alert(getText('file-processing-error').replace('{error}', error.message));
                }
            };
            
            reader.readAsBinaryString(file);
        }
        
        // æ˜¾ç¤ºæ‰¹é‡æ•°æ®é¢„è§ˆ
        async function displayBatchPreview() {
            const previewDiv = document.getElementById('file-preview');
            const tableDiv = document.getElementById('preview-table');
            
            // è·å–èŒå‘˜åˆ—è¡¨ç”¨äºè´Ÿè´£äººé€‰æ‹©
            const employees = await getEmployees();
            let employeeOptions = `<option value="">æœªåˆ†é…</option>`;
            employees.forEach(employee => {
                if (currentUser) {
                    if (currentUser.position === 'admin') {
                        // ç®¡ç†å‘˜å¯ä»¥é€‰æ‹©æ‰€æœ‰äºº
                        const positionText = getPositionText(employee.position);
                        employeeOptions += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                    } else if (currentUser.position === 'manager') {
                        // ç»ç†å¯ä»¥é€‰æ‹©ä¸šåŠ¡å‘˜
                        if (employee.position === 'salesperson') {
                            const positionText = getPositionText(employee.position);
                            employeeOptions += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                        }
                    } else if (currentUser.position === 'salesperson' && employee.id === currentUser.id) {
                        // ä¸šåŠ¡å‘˜åªèƒ½é€‰æ‹©è‡ªå·±
                        const positionText = getPositionText(employee.position);
                        employeeOptions += `<option value="${employee.id}" selected>${employee.name} - ${positionText}</option>`;
                    }
                }
            });

            let tableHTML = `
                <!-- æ‰¹é‡æ“ä½œæ§åˆ¶åŒº -->
                <div style="margin-bottom: 15px; padding: 15px; background: rgba(212, 175, 55, 0.1); border-radius: 5px; border: 1px solid rgba(212, 175, 55, 0.3);">
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <label style="display: flex; align-items: center; gap: 5px; color: var(--gold);">
                            <input type="checkbox" id="batch-select-all" onchange="toggleBatchSelectAll()">
                            å…¨é€‰
                        </label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: var(--text-light);">æ‰¹é‡åˆ†é…è´Ÿè´£äººï¼š</span>
                            <select id="batch-responsible-select" style="padding: 5px; background: var(--dark-gray); color: var(--text-light); border: 1px solid var(--gold); border-radius: 3px;">
                                ${employeeOptions}
                            </select>
                            <button onclick="applyBatchResponsible()" style="background: var(--gold); color: var(--black); border: none; padding: 6px 12px; border-radius: 3px; cursor: pointer; font-size: 0.9em;">
                                åº”ç”¨åˆ°é€‰ä¸­é¡¹
                            </button>
                        </div>
                    </div>
                </div>
                
                <table style="width: 100%; border-collapse: collapse; color: var(--text-light);">
                    <thead>
                        <tr style="background: rgba(212, 175, 55, 0.2);">
                            <th style="border: 1px solid #555; padding: 8px; width: 40px;">é€‰æ‹©</th>
                            <th style="border: 1px solid #555; padding: 8px;">${getText('salon-name').replace('ï¼š', '')}</th>
                            <th style="border: 1px solid #555; padding: 8px;">${getText('salon-address').replace('ï¼š', '')}</th>
                            <th style="border: 1px solid #555; padding: 8px;">${getText('salon-district').replace('ï¼š', '')}</th>
                            <th style="border: 1px solid #555; padding: 8px;">${getText('director-name').replace('ï¼š', '')}</th>
                            <th style="border: 1px solid #555; padding: 8px;">è´Ÿè´£äºº</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            batchSalonData.forEach((salon, index) => {
                const districtText = getText(salon.district + '-district');
                // è®¾ç½®é»˜è®¤è´Ÿè´£äººä¸ºå½“å‰ç”¨æˆ·ï¼ˆå¦‚æœæ˜¯ä¸šåŠ¡å‘˜ï¼‰
                const defaultResponsibleId = (currentUser && currentUser.position === 'salesperson') ? currentUser.id : '';
                
                tableHTML += `
                    <tr>
                        <td style="border: 1px solid #555; padding: 8px; text-align: center;">
                            <input type="checkbox" class="batch-salon-checkbox" data-index="${index}">
                        </td>
                        <td style="border: 1px solid #555; padding: 8px;">${salon.name}</td>
                        <td style="border: 1px solid #555; padding: 8px;">${salon.address}</td>
                        <td style="border: 1px solid #555; padding: 8px;">${districtText}</td>
                        <td style="border: 1px solid #555; padding: 8px;">${salon.directorName}</td>
                        <td style="border: 1px solid #555; padding: 8px;">
                            <select class="salon-responsible-select" data-index="${index}" style="width: 100%; padding: 4px; background: var(--dark-gray); color: var(--text-light); border: 1px solid #666; border-radius: 3px;" onchange="updateSalonResponsible(${index}, this.value)">
                                ${employeeOptions}
                            </select>
                        </td>
                    </tr>
                `;
                
                // è®¾ç½®é»˜è®¤è´Ÿè´£äºº
                if (defaultResponsibleId) {
                    salon.responsibleEmployeeId = defaultResponsibleId;
                }
            });
            
            tableHTML += '</tbody></table>';
            tableDiv.innerHTML = tableHTML;
            
            // è®¾ç½®é»˜è®¤é€‰ä¸­çš„è´Ÿè´£äºº
            if (currentUser && currentUser.position === 'salesperson') {
                batchSalonData.forEach((salon, index) => {
                    const selectElement = document.querySelector(`.salon-responsible-select[data-index="${index}"]`);
                    if (selectElement) {
                        selectElement.value = currentUser.id;
                    }
                });
            }
            
            previewDiv.style.display = 'block';
        }
        
        // æ›´æ–°æ‰¹é‡åˆ›å»ºè¿›åº¦æ¡
        function updateBatchProgress(current, total, status, isComplete = false) {
            const progressContainer = document.getElementById('batch-progress-container');
            const progressText = document.getElementById('batch-progress-text');
            const progressCount = document.getElementById('batch-progress-count');
            const progressBar = document.getElementById('batch-progress-bar');
            const progressPercent = document.getElementById('batch-progress-percent');
            const progressStatus = document.getElementById('batch-progress-status');
            
            if (!progressContainer) return;
            
            const percentage = Math.round((current / total) * 100);
            
            progressContainer.style.display = 'block';
            progressCount.textContent = `${current}/${total}`;
            progressBar.style.width = `${percentage}%`;
            progressPercent.textContent = `${percentage}%`;
            progressStatus.textContent = status;
            
            if (isComplete) {
                progressText.textContent = 'æ‰¹é‡åˆ›å»ºå®Œæˆï¼';
                progressBar.style.background = current === total 
                    ? 'linear-gradient(90deg, #4CAF50, #8BC34A)' 
                    : 'linear-gradient(90deg, #FF9800, #FFC107)';
            } else {
                progressText.textContent = 'æ­£åœ¨åˆ›å»ºæ²™é¾™...';
            }
        }
        
        // ç¡®è®¤æ‰¹é‡åˆ›å»º
        async function confirmBatchCreate() {
            console.log('confirmBatchCreate å‡½æ•°è¢«è°ƒç”¨');
            console.log('batchSalonData:', batchSalonData);
            console.log('batchSalonData.length:', batchSalonData ? batchSalonData.length : 'undefined');
            
            try {
                if (!batchSalonData || batchSalonData.length === 0) {
                    console.log('æ²¡æœ‰æœ‰æ•ˆæ•°æ®ï¼Œæ˜¾ç¤ºæç¤º');
                    alert('æ²¡æœ‰æœ‰æ•ˆçš„æ•°æ®å¯ä»¥åˆ›å»ºï¼Œè¯·å…ˆä¸Šä¼ æ–‡ä»¶ï¼');
                    return;
                }
                
                console.log('å¼€å§‹æ‰¹é‡åˆ›å»ºï¼Œæ•°æ®é‡:', batchSalonData.length);
                
                // å¦‚æœæ•°æ®é‡å¤ªå¤§ï¼Œæé†’ç”¨æˆ·
                if (batchSalonData.length > 100) {
                    const confirm = window.confirm(`æ‚¨å‡†å¤‡åˆ›å»º ${batchSalonData.length} ä¸ªæ²™é¾™ï¼Œæ•°æ®é‡è¾ƒå¤§å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ã€‚\n\nå»ºè®®ï¼š\n1. å°‘äº100ä¸ªä¸ºä½³\n2. ç¡®ä¿ç½‘ç»œç¨³å®š\n3. è¯·è€å¿ƒç­‰å¾…\n\næ˜¯å¦ç»§ç»­ï¼Ÿ`);
                    if (!confirm) {
                        return;
                    }
                }
                
                // ç¦ç”¨åˆ›å»ºæŒ‰é’®ï¼Œé˜²æ­¢é‡å¤ç‚¹å‡»
                const confirmBtn = document.getElementById('confirm-batch-btn');
                if (confirmBtn) {
                    confirmBtn.disabled = true;
                    confirmBtn.textContent = 'åˆ›å»ºä¸­...';
                    confirmBtn.style.opacity = '0.6';
                    confirmBtn.style.cursor = 'not-allowed';
                }
                
                // è·å–å½“å‰ç”¨æˆ·ä½œä¸ºé»˜è®¤è´Ÿè´£äººï¼ˆå¦‚æœæ²¡æœ‰è®¾ç½®çš„è¯ï¼‰
                const defaultEmployeeId = currentUser ? currentUser.id : '';
                console.log('é»˜è®¤è´Ÿè´£äººID:', defaultEmployeeId);
                
                let successCount = 0;
                const batchSize = 5; // å‡å°‘æ¯æ‰¹æ•°é‡ï¼Œæé«˜å“åº”æ€§
                
                // åˆå§‹åŒ–è¿›åº¦æ¡
                updateBatchProgress(0, batchSalonData.length, 'å‡†å¤‡å¼€å§‹...');
                
                console.log('ğŸš€ å¼€å§‹æ‰¹é‡åˆ›å»ºæ²™é¾™...');
                
                for (let i = 0; i < batchSalonData.length; i++) {
                    const salonData = batchSalonData[i];
                    
                    // æ›´æ–°è¿›åº¦æ¡
                    updateBatchProgress(i, batchSalonData.length, `æ­£åœ¨å¤„ç†: ${salonData.name}`);
                    
                    // æ¯å¤„ç†Nä¸ªæš‚åœä¸€ä¸‹ï¼Œé¿å…è¿‡å¿«è¯·æ±‚
                    if (i > 0 && i % batchSize === 0) {
                        const progress = Math.round((i / batchSalonData.length) * 100);
                        console.log(`ğŸ”„ è¿›åº¦: ${progress}% (${i}/${batchSalonData.length}) - æš‚åœ 50ms...`);
                        await new Promise(resolve => setTimeout(resolve, 50));
                    }
                    
                    console.log(`ğŸ“ å¤„ç†ç¬¬${i+1}/${batchSalonData.length}ä¸ªæ²™é¾™: ${salonData.name}`);
                    
                    // è®¾ç½®é»˜è®¤è´Ÿè´£äººï¼ˆå¦‚æœæ²¡æœ‰è®¾ç½®ï¼‰
                    if (!salonData.responsibleEmployeeId) {
                        salonData.responsibleEmployeeId = defaultEmployeeId;
                    }
                    
                    // åˆ›å»ºæ²™é¾™
                    try {
                        const result = await addSalon(salonData);
                        if (result) {
                            successCount++;
                            console.log(`âœ… ç¬¬${i+1}ä¸ªæ²™é¾™åˆ›å»ºæˆåŠŸ: ${salonData.name}`);
                        } else {
                            console.log(`âŒ ç¬¬${i+1}ä¸ªæ²™é¾™åˆ›å»ºå¤±è´¥: ${salonData.name}`);
                        }
                    } catch (error) {
                        console.error(`âŒ ç¬¬${i+1}ä¸ªæ²™é¾™äº‘ç«¯åˆ›å»ºå¤±è´¥: ${salonData.name}`, error);
                        // Firebaseå¤±è´¥æ—¶ï¼Œå°è¯•æœ¬åœ°å­˜å‚¨
                        try {
                            const localResult = addSalonToLocalStorage(salonData);
                            if (localResult) {
                                successCount++;
                                console.log(`ğŸ’¾ ç¬¬${i+1}ä¸ªæ²™é¾™å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨: ${salonData.name}`);
                            }
                        } catch (localError) {
                            console.error(`ğŸ’¥ ç¬¬${i+1}ä¸ªæ²™é¾™æœ¬åœ°å­˜å‚¨ä¹Ÿå¤±è´¥: ${salonData.name}`, localError);
                        }
                    }
                }
                
                // æœ€ç»ˆè¿›åº¦æ¡æ›´æ–°
                const finalStatus = successCount === batchSalonData.length 
                    ? `âœ… å…¨éƒ¨å®Œæˆï¼æˆåŠŸåˆ›å»º ${successCount} ä¸ªæ²™é¾™`
                    : `âš ï¸ éƒ¨åˆ†æˆåŠŸï¼š${successCount}/${batchSalonData.length} ä¸ªæ²™é¾™åˆ›å»ºæˆåŠŸ`;
                
                updateBatchProgress(batchSalonData.length, batchSalonData.length, finalStatus, true);
                
                console.log('ğŸ‰ æ‰¹é‡åˆ›å»ºå®Œæˆï¼');
                console.log(`ğŸ“Š æ€»æ•°æ®: ${batchSalonData.length} ä¸ª`);
                console.log(`âœ… æˆåŠŸ: ${successCount} ä¸ª`);
                console.log(`âŒ å¤±è´¥: ${batchSalonData.length - successCount} ä¸ª`);
                
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                if (confirmBtn) {
                    confirmBtn.disabled = false;
                    confirmBtn.textContent = 'ç¡®è®¤æ‰¹é‡åˆ›å»º';
                    confirmBtn.style.opacity = '1';
                    confirmBtn.style.cursor = 'pointer';
                }
                
                if (successCount > 0) {
                    const message = successCount === batchSalonData.length 
                        ? `ğŸ‰ æ‰¹é‡åˆ›å»ºå®Œæˆï¼å…¨éƒ¨ ${successCount} ä¸ªæ²™é¾™åˆ›å»ºæˆåŠŸï¼`
                        : `âš ï¸ æ‰¹é‡åˆ›å»ºå®Œæˆï¼æˆåŠŸåˆ›å»º ${successCount}/${batchSalonData.length} ä¸ªæ²™é¾™ã€‚\n\næ³¨æ„ï¼šå¦‚æœFirebaseè¿æ¥å¤±è´¥ï¼Œæ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨ã€‚`;
                    
                    alert(message);
                    
                    // 3ç§’åè‡ªåŠ¨æ¸…ç†ç•Œé¢å¹¶è·³è½¬
                    setTimeout(async () => {
                        // æ¸…ç†æ•°æ®å’Œç•Œé¢
                        cancelBatchUpload();
                        
                        // è·³è½¬åˆ°æ²™é¾™åˆ—è¡¨é¡µé¢
                        await showContent('salon-info');
                    }, 3000);
                } else {
                    alert('âŒ æ‰¹é‡åˆ›å»ºå¤±è´¥ï¼æ²¡æœ‰æˆåŠŸåˆ›å»ºä»»ä½•æ²™é¾™ã€‚\n\nå¯èƒ½åŸå› ï¼š\n1. ç½‘ç»œè¿æ¥é—®é¢˜\n2. Firebaseé…é¢è¶…å‡º\n3. æ•°æ®æ ¼å¼é”™è¯¯\n\nè¯·æ£€æŸ¥æ§åˆ¶å°ä¿¡æ¯æˆ–ç¨åé‡è¯•ã€‚');
                }
                
            } catch (error) {
                console.error('confirmBatchCreate æ‰§è¡Œå‡ºé”™:', error);
                alert('æ‰¹é‡åˆ›å»ºæ—¶å‘ç”Ÿé”™è¯¯: ' + error.message);
            }
        }
        
        // å–æ¶ˆæ‰¹é‡ä¸Šä¼ 
        function cancelBatchUpload() {
            batchSalonData = [];
            document.getElementById('file-preview').style.display = 'none';
            document.getElementById('salon-file-upload').value = '';
            
            // éšè—è¿›åº¦æ¡
            const progressContainer = document.getElementById('batch-progress-container');
            if (progressContainer) {
                progressContainer.style.display = 'none';
            }
            
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            const confirmBtn = document.getElementById('confirm-batch-btn');
            if (confirmBtn) {
                confirmBtn.disabled = false;
                confirmBtn.textContent = 'ç¡®è®¤æ‰¹é‡åˆ›å»º';
                confirmBtn.style.opacity = '1';
                confirmBtn.style.cursor = 'pointer';
            }
        }
        
        // æœ¬åœ°å­˜å‚¨å¤‡ç”¨å‡½æ•°
        function addSalonToLocalStorage(salonData) {
            try {
                const salons = JSON.parse(localStorage.getItem('salons')) || [];
                const newSalon = {
                    id: Date.now() + Math.random(),
                    name: salonData.name,
                    address: salonData.address,
                    businessLicense: salonData.businessLicense || '',
                    district: salonData.district || '',
                    phone: salonData.phone || '',
                    directorName: salonData.directorName || 'æœªæŒ‡å®š',
                    directorMobile: salonData.directorMobile || '',
                    responsibleEmployeeId: salonData.responsibleEmployeeId || '',
                    addTime: new Date().toLocaleString('zh-CN'),
                    joinDate: new Date().toISOString(),
                    transactions: [],
                    lastTransactionDate: null
                };
                
                salons.push(newSalon);
                localStorage.setItem('salons', JSON.stringify(salons));
                return true;
            } catch (error) {
                console.error('æœ¬åœ°å­˜å‚¨å¤±è´¥:', error);
                return false;
            }
        }
        
        // åˆ‡æ¢å…¨é€‰çŠ¶æ€
        function toggleBatchSelectAll() {
            const selectAllCheckbox = document.getElementById('batch-select-all');
            const salonCheckboxes = document.querySelectorAll('.batch-salon-checkbox');
            
            salonCheckboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
        }
        
        // æ‰¹é‡åº”ç”¨è´Ÿè´£äºº
        function applyBatchResponsible() {
            const selectedResponsibleId = document.getElementById('batch-responsible-select').value;
            const checkedCheckboxes = document.querySelectorAll('.batch-salon-checkbox:checked');
            
            if (checkedCheckboxes.length === 0) {
                alert('è¯·å…ˆé€‰æ‹©è¦åˆ†é…è´Ÿè´£äººçš„æ²™é¾™');
                return;
            }
            
            if (!selectedResponsibleId) {
                alert('è¯·é€‰æ‹©è¦åˆ†é…çš„è´Ÿè´£äºº');
                return;
            }
            
            checkedCheckboxes.forEach(checkbox => {
                const index = parseInt(checkbox.dataset.index);
                const selectElement = document.querySelector(`.salon-responsible-select[data-index="${index}"]`);
                
                if (selectElement) {
                    selectElement.value = selectedResponsibleId;
                    // æ›´æ–°æ•°æ®
                    updateSalonResponsible(index, selectedResponsibleId);
                }
            });
            
            alert(`å·²ä¸º ${checkedCheckboxes.length} ä¸ªæ²™é¾™åˆ†é…è´Ÿè´£äºº`);
        }
        
        // æ›´æ–°å•ä¸ªæ²™é¾™çš„è´Ÿè´£äºº
        function updateSalonResponsible(index, responsibleId) {
            if (batchSalonData[index]) {
                batchSalonData[index].responsibleEmployeeId = responsibleId;
            }
        }
        
        // ä¸‹è½½æ ·ä¾‹æ¨¡æ¿æ–‡ä»¶
        function downloadSampleFile() {
            // æ£€æŸ¥SheetJSåº“æ˜¯å¦å·²åŠ è½½
            if (typeof XLSX === 'undefined') {
                alert('Excelå¤„ç†åº“å°šæœªåŠ è½½å®Œæˆï¼Œè¯·ç¨åå†è¯•ï¼');
                return;
            }
            
            const sampleData = [
                ['ì‚´ë¡± ì •ë³´ ì¼ê´„ ì—…ë¡œë“œ í…œí”Œë¦¿', '', '', ''],  // ç¬¬1í–‰ï¼šè¡¨æ ¼æ ‡é¢˜
                ['ì—…ì†Œëª…', 'ì˜ì—…ì†Œ ì£¼ì†Œ', 'ì „í™”ë²ˆí˜¸', 'ëŒ€í‘œìëª…'],    // ç¬¬2í–‰ï¼šåˆ—æ ‡é¢˜
                ['ë¯¸ìš©ì‹¤ A', 'ì„œìš¸ êµ¬ë¡œêµ¬ êµ¬ë¡œì¤‘ì•™ë¡œ 12', '02-1234-5678', 'ê¹€ëŒ€í‘œ'],
                ['í—¤ì–´ìƒµ B', 'ì„œìš¸ ì˜ë“±í¬êµ¬ ì˜ë“±í¬ë¡œ 34', '02-2345-6789', 'ì´ì‚¬ì¥'],
                ['ë·°í‹°ìƒµ C', 'ì„œìš¸ ê¸ˆì²œêµ¬ ê¸ˆì²œë¡œ 56', '02-3456-7890', 'ë°•ì›ì¥'],
                ['ì‚´ë¡± D', 'ë¶€ì‚° í•´ìš´ëŒ€êµ¬ í•´ìš´ëŒ€ë¡œ 78', '051-4567-8901', 'ìµœì›ì¥']
            ];
            
            // åˆ›å»ºæ–°çš„å·¥ä½œç°¿
            const workbook = XLSX.utils.book_new();
            
            // åˆ›å»ºå·¥ä½œè¡¨
            const worksheet = XLSX.utils.aoa_to_sheet(sampleData);
            
            // è®¾ç½®åˆ—å®½
            worksheet['!cols'] = [
                { width: 25 }, // ì—…ì†Œëª…/æ ‡é¢˜
                { width: 35 }, // ì˜ì—…ì†Œ ì£¼ì†Œ
                { width: 15 }, // ì „í™”ë²ˆí˜¸
                { width: 15 }  // ëŒ€í‘œìëª…
            ];
            
            // åˆå¹¶ç¬¬ä¸€è¡Œçš„å•å…ƒæ ¼ä½œä¸ºæ ‡é¢˜
            worksheet['!merges'] = [
                { s: { r: 0, c: 0 }, e: { r: 0, c: 3 } }  // åˆå¹¶ç¬¬1è¡Œçš„A1åˆ°D1å•å…ƒæ ¼
            ];
            
            // æ·»åŠ å·¥ì‘è¡¨åˆ°å·¥ä½œç°¿
            XLSX.utils.book_append_sheet(workbook, worksheet, 'æ²™é¾™ä¿¡æ¯');
            
            // ä¸‹è½½Excelæ–‡ä»¶
            XLSX.writeFile(workbook, 'salon_template_sample.xlsx');
        }
        
        // æ›´æ–°ä¸šåŠ¡å‘˜é€‰æ‹©ä¸‹æ‹‰æ¡†
        async function updateSalespersonOptions() {
            const selectElement = document.getElementById('salespersonSelect');
            if (!selectElement) return;
            
            const employees = await getEmployees();
            let optionsHtml = `<option value="">${getText('please-select-salesperson')}</option>`;
            
            employees.forEach(employee => {
                // æ ¹æ®æƒé™è¿‡æ»¤å¯è§çš„ä¸šåŠ¡å‘˜
                if (currentUser) {
                    if (currentUser.position === 'admin' || currentUser.position === 'manager') {
                        // ç®¡ç†å‘˜å’Œç»ç†å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä¸šåŠ¡å‘˜
                        const positionText = getPositionText(employee.position);
                        optionsHtml += `<option value="${employee.id}" ${currentUser.id === employee.id ? 'selected' : ''}>${employee.name} - ${positionText}</option>`;
                    } else if (currentUser.position === 'salesperson' && currentUser.id === employee.id) {
                        // ä¸šåŠ¡å‘˜åªèƒ½é€‰æ‹©è‡ªå·±
                        optionsHtml += `<option value="${employee.id}" selected>${employee.name}</option>`;
                    }
                } else {
                    // å¦‚æœæ²¡æœ‰ç™»å½•ç”¨æˆ·ï¼ˆå‘åå…¼å®¹ï¼‰ï¼Œæ˜¾ç¤ºæ‰€æœ‰
                    const positionText = getPositionText(employee.position);
                    optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                }
            });
            
            selectElement.innerHTML = optionsHtml;
        }
        
        // è·å–ä¸šåŠ¡å‘˜æ‰‹æœºå·
        function getSalespersonMobile(salespersonId) {
            if (!salespersonId) return '';
            const employees = getEmployees();
            const employee = employees.find(emp => emp.id == salespersonId);
            return employee ? employee.mobile : '';
        }
        
        // æ˜¾ç¤ºç¼–è¾‘èŒå‘˜æ¨¡æ€æ¡†
        async function showEditEmployeeModal(employeeId) {
            const employees = await getEmployees();
            const employee = employees.find(emp => emp.id === employeeId);
            
            if (!employee) return;
            
            // å¡«å……è¡¨å•æ•°æ®
            document.getElementById('editEmployeeId').value = employee.id;
            document.getElementById('editEmployeeName').value = employee.name;
            document.getElementById('editEmployeePosition').value = employee.position;
            document.getElementById('editEmployeeUsername').value = employee.username;
            document.getElementById('editEmployeePassword').value = ''; // å¯†ç å­—æ®µç•™ç©º
            document.getElementById('editEmployeeMobile').value = employee.mobile;
            
            // å¡«å……é“¶è¡Œè´¦æˆ·ä¿¡æ¯
            const bankInfo = employee.bankInfo || {};
            document.getElementById('editEmployeeBankName').value = bankInfo.bankName || '';
            document.getElementById('editEmployeeAccountNumber').value = bankInfo.accountNumber || '';
            document.getElementById('editEmployeeAccountHolder').value = bankInfo.accountHolder || '';
            document.getElementById('editEmployeeBankBranch').value = bankInfo.bankBranch || '';
            
            // æƒé™æ§åˆ¶ï¼šç»ç†ä¸èƒ½ä¿®æ”¹ç®¡ç†å‘˜æƒé™ï¼Œä¸šåŠ¡å‘˜ä¸èƒ½ä¿®æ”¹è‡ªå·±çš„æƒé™ï¼Œç®¡ç†å‘˜ä¸èƒ½è°ƒä½è‡ªå·±çš„æƒé™
            const positionSelect = document.getElementById('editEmployeePosition');
            if (currentUser.position === 'manager' && employee.position === 'admin') {
                positionSelect.disabled = true;
            } else if (currentUser.position === 'manager') {
                // ç»ç†åªèƒ½è®¾ç½®ä¸šåŠ¡å‘˜èŒä½
                positionSelect.innerHTML = `
                    <option value="salesperson" data-i18n="salesperson">ä¸šåŠ¡å‘˜</option>
                `;
                updateTexts(); // æ›´æ–°ç¿»è¯‘
            } else if (currentUser.position === 'salesperson' && employee.id === currentUser.id) {
                // ä¸šåŠ¡å‘˜ä¸èƒ½ä¿®æ”¹è‡ªå·±çš„æƒé™ç­‰çº§
                positionSelect.disabled = true;
            } else if (currentUser.position === 'admin' && employee.id === currentUser.id) {
                // ç®¡ç†å‘˜ä¸èƒ½è°ƒä½è‡ªå·±çš„æƒé™ï¼Œåªèƒ½ä¿æŒç®¡ç†å‘˜
                positionSelect.innerHTML = `
                    <option value="admin" data-i18n="admin" selected>ç®¡ç†å‘˜</option>
                `;
                positionSelect.disabled = true;
                updateTexts(); // æ›´æ–°ç¿»è¯‘
            } else {
                positionSelect.disabled = false;
                positionSelect.innerHTML = `
                    <option value="salesperson" data-i18n="salesperson">ä¸šåŠ¡å‘˜</option>
                    <option value="manager" data-i18n="manager">ç»ç†</option>
                    <option value="admin" data-i18n="admin">ç®¡ç†å‘˜</option>
                `;
                updateTexts(); // æ›´æ–°ç¿»è¯‘
            }
            
            // æ·»åŠ å§“åè‡ªåŠ¨å¡«å……åˆ°è´¦æˆ·æŒæœ‰äººçš„åŠŸèƒ½
            const editNameField = document.getElementById('editEmployeeName');
            const editAccountHolderField = document.getElementById('editEmployeeAccountHolder');
            
            // ç§»é™¤ä¹‹å‰çš„äº‹ä»¶ç›‘å¬å™¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            editNameField.removeEventListener('input', editNameAutoFill);
            
            // æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨
            function editNameAutoFill() {
                if (!editAccountHolderField.value.trim() || editAccountHolderField.value === employee.name) {
                    editAccountHolderField.value = editNameField.value.trim();
                }
            }
            editNameField.addEventListener('input', editNameAutoFill);
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = document.getElementById('editEmployeeModal');
            modal.style.display = 'flex';
        }
        
        // å…³é—­ç¼–è¾‘èŒå‘˜æ¨¡æ€æ¡†
        function closeEditEmployeeModal() {
            const modal = document.getElementById('editEmployeeModal');
            modal.style.display = 'none';
            document.getElementById('editEmployeeForm').reset();
        }
        
        // æœç´¢æ²™é¾™åŠŸèƒ½
        let originalSalonList = [];
        function searchSalons() {
            const searchTerm = document.getElementById('salon-search').value.toLowerCase().trim();
            
            if (searchTerm === '') {
                // å¦‚æœæœç´¢æ¡†ä¸ºç©ºï¼Œä½†æœ‰å…¶ä»–ç­›é€‰æ¡ä»¶ï¼Œåº”ç”¨ç­›é€‰
                const selectedResponsible = document.getElementById('responsible-filter').value;
                const selectedDistrict = document.getElementById('district-filter').value;
                
                if (selectedResponsible || selectedDistrict) {
                    filterSalons();
                } else {
                displaySalonList();
                }
                return;
            }
            
            // æœ‰æœç´¢å†…å®¹æ—¶ï¼Œä½¿ç”¨ç»Ÿä¸€ç­›é€‰é€»è¾‘
            filterSalons();
        }
        
        // æ˜¾ç¤ºç­›é€‰åçš„æ²™é¾™åˆ—è¡¨
        function displayFilteredSalonList(salons) {
            const salonListContainer = document.getElementById('salon-list');
            
            // æ ¹æ®æƒé™è¿›ä¸€æ­¥ç­›é€‰
            if (currentUser && currentUser.position === 'salesperson') {
                salons = salons.filter(salon => canSalespersonViewSalon(salon, currentUser.id));
            }
            
            if (salons.length === 0) {
                salonListContainer.innerHTML = `<div style="text-align: center; color: #cccccc; padding: 40px;"><p>${getText('no-matching-salons')}</p></div>`;
                return;
            }
            
            let html = '';
            salons.forEach((salon, index) => {
                const overdueDays = calculateOverdueDays(salon);
                const overdueColor = overdueDays > 30 ? '#ff6666' : overdueDays > 7 ? '#ffaa00' : '#90EE90';
                const transactionHistory = formatTransactionHistory(salon.transactions, salon.id);
                
                // çŠ¶æ€æ˜¾ç¤º
                let statusText = '';
                if (overdueDays > 30) {
                    statusText = `<span style="color: #ff6666;">ï¼ˆ${getText('long-inactive')}ï¼‰</span>`;
                } else if (overdueDays > 7) {
                    statusText = `<span style="color: #ffaa00;">ï¼ˆ${getText('needs-attention')}ï¼‰</span>`;
                } else {
                    statusText = `<span style="color: #90EE90;">ï¼ˆ${getText('active-customer')}ï¼‰</span>`;
                }
                
                html += `
                    <div style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 5px; margin-bottom: 15px; border: 1px solid rgba(212, 175, 55, 0.3);">
                        <!-- æŠ˜å å¤´éƒ¨ï¼šæ²™é¾™åç§°å’Œåœ°å€ -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div style="flex-grow: 1; display: flex; align-items: center; gap: 10px;">
                                <button id="salon-toggle-${salon.id}" onclick="toggleSalonCollapse(${salon.id})" style="background: none; border: none; color: var(--gold); font-size: 1.2em; cursor: pointer; padding: 0; width: 20px; text-align: center;" title="å±•å¼€">â–¶</button>
                                <div>
                                    <h3 style="color: var(--gold-light); margin: 0;">${salon.name}</h3>
                                    <p style="margin: 2px 0 0 0; color: #cccccc; font-size: 0.9em;">${salon.address}</p>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <button onclick="showEditSalonModal(${salon.id})" style="background: #4CAF50; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 0.8em;">${getText('edit-btn')}</button>
                                <button onclick="showAddTransactionModal(${salon.id})" style="background: var(--gold); color: var(--black); border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 0.8em;">${getText('add-transaction-btn')}</button>
                            </div>
                        </div>
                        
                        <!-- å¯æŠ˜å çš„è¯¦ç»†ä¿¡æ¯ -->
                        <div id="salon-details-${salon.id}" style="display: none;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div>
                                    ${salon.phone ? `<p><strong>${getText('salon-phone-label')}ï¼š</strong> ${salon.phone}</p>` : ''}
                                    <p><strong>${getText('director-name-label')}ï¼š</strong> ${salon.directorName}</p>
                                    <p><strong>${getText('director-mobile-label')}ï¼š</strong> ${formatMobile(salon.directorMobile)}</p>
                                    <p><strong>${getText('first-join-label')}ï¼š</strong> ${salon.addTime}</p>
                                    <p style="color: var(--gold-light);"><strong>${getText('status-label')}ï¼š</strong> ${getText('status-active')}</p>
                                </div>
                                
                                <div>
                                    <p><strong>${getText('days-since-last-label')}ï¼š</strong> <span style="color: ${overdueColor}; font-weight: bold;">${overdueDays} ${getText('days-unit')}</span> 
                                        ${statusText}
                                    </p>
                                    <p><strong>${getText('transaction-count-label')}ï¼š</strong> ${salon.transactions ? salon.transactions.length : 0} ${getText('transaction-unit')}</p>
                                    ${salon.lastTransactionDate ? `<p><strong>${getText('last-transaction-label')}ï¼š</strong> ${new Date(salon.lastTransactionDate).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN')}</p>` : `<p><strong>${getText('last-transaction-label')}ï¼š</strong> <span style="color: #cccccc;">${getText('no-transaction')}</span></p>`}
                                    
                                    <div style="margin-top: 15px;">
                                        <strong>${getText('recent-transactions-label')}ï¼š</strong>
                                        ${transactionHistory}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            salonListContainer.innerHTML = html;
        }
        
        // æ¸…ç©ºæœç´¢
        function clearSearch() {
            document.getElementById('salon-search').value = '';
            document.getElementById('district-filter').value = '';
            document.getElementById('responsible-filter').value = '';
            displaySalonList();
        }
        
        // æ²™é¾™ç»¼åˆç­›é€‰å‡½æ•°
        function filterSalons() {
            const selectedResponsible = document.getElementById('responsible-filter').value;
            const selectedDistrict = document.getElementById('district-filter').value;
            const searchTerm = document.getElementById('salon-search').value.toLowerCase().trim();
            let salons = getSalons();
            
            // ä¸šåŠ¡å‘˜æƒé™ç­›é€‰
            if (currentUser && currentUser.position === 'salesperson') {
                salons = salons.filter(salon => canSalespersonViewSalon(salon, currentUser.id));
            }
            
            let filteredSalons = salons;
            
            // æŒ‰è´Ÿè´£äººå‘˜ç­›é€‰
            if (selectedResponsible) {
                filteredSalons = filteredSalons.filter(salon => 
                    salon.responsibleEmployeeId && salon.responsibleEmployeeId.toString() === selectedResponsible
                );
            }
            
            // æŒ‰åŒºåŸŸç­›é€‰
            if (selectedDistrict) {
                filteredSalons = filteredSalons.filter(salon => salon.district === selectedDistrict);
            }
            
            // æŒ‰æœç´¢è¯ç­›é€‰
            if (searchTerm) {
                filteredSalons = filteredSalons.filter(salon => {
                    return salon.name.toLowerCase().includes(searchTerm) ||
                           salon.directorName.toLowerCase().includes(searchTerm) ||
                           salon.directorMobile.includes(searchTerm);
                });
            }
            
            displayFilteredSalonList(filteredSalons);
        }
        
        // å‘åå…¼å®¹ï¼šä¿ç•™åŸæœ‰å‡½æ•°å
        function filterByDistrict() {
            filterSalons();
        }
        
        // è®¡ç®—æ¬ æ¬¾å¤©æ•°
        function calculateOverdueDays(salon) {
            // ç¡®ä¿å…¼å®¹æ€§ï¼Œåˆå§‹åŒ–ç¼ºå¤±çš„å­—æ®µ
            if (!salon.transactions) {
                salon.transactions = [];
            }
            
            if (!salon.lastTransactionDate || salon.transactions.length === 0) {
                // å¦‚æœæ²¡æœ‰äº¤æ˜“è®°å½•ï¼Œä»åŠ å…¥æ—¶é—´å¼€å§‹è®¡ç®—
                const joinDate = salon.joinDate ? new Date(salon.joinDate) : new Date(salon.addTime);
                const today = new Date();
                const diffTime = today - joinDate;
                return Math.floor(diffTime / (1000 * 60 * 60 * 24));
            } else {
                const lastTransaction = new Date(salon.lastTransactionDate);
                const today = new Date();
                const diffTime = today - lastTransaction;
                return Math.floor(diffTime / (1000 * 60 * 60 * 24));
            }
        }
        
        // æ ¼å¼åŒ–äº¤æ˜“è®°å½•æ˜¾ç¤º
        function formatTransactionHistory(transactions, salonId) {
            if (!transactions || transactions.length === 0) {
                return `<span style="color: #cccccc;">${getText('no-transactions')}</span>`;
            }
            
            let html = '<div style="margin-top: 10px;">';
            // æŒ‰æ—¶é—´å€’åºæ’åˆ—ï¼Œåªæ˜¾ç¤ºæœ€æ–°çš„1æ¡
            const sortedTransactions = transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
            const recentTransactions = sortedTransactions.slice(0, 1);
            
            recentTransactions.forEach(transaction => {
                const date = new Date(transaction.date).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
                const totalAmount = transaction.totalAmount || 0;
                const receivedAmount = transaction.receivedAmount || 0;
                const outstandingAmount = transaction.outstandingAmount || (totalAmount - receivedAmount);
                
                // è·å–ä¸šåŠ¡å‘˜åç§°
                const salespersonName = transaction.salesperson || getText('unassigned');
                
                html += `
                    <div onclick="event.stopPropagation(); viewTransactionDetail(${salonId}, ${transaction.id});" style="background: rgba(0,0,0,0.2); padding: 8px; margin: 5px 0; border-radius: 3px; font-size: 0.9em; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(212, 175, 55, 0.2)'" onmouseout="this.style.background='rgba(0,0,0,0.2)'">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span style="color: var(--gold-light);">${date}</span><br>
                                <span style="color: white;">${transaction.description || ''}</span><br>
                                <span style="color: #cccccc; font-size: 0.8em;">${getText('salesperson-label')}ï¼š${salespersonName}</span>
                            </div>
                            <div style="text-align: right;">
                                ${totalAmount > 0 ? `<div><span style="color: #90EE90;">${getText('total-products-amount').replace('ï¼š', '')} ${formatCurrency(totalAmount)}</span></div>` : ''}
                                ${receivedAmount > 0 ? `<div><span style="color: #87CEEB;">${getText('received-amount').replace('ï¼š', '')} ${formatCurrency(receivedAmount)}</span></div>` : ''}
                                ${outstandingAmount > 0 ? `<div><span style="color: #ff6666;">${getText('current-outstanding').replace('ï¼š', '')} ${formatCurrency(outstandingAmount)}</span></div>` : ''}
                            </div>
                        </div>
                        <div style="font-size: 0.8em; color: #cccccc; margin-top: 5px;">${getText('click-to-view-detail')}</div>
                    </div>
                `;
            });
            
            if (transactions.length > 1) {
                const moreCount = transactions.length - 1;
                html += `<div style="text-align: center; color: #cccccc; font-size: 0.8em; margin-top: 5px;">${getText('more-records').replace('{count}', moreCount)}</div>`;
            }
            
            // æ·»åŠ æŸ¥çœ‹å…¨éƒ¨äº¤æ˜“æŒ‰é’®ï¼ˆåªè¦æœ‰äº¤æ˜“è®°å½•å°±æ˜¾ç¤ºï¼‰
            if (transactions.length > 0) {
                html += `<div style="text-align: center; margin-top: 10px;">
                            <button onclick="viewAllTransactions(${salonId}, event)" style="background: var(--gold); color: var(--black); border: none; padding: 5px 15px; border-radius: 3px; cursor: pointer; font-size: 0.8em;">${getText('view-all-transactions')}</button>
                         </div>`;
            }
            
            html += '</div>';
            return html;
        }
        
        // åˆ‡æ¢æ²™é¾™æŠ˜å çŠ¶æ€ï¼ˆä¼˜åŒ–ç‰ˆæœ¬ï¼‰
        function toggleSalonCollapse(salonId) {
            const detailsElement = document.querySelector(`.salon-details[data-salon-id="${salonId}"]`);
            const toggleButton = document.querySelector(`.salon-toggle-btn[data-salon-id="${salonId}"]`);
            
            if (!detailsElement || !toggleButton) return;
            
            if (detailsElement.style.display === 'none' || detailsElement.style.display === '') {
                // å±•å¼€ - å»¶è¿ŸåŠ è½½è¯¦ç»†ä¿¡æ¯
                loadSalonDetails(salonId);
                detailsElement.style.display = 'block';
                toggleButton.textContent = 'â–¼';
                toggleButton.title = 'æ”¶èµ·';
            } else {
                // æ”¶èµ·
                detailsElement.style.display = 'none';
                toggleButton.textContent = 'â–¶';
                toggleButton.title = 'å±•å¼€';
            }
        }

        // äº‹ä»¶å§”æ‰˜å¤„ç†æ²™é¾™åˆ—è¡¨ç‚¹å‡»äº‹ä»¶
        function initializeSalonListEvents() {
            const salonListContainer = document.getElementById('salon-list');
            
            // ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨
            salonListContainer.removeEventListener('click', handleSalonListClick);
            salonListContainer.removeEventListener('change', handleSalonListChange);
            
            // æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨
            salonListContainer.addEventListener('click', handleSalonListClick);
            salonListContainer.addEventListener('change', handleSalonListChange);
        }

        // å¤„ç†æ²™é¾™åˆ—è¡¨ä¸­çš„ç‚¹å‡»äº‹ä»¶
        function handleSalonListClick(e) {
            const target = e.target;
            
            // å¤„ç†æŠ˜å /å±•å¼€æŒ‰é’®
            if (target.classList.contains('salon-toggle-btn')) {
                const salonId = parseInt(target.dataset.salonId);
                toggleSalonCollapse(salonId);
                return;
            }
            
            // å¤„ç†ç¼–è¾‘æŒ‰é’®
            if (target.classList.contains('edit-salon-btn')) {
                const salonId = parseInt(target.dataset.salonId);
                showEditSalonModal(salonId);
                return;
            }
            
            // å¤„ç†æ·»åŠ äº¤æ˜“æŒ‰é’®
            if (target.classList.contains('add-transaction-btn')) {
                const salonId = parseInt(target.dataset.salonId);
                showAddTransactionModal(salonId);
                return;
            }
        }

        // å¤„ç†æ²™é¾™åˆ—è¡¨ä¸­çš„changeäº‹ä»¶
        function handleSalonListChange(e) {
            const target = e.target;
            
            // å¤„ç†å¤é€‰æ¡†å˜åŒ–
            if (target.classList.contains('salon-checkbox')) {
                updateBatchControls();
                return;
            }
        }
        
        // æ£€æŸ¥ä¸šåŠ¡å‘˜æ˜¯å¦æœ‰æƒæŸ¥çœ‹æŸä¸ªæ²™é¾™
        function canSalespersonViewSalon(salon, salespersonId) {
            // ä¸šåŠ¡å‘˜åªèƒ½æŸ¥çœ‹æŒ‡å®šç»™è‡ªå·±è´Ÿè´£çš„æ²™é¾™
            return salon.responsibleEmployeeId && salon.responsibleEmployeeId.toString() === salespersonId.toString();
        }
        
        // æ²™é¾™åˆ—è¡¨åˆ†é¡µé…ç½®
        let currentPage = 1;
        let itemsPerPage = 20; // æ¯é¡µæ˜¾ç¤ºçš„æ²™é¾™æ•°é‡ï¼ˆå¯å˜ï¼‰
        let currentSalonsData = []; // å½“å‰çš„æ²™é¾™æ•°æ®
        let currentFilter = null; // å½“å‰çš„ç­›é€‰æ¡ä»¶
        let currentSortField = 'default'; // å½“å‰æ’åºå­—æ®µ
        let currentSortOrder = ''; // å½“å‰æ’åºé¡ºåº
        
        // æ“ä½œå†å²è®°å½•åˆ†é¡µé…ç½®
        let currentHistoryPage = 1;
        let historyItemsPerPage = 20; // æ¯é¡µæ˜¾ç¤ºçš„å†å²è®°å½•æ•°é‡ï¼ˆå¯å˜ï¼‰
        let currentHistoryData = []; // å½“å‰çš„å†å²è®°å½•æ•°æ®
        
        // æ•°æ®å¯¹æ¯”é¡µé¢é…ç½®
        let currentComparisonOperation = null; // å½“å‰æ˜¾ç¤ºçš„æ“ä½œè®°å½•

        // æ˜¾ç¤ºæ²™é¾™åˆ—è¡¨ï¼ˆä¼˜åŒ–ç‰ˆæœ¬ - æ”¯æŒåˆ†é¡µå’Œæ’åºï¼‰
        async function displaySalonList(filteredByDistrict = null, page = 1) {
            const salonListContainer = document.getElementById('salon-list');
            const salonCountText = document.getElementById('salon-count-text');
            let salons = await getSalons();
            
            // æ ¹æ®æƒé™ç­›é€‰æ²™é¾™åˆ—è¡¨
            if (currentUser && currentUser.position === 'salesperson') {
                // ä¸šåŠ¡å‘˜åªèƒ½çœ‹åˆ°æŒ‡å®šç»™è‡ªå·±è´Ÿè´£çš„æ²™é¾™
                salons = salons.filter(salon => canSalespersonViewSalon(salon, currentUser.id));
            }
            
            // å¦‚æœæœ‰åŒºåŸŸç­›é€‰
            if (filteredByDistrict) {
                salons = salons.filter(salon => salon.district === filteredByDistrict);
            }
            
            // åº”ç”¨æ’åº
            if (currentSortField !== 'default') {
                salons = applySalonSort(salons, currentSortField, currentSortOrder);
            }
            
            // ä¿å­˜å½“å‰æ•°æ®å’Œç­›é€‰æ¡ä»¶
            currentSalonsData = salons;
            currentFilter = filteredByDistrict;
            currentPage = page;
            
            // æ›´æ–°æ²™é¾™æ€»æ•°æ˜¾ç¤º
            if (filteredByDistrict) {
                salonCountText.setAttribute('data-i18n', 'district-salons-count');
                salonCountText.setAttribute('data-i18n-params', `{"count": "${salons.length}"}`);
                salonCountText.textContent = getText('district-salons-count').replace('{count}', salons.length);
            } else {
                salonCountText.setAttribute('data-i18n', 'total-salons-count');
                salonCountText.setAttribute('data-i18n-params', `{"count": "${salons.length}"}`);
                salonCountText.textContent = getText('total-salons-count').replace('{count}', salons.length);
            }
            
            if (salons.length === 0) {
                let noSalonMessage = getText('no-salon-info');
                let tipMessage = getText('add-salon-tip');
                
                if (currentUser && currentUser.position === 'salesperson') {
                    noSalonMessage = getText('no-salesperson-salons');
                    tipMessage = getText('salesperson-salon-tip');
                }
                
                salonListContainer.innerHTML = `<div style="text-align: center; color: #cccccc; padding: 40px;"><p>${noSalonMessage}</p><p style="font-size: 0.9em;">${tipMessage}</p></div>`;
                
                // æ›´æ–°æ²™é¾™æ€»æ•°æ˜¾ç¤º
                if (filteredByDistrict) {
                    salonCountText.setAttribute('data-i18n', 'district-salons-count');
                    salonCountText.setAttribute('data-i18n-params', '{"count": "0"}');
                    salonCountText.textContent = getText('district-salons-count').replace('{count}', 0);
                } else {
                    salonCountText.setAttribute('data-i18n', 'total-salons-count');
                    salonCountText.setAttribute('data-i18n-params', '{"count": "0"}');
                    salonCountText.textContent = getText('total-salons-count').replace('{count}', 0);
                }
                return;
            }
            
            // è®¡ç®—åˆ†é¡µ
            const totalPages = Math.ceil(salons.length / itemsPerPage);
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedSalons = salons.slice(startIndex, endIndex);
            
            // æ¸²æŸ“æ²™é¾™åˆ—è¡¨
            renderSalonItems(paginatedSalons, startIndex);
            
            // æ¸²æŸ“åˆ†é¡µæ§ä»¶
            renderPagination(totalPages, page, salons.length);
            
            // å»¶è¿Ÿåˆå§‹åŒ–æ‰¹é‡æ§åˆ¶çŠ¶æ€ï¼ˆä¸æ›´æ–°æ’åºæŒ‰é’®æ ·å¼ï¼Œé¿å…è¦†ç›–æ’åºçŠ¶æ€ï¼‰
            requestAnimationFrame(() => {
                updateBatchControls();
            });
        }

        // æ¸²æŸ“æ²™é¾™é¡¹ç›®ï¼ˆä¼˜åŒ–ç‰ˆæœ¬ - ç®€åŒ–DOMç»“æ„ï¼ŒåŒ…å«é†’ç›®æç¤ºï¼‰
        function renderSalonItems(salons, startIndex) {
            const salonListContainer = document.getElementById('salon-list');
            
            let html = '';
            salons.forEach((salon, index) => {
                const globalIndex = startIndex + index + 1;
                const responsibleEmployeeName = getEmployeeName(salon.responsibleEmployeeId);
                
                // è®¡ç®—é†’ç›®æç¤ºï¼ˆä¼˜åŒ–ï¼šåªåœ¨éœ€è¦æ—¶è®¡ç®—ï¼‰
                const daysSinceLastTransaction = calculateOverdueDays(salon);
                // é«˜æ•ˆè®¡ç®—è­¦å‘ŠçŠ¶æ€
                const hasLongInactive = daysSinceLastTransaction > 30;
                
                // è®¡ç®—æ¬ æ¬¾å¤©æ•°å’Œé‡‘é¢ï¼ˆä½¿ç”¨æ–°çš„é«˜æ€§èƒ½å‡½æ•°ï¼‰
                let outstandingDays = 0;
                let outstandingAmount = 0;
                
                if (salon.transactions && salon.transactions.length > 0) {
                    outstandingDays = calculateOutstandingDays(salon);
                    outstandingAmount = calculateOutstandingAmount(salon);
                }
                
                const hasLongOutstandingDays = outstandingDays > 60; // è¶…è¿‡60å¤©
                const hasHighOutstandingAmount = outstandingAmount > 500000; // è¶…è¿‡50ä¸‡éŸ©å…ƒ
                
                // ç¡®å®šè¾¹æ¡†é¢œè‰²å’ŒèƒŒæ™¯è‰²ï¼ˆæ›´æ–°è­¦å‘Šé€»è¾‘ï¼‰
                let borderColor = 'rgba(212, 175, 55, 0.3)';
                let backgroundColor = 'rgba(212, 175, 55, 0.1)';
                
                const hasAnyWarning = hasLongInactive || hasLongOutstandingDays || hasHighOutstandingAmount;
                
                if (hasAnyWarning) {
                    if ((hasLongInactive && hasLongOutstandingDays) || (hasLongInactive && hasHighOutstandingAmount) || 
                        (hasLongOutstandingDays && hasHighOutstandingAmount)) {
                        borderColor = '#FF4500'; // æ©™çº¢è‰² - å¤šé‡è­¦å‘Š
                        backgroundColor = 'rgba(255, 69, 0, 0.1)';
                    } else if (hasLongInactive) {
                        borderColor = '#FFA500'; // æ©™è‰² - é•¿æœŸæœªäº¤æ˜“
                        backgroundColor = 'rgba(255, 165, 0, 0.1)';
                    } else if (hasLongOutstandingDays) {
                        borderColor = '#FF6666'; // çº¢è‰² - é•¿æœŸæ¬ æ¬¾å¤©æ•°
                        backgroundColor = 'rgba(255, 102, 102, 0.1)';
                    } else if (hasHighOutstandingAmount) {
                        borderColor = '#FF1493'; // æ·±ç²‰è‰² - é«˜é¢æ¬ æ¬¾
                        backgroundColor = 'rgba(255, 20, 147, 0.1)';
                    }
                }
                
                // ç”Ÿæˆè­¦å‘Šæ ‡ç­¾
                let warningTags = '';
                if (hasLongInactive) {
                    warningTags += `<span style="background: #FFA500; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.7em; margin-right: 5px;">è¶…${daysSinceLastTransaction}å¤©æœªè®¢è´§</span>`;
                }
                if (hasLongOutstandingDays) {
                    warningTags += `<span style="background: #FF6666; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.7em; margin-right: 5px;">æ¬ æ¬¾${outstandingDays}å¤©</span>`;
                }
                if (hasHighOutstandingAmount) {
                    const formattedAmount = (outstandingAmount / 10000).toFixed(1);
                    warningTags += `<span style="background: #FF1493; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.7em;">æ¬ æ¬¾${formattedAmount}ä¸‡å…ƒ</span>`;
                }
                
                html += `
                    <div class="salon-item" data-salon-id="${salon.id}" style="background: ${backgroundColor}; padding: 15px; border-radius: 5px; margin-bottom: 10px; border: 2px solid ${borderColor};">
                        <!-- ç®€åŒ–çš„å¤´éƒ¨ä¿¡æ¯ -->
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex-grow: 1; display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" class="salon-checkbox" data-salon-id="${salon.id}" style="cursor: pointer;">
                                <button class="salon-toggle-btn" data-salon-id="${salon.id}" style="background: none; border: none; color: var(--gold); font-size: 1.1em; cursor: pointer; padding: 0; width: 18px; text-align: center;" title="å±•å¼€">â–¶</button>
                                <div style="flex-grow: 1;">
                                    <div style="color: #999; font-size: 0.9em; margin-bottom: 2px;">#${globalIndex}</div>
                                    <h3 style="color: var(--gold-light); margin: 0; font-size: 1.1em;">${salon.name}</h3>
                                    <p style="margin: 2px 0 0 0; color: #cccccc; font-size: 0.9em;">${salon.address}</p>
                                    <p style="margin: 2px 0 0 0; color: #aaa; font-size: 0.8em;">${getText('responsible-employee')}ï¼š${responsibleEmployeeName}</p>
                                    ${warningTags ? `<div style="margin-top: 5px;">${warningTags}</div>` : ''}
                                </div>
                            </div>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <button class="edit-salon-btn" data-salon-id="${salon.id}" style="background: #4CAF50; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.8em;">${getText('edit-btn')}</button>
                                <button class="add-transaction-btn" data-salon-id="${salon.id}" style="background: var(--gold); color: var(--black); border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.8em;">${getText('add-transaction-btn')}</button>
                            </div>
                        </div>
                        
                        <!-- è¯¦ç»†ä¿¡æ¯ï¼ˆå»¶è¿ŸåŠ è½½ï¼‰ -->
                        <div class="salon-details" data-salon-id="${salon.id}" style="display: none; margin-top: 15px;">
                            <div class="loading-placeholder" style="text-align: center; color: #999; padding: 20px;">${getText('loading')}...</div>
                        </div>
                    </div>
                `;
            });
            
            salonListContainer.innerHTML = html;
            
            // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
            initializeSalonListEvents();
        }
        
        // è®¡ç®—æ¬ æ¬¾å¤©æ•°ï¼ˆä»æœ€è¿‘çš„å®æ”¶é‡‘é¢å¼€å§‹è®¡ç®—ï¼Œè¶…é«˜æ€§èƒ½ç‰ˆæœ¬ï¼‰
        function calculateOutstandingDays(salon) {
            if (!salon.transactions || !Array.isArray(salon.transactions) || salon.transactions.length === 0) {
                // æ²¡æœ‰äº¤æ˜“è®°å½•ï¼Œä»å¼€æˆ·æ—¶é—´ç®—èµ·
                if (salon.addTime) {
                    const openDate = new Date(salon.addTime);
                    const now = new Date();
                    return Math.floor((now - openDate) / (1000 * 60 * 60 * 24));
                }
                return 0;
            }
            
            // ä½¿ç”¨ç¼“å­˜é¿å…é‡å¤è®¡ç®—
            if (salon._cachedOutstandingDays !== undefined && salon._lastDaysCalculatedTime) {
                const now = Date.now();
                // å¦‚æœç¼“å­˜æ—¶é—´å°äº10ç§’ï¼Œç›´æ¥è¿”å›ç¼“å­˜å€¼
                if (now - salon._lastDaysCalculatedTime < 10000) {
                    return salon._cachedOutstandingDays;
                }
            }
            
            // æ‰¾åˆ°æœ€è¿‘çš„æ”¶æ¬¾è®°å½•
            let latestReceiptDate = null;
            
            for (let i = 0; i < salon.transactions.length; i++) {
                const transaction = salon.transactions[i];
                if (transaction.status === 'æ”¶æ¬¾' || transaction.status === 'å®æ”¶') {
                    const transactionDate = new Date(transaction.date || transaction.time);
                    if (!isNaN(transactionDate.getTime())) {
                        if (!latestReceiptDate || transactionDate > latestReceiptDate) {
                            latestReceiptDate = transactionDate;
                        }
                    }
                }
            }
            
            let daysDiff = 0;
            const now = new Date();
            
            if (latestReceiptDate) {
                // ä»æœ€è¿‘æ”¶æ¬¾æ—¥æœŸç®—èµ·
                daysDiff = Math.floor((now - latestReceiptDate) / (1000 * 60 * 60 * 24));
            } else {
                // æ²¡æœ‰æ”¶æ¬¾è®°å½•ï¼Œä»å¼€æˆ·æ—¶é—´ç®—èµ·
                const openDate = new Date(salon.addTime);
                daysDiff = Math.floor((now - openDate) / (1000 * 60 * 60 * 24));
            }
            
            // ç¼“å­˜ç»“æœ
            salon._cachedOutstandingDays = Math.max(0, daysDiff);
            salon._lastDaysCalculatedTime = Date.now();
            
            return salon._cachedOutstandingDays;
        }
        
        // è®¡ç®—æ¬ æ¬¾é‡‘é¢ï¼ˆè¶…é«˜æ€§èƒ½ç‰ˆæœ¬ï¼‰
        function calculateOutstandingAmount(salon) {
            if (!salon.transactions || !Array.isArray(salon.transactions) || salon.transactions.length === 0) {
                return 0;
            }
            
            // ä½¿ç”¨ç¼“å­˜é¿å…é‡å¤è®¡ç®—
            if (salon._cachedOutstandingAmount !== undefined && salon._lastAmountCalculatedTime) {
                const now = Date.now();
                // å¦‚æœç¼“å­˜æ—¶é—´å°äº10ç§’ï¼Œç›´æ¥è¿”å›ç¼“å­˜å€¼
                if (now - salon._lastAmountCalculatedTime < 10000) {
                    return salon._cachedOutstandingAmount;
                }
            }
            
            let totalOutstanding = 0;
            
            // é«˜æ€§èƒ½å¾ªç¯è®¡ç®—
            for (let i = 0; i < salon.transactions.length; i++) {
                const transaction = salon.transactions[i];
                const amount = parseFloat(transaction.amount) || 0;
                
                if (transaction.status === 'æ¬ æ¬¾') {
                    totalOutstanding += amount;
                } else if (transaction.status === 'æ”¶æ¬¾' || transaction.status === 'å®æ”¶') {
                    totalOutstanding -= amount;
                }
            }
            
            // ç¼“å­˜ç»“æœ
            salon._cachedOutstandingAmount = Math.max(0, totalOutstanding);
            salon._lastAmountCalculatedTime = Date.now();
            
            return salon._cachedOutstandingAmount;
        }

        // æ¸²æŸ“åˆ†é¡µæ§ä»¶
        function renderPagination(totalPages, currentPage, totalItems) {
            const salonListContainer = document.getElementById('salon-list');
            
            if (totalPages <= 1) return; // ä¸éœ€è¦åˆ†é¡µ
            
            // è·å–ç¿»è¯‘æ–‡å­—
            const firstPageText = getText('first-page');
            const prevPageText = getText('prev-page');
            const nextPageText = getText('next-page');
            const lastPageText = getText('last-page');
            const goToPageText = getText('go-to-page');
            const itemsPerPageText = getText('items-per-page');
            const itemsText = getText('items');
            const jumpText = getText('jump');
            const pageInfoText = getText('page-info')
                .replace('{current}', currentPage)
                .replace('{total}', totalPages)
                .replace('{items}', totalItems);
            
            let paginationHtml = `
                <div class="pagination-container" style="display: flex; justify-content: center; align-items: center; margin: 20px 0; gap: 10px; flex-wrap: wrap;">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="page-btn" onclick="goToPage(1)" ${currentPage === 1 ? 'disabled' : ''} style="padding: 8px 12px; background: ${currentPage === 1 ? '#666' : 'var(--gold)'}; color: ${currentPage === 1 ? '#999' : 'var(--black)'}; border: none; border-radius: 4px; cursor: ${currentPage === 1 ? 'not-allowed' : 'pointer'}; font-size: 0.9em;">${firstPageText}</button>
                        <button class="page-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''} style="padding: 8px 12px; background: ${currentPage === 1 ? '#666' : 'var(--gold)'}; color: ${currentPage === 1 ? '#999' : 'var(--black)'}; border: none; border-radius: 4px; cursor: ${currentPage === 1 ? 'not-allowed' : 'pointer'}; font-size: 0.9em;">${prevPageText}</button>
                        
                        <span style="color: var(--gold); font-size: 0.9em; margin: 0 10px;">${pageInfoText}</span>
                        
                        <button class="page-btn" onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''} style="padding: 8px 12px; background: ${currentPage === totalPages ? '#666' : 'var(--gold)'}; color: ${currentPage === totalPages ? '#999' : 'var(--black)'}; border: none; border-radius: 4px; cursor: ${currentPage === totalPages ? 'not-allowed' : 'pointer'}; font-size: 0.9em;">${nextPageText}</button>
                        <button class="page-btn" onclick="goToPage(${totalPages})" ${currentPage === totalPages ? 'disabled' : ''} style="padding: 8px 12px; background: ${currentPage === totalPages ? '#666' : 'var(--gold)'}; color: ${currentPage === totalPages ? '#999' : 'var(--black)'}; border: none; border-radius: 4px; cursor: ${currentPage === totalPages ? 'not-allowed' : 'pointer'}; font-size: 0.9em;">${lastPageText}</button>
                    </div>
                    
                    <div style="display: flex; gap: 10px; align-items: center; margin-left: 20px;">
                        <div style="display: flex; gap: 5px; align-items: center;">
                            <span style="color: var(--gold); font-size: 0.9em;">${goToPageText}ï¼š</span>
                            <input type="number" id="page-jump-input" min="1" max="${totalPages}" value="${currentPage}" onkeydown="if(event.key==='Enter')jumpToPage()" style="width: 60px; padding: 6px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 4px; text-align: center; font-size: 0.9em;">
                            <button onclick="jumpToPage()" style="padding: 6px 12px; background: var(--gold); color: var(--black); border: none; border-radius: 4px; cursor: pointer; font-size: 0.9em;">${jumpText}</button>
                        </div>
                        
                        <div style="display: flex; gap: 5px; align-items: center;">
                            <span style="color: var(--gold); font-size: 0.9em;">${itemsPerPageText}</span>
                            <select id="items-per-page-select" onchange="changeItemsPerPage()" style="padding: 6px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 4px; font-size: 0.9em;">
                                <option value="20">20</option>
                                <option value="30">30</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                            <span style="color: var(--gold); font-size: 0.9em;">${itemsText}</span>
                        </div>
                    </div>
                </div>
            `;
            
            salonListContainer.insertAdjacentHTML('beforeend', paginationHtml);
            
            // è®¾ç½®æ¯é¡µæ˜¾ç¤ºæ¡æ•°é€‰æ‹©å™¨çš„å½“å‰å€¼
            const itemsPerPageSelect = document.getElementById('items-per-page-select');
            if (itemsPerPageSelect) {
                itemsPerPageSelect.value = itemsPerPage.toString();
            }
        }

        // è·³è½¬åˆ°æŒ‡å®šé¡µé¢
        function goToPage(page) {
            if (page < 1 || page > Math.ceil(currentSalonsData.length / itemsPerPage)) return;
            displaySalonList(currentFilter, page);
        }

        // é€šè¿‡è¾“å…¥æ¡†è·³è½¬åˆ°æŒ‡å®šé¡µé¢
        function jumpToPage() {
            const input = document.getElementById('page-jump-input');
            if (!input) return;
            
            const page = parseInt(input.value);
            const maxPage = Math.ceil(currentSalonsData.length / itemsPerPage);
            
            if (isNaN(page) || page < 1 || page > maxPage) {
                alert(getText('invalid-page-number').replace('{max}', maxPage));
                input.value = currentPage; // é‡ç½®ä¸ºå½“å‰é¡µ
                return;
            }
            
            goToPage(page);
        }
        
        // åˆ‡æ¢æ²™é¾™æ’åºï¼ˆå½»åº•ä¿®å¤ç‰ˆæœ¬ï¼‰
        function toggleSalonSort(sortField) {
            if (currentSortField === sortField) {
                // å¦‚æœæ˜¯ç›¸åŒå­—æ®µï¼Œåˆ‡æ¢æ’åºé¡ºåºï¼šasc -> desc -> asc
                currentSortOrder = currentSortOrder === 'asc' ? 'desc' : 'asc';
            } else {
                // å¦‚æœæ˜¯ä¸åŒå­—æ®µï¼Œè®¾ç½®ä¸ºæ–°å­—æ®µï¼Œé»˜è®¤æ­£åº
                currentSortField = sortField;
                currentSortOrder = 'asc';
            }
            
            // ç«‹å³æ›´æ–°æŒ‰é’®æ ·å¼ï¼Œä¸ç­‰å¾…ä»»ä½•å»¶è¿Ÿ
            updateAllSortButtonStyles();
            
            // ç«‹å³æ›´æ–°åˆ—è¡¨æ˜¾ç¤º
            displaySalonList(currentFilter, 1);
        }
        
        // é‡ç½®æ’åº
        function resetSalonSort() {
            currentSortField = 'default';
            currentSortOrder = '';
            
            // æ›´æ–°æ’åºæŒ‰é’®æ ·å¼
            updateAllSortButtonStyles();
            
            // é‡æ–°æ˜¾ç¤ºåˆ—è¡¨ï¼Œä¿æŒå½“å‰ç­›é€‰æ¡ä»¶ï¼Œå›åˆ°ç¬¬ä¸€é¡µ
            displaySalonList(currentFilter, 1);
        }
        
        // æ”¹å˜æ¯é¡µæ˜¾ç¤ºæ¡æ•°
        function changeItemsPerPage() {
            const select = document.getElementById('items-per-page-select');
            itemsPerPage = parseInt(select.value);
            
            // é‡æ–°æ˜¾ç¤ºåˆ—è¡¨ï¼Œä¿æŒå½“å‰ç­›é€‰å’Œæ’åºæ¡ä»¶ï¼Œå›åˆ°ç¬¬ä¸€é¡µ
            displaySalonList(currentFilter, 1);
        }
        
        // åº”ç”¨æ²™é¾™æ’åº
        function applySalonSort(salons, sortField, sortOrder) {
            if (sortField === 'default') {
                return salons; // è¿”å›åŸå§‹é¡ºåº
            }
            
            return salons.sort((a, b) => {
                let valueA, valueB;
                
                switch (sortField) {
                    case 'name':
                        valueA = a.name ? a.name.toLowerCase() : '';
                        valueB = b.name ? b.name.toLowerCase() : '';
                        break;
                    case 'address':
                        valueA = a.address ? a.address.toLowerCase() : '';
                        valueB = b.address ? b.address.toLowerCase() : '';
                        break;
                    case 'addTime':
                        // ç¡®ä¿æ—¥æœŸå­—ç¬¦ä¸²å¯ä»¥æ­£ç¡®æ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰æ—¶é—´åˆ™ä½¿ç”¨é»˜è®¤å€¼
                        valueA = a.addTime ? new Date(a.addTime).getTime() : 0;
                        valueB = b.addTime ? new Date(b.addTime).getTime() : 0;
                        break;
                    case 'lastTransaction':
                        // æœ€åäº¤æ˜“æ—¶é—´æ’åº
                        valueA = a.lastTransactionDate ? new Date(a.lastTransactionDate).getTime() : 0;
                        valueB = b.lastTransactionDate ? new Date(b.lastTransactionDate).getTime() : 0;
                        break;
                    case 'outstandingDays':
                        // æ¬ æ¬¾å¤©æ•°æ’åº
                        valueA = calculateOutstandingDays(a);
                        valueB = calculateOutstandingDays(b);
                        break;
                    case 'outstandingAmount':
                        // æ¬ æ¬¾é‡‘é¢æ’åº
                        valueA = calculateOutstandingAmount(a);
                        valueB = calculateOutstandingAmount(b);
                        break;
                    default:
                        return 0;
                }
                
                // å¦‚æœæ˜¯æ—¶é—´å­—æ®µæˆ–æ•°å€¼å­—æ®µï¼Œç›´æ¥æ¯”è¾ƒæ•°å€¼
                if (sortField === 'addTime' || sortField === 'lastTransaction' || sortField === 'outstandingDays' || sortField === 'outstandingAmount') {
                    if (sortOrder === 'asc') {
                        return valueA - valueB;
                    } else {
                        return valueB - valueA;
                    }
                }
                
                // å­—ç¬¦ä¸²æ¯”è¾ƒ
                if (sortOrder === 'asc') {
                    return valueA.localeCompare(valueB);
                } else {
                    return valueB.localeCompare(valueA);
                }
            });
        }
        
        // è®¡ç®—æ²™é¾™çš„ç´¯ç§¯æ¬ æ¬¾é‡‘é¢ï¼ˆä¼˜åŒ–æ€§èƒ½ç‰ˆæœ¬ï¼‰
        function calculateTotalOutstanding(salon) {
            if (!salon.transactions || !Array.isArray(salon.transactions) || salon.transactions.length === 0) {
                return 0;
            }
            
            // ä½¿ç”¨ç¼“å­˜é¿å…é‡å¤è®¡ç®—
            if (salon._cachedTotalOutstanding !== undefined && salon._lastCalculatedTime) {
                const now = Date.now();
                // å¦‚æœç¼“å­˜æ—¶é—´å°äº5ç§’ï¼Œç›´æ¥è¿”å›ç¼“å­˜å€¼
                if (now - salon._lastCalculatedTime < 5000) {
                    return salon._cachedTotalOutstanding;
                }
            }
            
            let totalOutstanding = 0;
            // ä¼˜åŒ–å¾ªç¯ï¼Œæå‰é€€å‡ºæ¡ä»¶
            for (let i = 0; i < salon.transactions.length; i++) {
                const transaction = salon.transactions[i];
                if (transaction.currentOutstanding) {
                    const amount = parseFloat(transaction.currentOutstanding);
                    if (!isNaN(amount)) {
                        totalOutstanding += amount;
                    }
                }
            }
            
            // ç¼“å­˜ç»“æœ
            salon._cachedTotalOutstanding = totalOutstanding;
            salon._lastCalculatedTime = Date.now();
            
            return totalOutstanding;
        }
        
        // æ›´æ–°æ’åºæŒ‰é’®æ ·å¼ï¼ˆç®€åŒ–ç‰ˆæœ¬ - é¼ æ ‡ç§»å‡ºæ—¶æ¢å¤åŸè‰²ï¼‰
        function updateSortButtonStyle(button) {
            // æ­¤å‡½æ•°ç”±onmouseoutäº‹ä»¶è°ƒç”¨ï¼Œæ¢å¤åŸå§‹èƒŒæ™¯è‰²
            if (button.id === 'sort-default') {
                button.style.background = 'rgba(255, 182, 193, 0.2)';
            } else {
                button.style.background = 'rgba(135, 206, 235, 0.2)';
            }
        }
        
        // æ›´æ–°æ‰€æœ‰æ’åºæŒ‰é’®æ ·å¼ï¼ˆå®Œå…¨é‡å†™ç‰ˆæœ¬ï¼Œä¿®å¤ç®­å¤´å˜åŒ–é—®é¢˜ï¼‰
        function updateAllSortButtonStyles() {
            // è·å–æ‰€æœ‰æ’åºæŒ‰é’®
            const sortButtons = document.querySelectorAll('[id^="sort-"]:not(#sort-default)');
            
            sortButtons.forEach(button => {
                const fieldName = button.id.replace('sort-', '');
                let buttonText = '';
                
                // æ ¹æ®å­—æ®µåè·å–å¯¹åº”çš„ç¿»è¯‘æ–‡æœ¬ï¼ˆæ”¯æŒå¤šè¯­è¨€ï¼‰
                switch(fieldName) {
                    case 'name':
                        buttonText = currentLanguage === 'ko' ? 'ì‚´ë¡±ëª…' : 'æ²™é¾™åç§°';
                        break;
                    case 'address':
                        buttonText = currentLanguage === 'ko' ? 'ì£¼ì†Œëª…' : 'åœ°å€åç§°';
                        break;
                    case 'addTime':
                        buttonText = currentLanguage === 'ko' ? 'ì¶”ê°€ì‹œê°„' : 'æ–°å¢æ—¶é—´';
                        break;
                    case 'lastTransaction':
                        buttonText = currentLanguage === 'ko' ? 'ìµœì¢…ê±°ë˜' : 'æœ€åäº¤æ˜“';
                        break;
                    case 'outstandingDays':
                        buttonText = currentLanguage === 'ko' ? 'ì™¸ìƒì¼ìˆ˜' : 'æ¬ æ¬¾å¤©æ•°';
                        break;
                    case 'outstandingAmount':
                        buttonText = currentLanguage === 'ko' ? 'ì™¸ìƒê¸ˆì•¡' : 'æ¬ æ¬¾é‡‘é¢';
                        break;
                    default:
                        buttonText = fieldName;
                }
                
                // æ ¹æ®å½“å‰æ’åºçŠ¶æ€æ·»åŠ æ­£ç¡®çš„ç®­å¤´
                if (currentSortField === fieldName) {
                    const arrow = currentSortOrder === 'asc' ? ' â†‘' : ' â†“';
                    buttonText += arrow;
                } else {
                    // ä¸æ˜¯å½“å‰å­—æ®µæ—¶æ˜¾ç¤ºé»˜è®¤ä¸Šç®­å¤´
                    buttonText += ' â†‘';
                }
                
                // ç›´æ¥è®¾ç½®æ–‡æœ¬å†…å®¹
                button.textContent = buttonText;
            });
        }

        // å»¶è¿ŸåŠ è½½æ²™é¾™è¯¦ç»†ä¿¡æ¯
        function loadSalonDetails(salonId) {
            const salon = currentSalonsData.find(s => s.id === salonId);
            if (!salon) return;
            
            const detailsContainer = document.querySelector(`.salon-details[data-salon-id="${salonId}"]`);
            if (!detailsContainer) return;
            
            // è®¡ç®—ç›¸å…³æ•°æ®
            const overdueDays = calculateOverdueDays(salon);
            const overdueColor = overdueDays > 30 ? '#ff6666' : overdueDays > 7 ? '#ffaa00' : '#90EE90';
            const transactionHistory = formatTransactionHistory(salon.transactions, salon.id);
            
            // çŠ¶æ€æ˜¾ç¤º
            let statusText = '';
            if (overdueDays > 30) {
                statusText = `<span style="color: #ff6666;">ï¼ˆ${getText('long-inactive')}ï¼‰</span>`;
            } else if (overdueDays > 7) {
                statusText = `<span style="color: #ffaa00;">ï¼ˆ${getText('needs-attention')}ï¼‰</span>`;
            } else {
                statusText = `<span style="color: #90EE90;">ï¼ˆ${getText('active-customer')}ï¼‰</span>`;
            }
            
            const detailsHtml = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        ${salon.phone ? `<p><strong>${getText('salon-phone-label')}ï¼š</strong> ${salon.phone}</p>` : ''}
                        <p><strong>${getText('director-name-label')}ï¼š</strong> ${salon.directorName}</p>
                        <p><strong>${getText('director-mobile-label')}ï¼š</strong> ${formatMobile(salon.directorMobile)}</p>
                        <p><strong>${getText('first-join-label')}ï¼š</strong> ${salon.addTime}</p>
                        <p style="color: var(--gold-light);"><strong>${getText('status-label')}ï¼š</strong> ${getText('status-active')}</p>
                    </div>
                    
                    <div>
                        <p><strong>${getText('days-since-last-label')}ï¼š</strong> <span style="color: ${overdueColor}; font-weight: bold;">${overdueDays} ${getText('days-unit')}</span> 
                            ${statusText}
                        </p>
                        <p><strong>${getText('transaction-count-label')}ï¼š</strong> ${salon.transactions ? salon.transactions.length : 0} ${getText('transaction-unit')}</p>
                        ${salon.lastTransactionDate ? `<p><strong>${getText('last-transaction-label')}ï¼š</strong> ${new Date(salon.lastTransactionDate).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN')}</p>` : `<p><strong>${getText('last-transaction-label')}ï¼š</strong> <span style="color: #cccccc;">${getText('no-transaction')}</span></p>`}
                        
                        <div style="margin-top: 10px;">
                            <strong>${getText('recent-transactions-label')}ï¼š</strong>
                            ${transactionHistory}
                        </div>
                    </div>
                </div>
            `;
            
            detailsContainer.innerHTML = detailsHtml;
        }
        
        // ç¡®è®¤åˆ é™¤æ²™é¾™
        function confirmDeleteSalon(salonId) {
            const salons = getSalons();
            const salon = salons.find(s => s.id === salonId);
            if (salon && confirm(getText('confirm-delete-salon').replace('{name}', salon.name))) {
                // æ£€æŸ¥æ˜¯å¦éœ€è¦å®¡æ‰¹
                if (currentUser.position === 'admin') {
                    // ç®¡ç†å‘˜ç›´æ¥åˆ é™¤
                                    deleteSalon(salonId);
                displaySalonList(currentFilter, 1); // åˆ·æ–°åˆ—è¡¨åˆ°ç¬¬ä¸€é¡µ
                updateDeleteSalonOptions(); // æ›´æ–°åˆ é™¤é¡µé¢çš„é€‰é¡¹
                alert(getText('salon-deleted-success'));
                } else {
                    // ç»ç†å’Œä¸šåŠ¡å‘˜éœ€è¦å®¡æ‰¹
                    const description = `åˆ é™¤æ²™é¾™ï¼š${salon.name} (${salon.address})`;
                    submitApprovalRequest('delete-salon', { salonId: salonId }, description);
                    
                    alert(getText('approval-submitted'));
                }
            }
        }
        
        // æ›´æ–°åˆ é™¤æ²™é¾™é¡µé¢çš„é€‰é¡¹
        function updateDeleteSalonOptions() {
            const selectElement = document.getElementById('deleteSalonSelect');
            if (!selectElement) return;
            
            const salons = getSalons();
            let optionsHtml = `<option value="">${getText('please-select-salon')}</option>`;
            
            salons.forEach(salon => {
                optionsHtml += `<option value="${salon.id}">${salon.name} - ${salon.address}</option>`;
            });
            
            selectElement.innerHTML = optionsHtml;
        }
        
        // åˆ é™¤é€‰å®šçš„æ²™é¾™
        function deleteSelectedSalon() {
            const selectElement = document.getElementById('deleteSalonSelect');
            const selectedSalonId = selectElement.value;
            
            if (!selectedSalonId) {
                alert(getText('select-salon-first'));
                return;
            }
            
            const salons = getSalons();
            const salon = salons.find(s => s.id == selectedSalonId);
            
            if (!salon) return;
            
            if (confirm(getText('confirm-delete-salon').replace('{name}', salon.name))) {
                // æ£€æŸ¥æ˜¯å¦éœ€è¦å®¡æ‰¹
                if (currentUser.position === 'admin') {
                    // ç®¡ç†å‘˜ç›´æ¥åˆ é™¤
                deleteSalon(parseInt(selectedSalonId));
                updateDeleteSalonOptions(); // æ›´æ–°ä¸‹æ‹‰åˆ—è¡¨
                alert(getText('salon-deleted-success'));
                
                // å¦‚æœå½“å‰åœ¨æ²™é¾™ä¿¡æ¯é¡µé¢ï¼Œä¹Ÿåˆ·æ–°é‚£ä¸ªé¡µé¢
                const salonInfoPage = document.getElementById('salon-info');
                if (salonInfoPage && salonInfoPage.classList.contains('active')) {
                    displaySalonList(currentFilter, 1); // åˆ·æ–°åˆ°ç¬¬ä¸€é¡µ
                    }
                } else {
                    // ç»ç†å’Œä¸šåŠ¡å‘˜éœ€è¦å®¡æ‰¹
                    const description = `åˆ é™¤æ²™é¾™ï¼š${salon.name} (${salon.address})`;
                    submitApprovalRequest('delete-salon', { salonId: parseInt(selectedSalonId) }, description);
                    
                    alert(getText('approval-submitted'));
                }
            }
        }
        
        // ç­›é€‰åˆ é™¤æ²™é¾™åˆ—è¡¨ï¼ˆæŒ‰åŒºåŸŸï¼‰
        function filterDeleteSalonList() {
            const districtFilter = document.getElementById('delete-district-filter').value;
            const searchValue = document.getElementById('delete-salon-search').value.toLowerCase();
            
            const salons = getSalons();
            let filteredSalons = salons;
            
            // æŒ‰åŒºåŸŸç­›é€‰
            if (districtFilter) {
                filteredSalons = filteredSalons.filter(salon => salon.district === districtFilter);
            }
            
            // æŒ‰æœç´¢è¯ç­›é€‰
            if (searchValue) {
                filteredSalons = filteredSalons.filter(salon => {
                    return salon.name.toLowerCase().includes(searchValue) ||
                           salon.directorName.toLowerCase().includes(searchValue) ||
                           salon.directorMobile.toLowerCase().includes(searchValue);
                });
            }
            
            updateDeleteSalonOptionsWithFilter(filteredSalons);
        }
        
        // æœç´¢åˆ é™¤æ²™é¾™åˆ—è¡¨
        function searchDeleteSalons() {
            filterDeleteSalonList(); // é‡ç”¨ç­›é€‰é€»è¾‘
        }
        
        // æ¸…ç©ºåˆ é™¤é¡µé¢æœç´¢
        function clearDeleteSearch() {
            document.getElementById('delete-salon-search').value = '';
            document.getElementById('delete-district-filter').value = '';
            updateDeleteSalonOptions(); // é‡ç½®ä¸ºæ˜¾ç¤ºæ‰€æœ‰æ²™é¾™
        }
        
        // ä½¿ç”¨ç­›é€‰ç»“æœæ›´æ–°åˆ é™¤æ²™é¾™é€‰é¡¹
        function updateDeleteSalonOptionsWithFilter(filteredSalons) {
            const selectElement = document.getElementById('deleteSalonSelect');
            selectElement.innerHTML = `<option value="">${getText('please-select-salon')}</option>`;
            
            filteredSalons.forEach(salon => {
                const option = document.createElement('option');
                option.value = salon.id;
                const districtText = getDistrictText(salon.district);
                option.textContent = `${salon.name} (${districtText}, ${salon.directorName})`;
                selectElement.appendChild(option);
            });
        }
        
        // æ˜¾ç¤ºæ·»åŠ äº¤æ˜“è®°å½•æ¨¡æ€æ¡†
        function showAddTransactionModal(salonId) {
            currentSalonId = salonId;
            updateSalespersonOptions(); // åŠ è½½ä¸šåŠ¡å‘˜é€‰é¡¹
            
            // éšè—äº§å“å†å²è®°å½•åŒºåŸŸ
            const historySection = document.getElementById('product-history-section');
            if (historySection) {
                historySection.style.display = 'none';
            }
            
            const modal = document.getElementById('transactionModal');
            modal.style.display = 'flex';
            // å¦‚æœä¸šåŠ¡å‘˜åªèƒ½é€‰æ‹©è‡ªå·±ï¼Œåˆ™è‡ªåŠ¨èšç„¦åˆ°äº§å“è¾“å…¥
            const salespersonSelect = document.getElementById('salespersonSelect');
            if (salespersonSelect.options.length === 2) { // åªæœ‰é»˜è®¤é€‰é¡¹å’Œå½“å‰ç”¨æˆ·
                salespersonSelect.selectedIndex = 1;
            }
        }
        
        // å…³é—­äº¤æ˜“è®°å½•æ¨¡æ€æ¡†
        function closeTransactionModal() {
            const modal = document.getElementById('transactionModal');
            modal.style.display = 'none';
            document.getElementById('transactionForm').reset();
            
            // éšè—äº§å“å†å²è®°å½•åŒºåŸŸ
            const historySection = document.getElementById('product-history-section');
            if (historySection) {
                historySection.style.display = 'none';
            }
            
            currentSalonId = null;
        }
        
        // ç¼–è¾‘äº¤æ˜“è®°å½•ç›¸å…³å‡½æ•°
        let editProductRowCounter = 0;
        
        // æ˜¾ç¤ºç¼–è¾‘äº¤æ˜“è®°å½•æ¨¡æ€æ¡†
        function showEditTransactionModal() {
            const salons = getSalons();
            const salon = salons.find(s => s.id === currentViewingSalonId);
            if (!salon) return;
            
            const transaction = salon.transactions.find(t => t.id === currentTransactionId);
            if (!transaction) return;
            
            // å¡«å……è¡¨å•æ•°æ®
            document.getElementById('editReceivedAmount').value = formatNumber(transaction.receivedAmount || 0);
            document.getElementById('editTransactionNotes').value = transaction.notes || '';
            
            // å¡«å……ä¸šåŠ¡å‘˜é€‰æ‹©
            updateEditSalespersonOptions();
            if (transaction.salespersonId) {
                document.getElementById('editSalespersonSelect').value = transaction.salespersonId;
            }
            
            // æ¸…ç©ºå¹¶é‡æ–°å¡«å……äº§å“è¡¨æ ¼
            document.getElementById('editProductTableBody').innerHTML = '';
            editProductRowCounter = 0;
            
            if (transaction.products && Array.isArray(transaction.products)) {
                transaction.products.forEach(product => {
                    addEditProductRow();
                    const currentRow = editProductRowCounter;
                    const row = document.getElementById(`editProductRow_${currentRow}`);
                    const inputs = row.querySelectorAll('input');
                    inputs[0].value = product.name || '';
                    inputs[1].value = formatNumber(product.unitPrice || 0);
                    inputs[2].value = product.quantity || 0;
                    inputs[3].value = product.giftQuantity || 0;
                    calculateEditRowTotal(currentRow);
                });
            } else {
                addEditProductRow(); // è‡³å°‘æ·»åŠ ä¸€è¡Œ
            }
            
            calculateEditTotalAmount();
            
            const modal = document.getElementById('editTransactionModal');
            modal.style.display = 'flex';
            updateTexts(); // æ›´æ–°ç¿»è¯‘
        }
        
        // å…³é—­ç¼–è¾‘äº¤æ˜“è®°å½•æ¨¡æ€æ¡†
        function closeEditTransactionModal() {
            const modal = document.getElementById('editTransactionModal');
            modal.style.display = 'none';
            document.getElementById('editTransactionForm').reset();
            document.getElementById('editProductTableBody').innerHTML = '';
            editProductRowCounter = 0;
        }
        
        // æ›´æ–°ç¼–è¾‘æ¨¡å¼çš„ä¸šåŠ¡å‘˜é€‰é¡¹
        function updateEditSalespersonOptions() {
            const selectElement = document.getElementById('editSalespersonSelect');
            const employees = getEmployees();
            
            let optionsHtml = `<option value="">${getText('please-select-salesperson')}</option>`;
            
            // ç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰ä¸šåŠ¡å‘˜
            employees.forEach(employee => {
                optionsHtml += `<option value="${employee.id}">${employee.name}</option>`;
            });
            
            selectElement.innerHTML = optionsHtml;
        }
        
        // æ·»åŠ ç¼–è¾‘äº§å“è¡Œ
        function addEditProductRow() {
            editProductRowCounter++;
            const tbody = document.getElementById('editProductTableBody');
            const row = document.createElement('tr');
            row.id = `editProductRow_${editProductRowCounter}`;
            row.innerHTML = `
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3);">
                    <input type="text" placeholder="äº§å“åç§°" style="width: 100%; padding: 5px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.5); color: var(--text-light); border-radius: 3px; box-sizing: border-box;">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3);">
                    <input type="text" placeholder="1,000" oninput="formatEditInputAndCalculate(this, ${editProductRowCounter})" style="width: 100%; padding: 5px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.5); color: var(--text-light); border-radius: 3px; box-sizing: border-box; text-align: center;">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3);">
                    <input type="number" placeholder="1" min="0" max="99" oninput="calculateEditRowTotal(${editProductRowCounter})" style="width: 100%; padding: 5px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.5); color: var(--text-light); border-radius: 3px; box-sizing: border-box; text-align: center;">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3);">
                    <input type="number" placeholder="0" min="0" style="width: 100%; padding: 5px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.5); color: var(--text-light); border-radius: 3px; box-sizing: border-box; text-align: center;">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3); text-align: center; color: var(--gold);" id="editRowTotal_${editProductRowCounter}">
                    â‚©0
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3); text-align: center;">
                    <button type="button" onclick="removeEditProductRow(${editProductRowCounter})" style="background: #ff6666; color: white; border: none; padding: 3px 8px; border-radius: 3px; cursor: pointer; font-size: 0.8em;" data-i18n="remove">åˆ é™¤</button>
                </td>
            `;
            tbody.appendChild(row);
            updateTexts(); // æ›´æ–°ç¿»è¯‘
            calculateEditTotalAmount();
        }
        
        // åˆ é™¤ç¼–è¾‘äº§å“è¡Œ
        function removeEditProductRow(rowId) {
            const row = document.getElementById(`editProductRow_${rowId}`);
            if (row) {
                row.remove();
                calculateEditTotalAmount();
            }
        }
        
        // æ ¼å¼åŒ–ç¼–è¾‘è¾“å…¥å¹¶è®¡ç®—
        function formatEditInputAndCalculate(input, rowId) {
            // åªå…è®¸è¾“å…¥æ•°å­—å’Œå°æ•°ç‚¹
            let value = input.value.replace(/[^\d.]/g, '');
            
            // ç¡®ä¿åªæœ‰ä¸€ä¸ªå°æ•°ç‚¹
            const parts = value.split('.');
            if (parts.length > 2) {
                value = parts[0] + '.' + parts.slice(1).join('');
            }
            
            // æ ¼å¼åŒ–æ˜¾ç¤º
            if (value && !isNaN(parseFloat(value))) {
                const numValue = parseFloat(value);
                input.value = formatNumber(numValue);
            } else if (value === '') {
                input.value = '';
            }
            
            calculateEditRowTotal(rowId);
        }
        
        // è®¡ç®—ç¼–è¾‘å•è¡Œæ€»é‡‘é¢
        function calculateEditRowTotal(rowId) {
            const row = document.getElementById(`editProductRow_${rowId}`);
            if (!row) return;
            
            const inputs = row.querySelectorAll('input');
            const unitPrice = parseFloat(inputs[1].value.replace(/[^\d.]/g, '')) || 0;
            const quantity = parseFloat(inputs[2].value) || 0;
            const rowTotal = unitPrice * quantity;
            
            document.getElementById(`editRowTotal_${rowId}`).textContent = formatCurrency(rowTotal);
            calculateEditTotalAmount();
        }
        
        // è®¡ç®—ç¼–è¾‘æ€»é‡‘é¢
        function calculateEditTotalAmount() {
            const totalElements = document.querySelectorAll('[id^="editRowTotal_"]');
            let total = 0;
            
            totalElements.forEach(element => {
                const amount = parseFloat(element.textContent.replace(/[^\d.]/g, '')) || 0;
                total += amount;
            });
            
            document.getElementById('editTotalProductsAmount').textContent = formatCurrency(total);
            calculateEditCurrentOutstanding();
        }
        
        // è®¡ç®—ç¼–è¾‘æœ¬æ¬¡æ¬ æ¬¾
        function calculateEditCurrentOutstanding() {
            const totalAmountText = document.getElementById('editTotalProductsAmount').textContent;
            const totalAmount = parseFloat(totalAmountText.replace(/[^\d.]/g, '')) || 0;
            const receivedAmountInput = document.getElementById('editReceivedAmount');
            let receivedAmount = parseFloat(receivedAmountInput.value.replace(/[^\d.]/g, '')) || 0;
            const currentOutstanding = Math.max(0, totalAmount - receivedAmount);
            
            const currentOutstandingInput = document.getElementById('editCurrentOutstanding');
            currentOutstandingInput.value = formatNumber(currentOutstanding);
            currentOutstandingInput.placeholder = formatNumber(0);
        }
        
        // æ ¼å¼åŒ–ç¼–è¾‘å®æ”¶æ¬¾è¾“å…¥å¹¶è®¡ç®—
        function formatEditReceivedAmountAndCalculate(input) {
            // åªå…è®¸è¾“å…¥æ•°å­—å’Œå°æ•°ç‚¹
            let value = input.value.replace(/[^\d.]/g, '');
            
            // ç¡®ä¿åªæœ‰ä¸€ä¸ªå°æ•°ç‚¹
            const parts = value.split('.');
            if (parts.length > 2) {
                value = parts[0] + '.' + parts.slice(1).join('');
            }
            
            // æ ¼å¼åŒ–æ˜¾ç¤º
            if (value && !isNaN(parseFloat(value))) {
                const numValue = parseFloat(value);
                input.value = formatNumber(numValue);
            } else if (value === '') {
                input.value = '';
            }
            
            calculateEditCurrentOutstanding();
        }
        
        // è·å–ç¼–è¾‘äº§å“æ•°æ®
        function getEditProductsData() {
            const tbody = document.getElementById('editProductTableBody');
            const rows = tbody.querySelectorAll('tr');
            const products = [];
            
            rows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                const productName = inputs[0].value.trim();
                const unitPrice = parseFloat(inputs[1].value.replace(/[^\d.]/g, '')) || 0;
                const quantity = parseFloat(inputs[2].value) || 0;
                const giftQuantity = parseFloat(inputs[3].value) || 0;
                
                if (productName && (quantity > 0 || giftQuantity > 0)) {
                    products.push({
                        name: productName,
                        unitPrice: unitPrice,
                        quantity: quantity,
                        giftQuantity: giftQuantity,
                        totalAmount: unitPrice * quantity
                    });
                }
            });
            
            return products;
        }
        
        // å…¨å±€å˜é‡ç”¨äºè®°å½•å½“å‰çŠ¶æ€
        let currentSalonId = null;
        let currentTransactionId = null;
        let currentViewingSalonId = null;
        
        // æŸ¥çœ‹å…¨éƒ¨äº¤æ˜“è®°å½•
        function viewAllTransactions(salonId, event) {
            if (event) {
                event.stopPropagation();
            }
            currentViewingSalonId = salonId;
            
            // éšè—æ²™é¾™ä¿¡æ¯é¡µé¢
            document.getElementById('salon-info').classList.remove('active');
            // æ˜¾ç¤ºäº¤æ˜“è®°å½•é¡µé¢
            document.getElementById('transaction-list').classList.add('active');
            
            displayTransactionList(salonId);
            updateTexts(); // æ›´æ–°é¡µé¢æ–‡æœ¬
        }
        
        // æ˜¾ç¤ºäº¤æ˜“è®°å½•åˆ—è¡¨
        function displayTransactionList(salonId) {
            const salons = getSalons();
            const salon = salons.find(s => s.id === salonId);
            if (!salon) return;
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            document.getElementById('transaction-list-title').textContent = `${salon.name} - ${getText('transaction-records')}`;
            
            const transactions = salon.transactions || [];
            const container = document.getElementById('transaction-records');
            
            if (transactions.length === 0) {
                container.innerHTML = `<div style="text-align: center; color: #cccccc; padding: 40px;"><p>${getText('no-transactions-found')}</p></div>`;
                return;
            }
            
            // æŒ‰æ—¥æœŸå€’åºæ’åˆ—
            const sortedTransactions = transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = ``;
            
            sortedTransactions.forEach(transaction => {
                const date = new Date(transaction.date).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
                const totalAmount = transaction.totalAmount || 0;
                const receivedAmount = transaction.receivedAmount || 0;
                const outstandingAmount = transaction.outstandingAmount || (totalAmount - receivedAmount);
                
                // è·å–ä¸šåŠ¡å‘˜åç§°
                const salespersonName = transaction.salesperson || getText('unassigned');
                
                // ç”Ÿæˆäº§å“åˆ—è¡¨æ˜¾ç¤º
                let productsDisplay = '';
                if (transaction.products && Array.isArray(transaction.products)) {
                    const productNames = transaction.products.map(p => p.name).join(', ');
                    productsDisplay = `<p style="margin: 5px 0 0 0; color: white;">${getText('transaction-content')} ${productNames}</p>`;
                } else if (transaction.products && typeof transaction.products === 'string') {
                    // å…¼å®¹æ—§æ•°æ®æ ¼å¼
                    productsDisplay = `<p style="margin: 5px 0 0 0; color: white;">${getText('products')} ${transaction.products}</p>`;
                }
                
                html += `
                    <div onclick="viewTransactionDetail(${salonId}, ${transaction.id})" style="background: rgba(212, 175, 55, 0.1); padding: 15px; border-radius: 5px; margin-bottom: 10px; border: 1px solid rgba(212, 175, 55, 0.3); cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(212, 175, 55, 0.2)'" onmouseout="this.style.background='rgba(212, 175, 55, 0.1)'">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4 style="color: var(--gold-light); margin: 0 0 10px 0;">${transaction.description || getText('transaction-default')}</h4>
                                <p style="margin: 0; color: #cccccc;">${getText('transaction-date')}: ${date}</p>
                                <p style="margin: 5px 0 0 0; color: #aaaaaa; font-size: 0.9em;">${getText('salesperson-label')}ï¼š${salespersonName}</p>
                                ${productsDisplay}
                            </div>
                            <div style="text-align: right;">
                                ${totalAmount > 0 ? `<div style="margin-bottom: 5px;"><span style="color: #90EE90;">${getText('total-products-amount')} ${formatCurrency(totalAmount)}</span></div>` : ''}
                                ${receivedAmount > 0 ? `<div style="margin-bottom: 5px;"><span style="color: #87CEEB;">${getText('received-amount')} ${formatCurrency(receivedAmount)}</span></div>` : ''}
                                ${outstandingAmount > 0 ? `<div><span style="color: #ff6666;">${getText('current-outstanding')} ${formatCurrency(outstandingAmount)}</span></div>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // æŸ¥çœ‹äº¤æ˜“è¯¦æƒ…
        function viewTransactionDetail(salonId, transactionId) {
            currentViewingSalonId = salonId;
            currentTransactionId = transactionId;
            
            // éšè—æ‰€æœ‰å…¶ä»–é¡µé¢
            document.getElementById('salon-info').classList.remove('active');
            document.getElementById('transaction-list').classList.remove('active');
            // æ˜¾ç¤ºäº¤æ˜“è¯¦æƒ…é¡µé¢
            document.getElementById('transaction-detail').classList.add('active');
            
            displayTransactionDetail(salonId, transactionId);
            updateTexts(); // æ›´æ–°é¡µé¢æ–‡æœ¬
        }
        
        // æ˜¾ç¤ºäº¤æ˜“è¯¦æƒ…
        function displayTransactionDetail(salonId, transactionId) {
            const salons = getSalons();
            const salon = salons.find(s => s.id === salonId);
            if (!salon) return;
            
            const transaction = salon.transactions.find(t => t.id === transactionId);
            if (!transaction) return;
            
            const date = new Date(transaction.date).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
            const totalAmount = transaction.totalAmount || 0;
            const receivedAmount = transaction.receivedAmount || 0;
            const currentOutstanding = transaction.outstandingAmount || (totalAmount - receivedAmount);
            
            // è·å–ä¸šåŠ¡å‘˜å®Œæ•´ä¿¡æ¯
            const employees = getEmployees();
            let salespersonInfo = {
                name: transaction.salesperson || getText('unassigned'),
                mobile: ''
            };
            
            if (transaction.salespersonId) {
                const employee = employees.find(emp => emp.id == transaction.salespersonId);
                if (employee) {
                    salespersonInfo.name = employee.name;
                    salespersonInfo.mobile = employee.mobile;
                }
            }
            
            // ä»£ç†åº—åç§°
            const agentStoreName = 'ë©”ì‹œì•„ì„œë¶€ì§€ì ';
            
            // è®¡ç®—å†å²æ€»æ¬ æ¬¾
            const historicalOutstanding = calculateTotalOutstanding(salonId) - currentOutstanding;
            const totalOutstanding = calculateTotalOutstanding(salonId);
            
            // ç”Ÿæˆäº§å“è¡¨æ ¼
            let productsTable = '';
            if (transaction.products && Array.isArray(transaction.products)) {
                productsTable = `
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: var(--gold-light); margin-bottom: 10px;">${getText('transaction-content')}</h4>
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid var(--gold);">
                            <thead style="background: rgba(212, 175, 55, 0.2);">
                                <tr>
                                    <th style="padding: 8px; border: 1px solid var(--gold); color: var(--gold); text-align: left;">${getText('product-name')}</th>
                                    <th style="padding: 8px; border: 1px solid var(--gold); color: var(--gold); text-align: center;">${getText('unit-price')}</th>
                                    <th style="padding: 8px; border: 1px solid var(--gold); color: var(--gold); text-align: center;">${getText('quantity')}</th>
                                    <th style="padding: 8px; border: 1px solid var(--gold); color: var(--gold); text-align: center;">${getText('gift-quantity')}</th>
                                    <th style="padding: 8px; border: 1px solid var(--gold); color: var(--gold); text-align: center;">${getText('total-amount')}</th>
                                </tr>
                            </thead>
                            <tbody>`;
                
                transaction.products.forEach(product => {
                    productsTable += `
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(212, 175, 55, 0.3); color: white;">${product.name}</td>
                            <td style="padding: 8px; border: 1px solid rgba(212, 175, 55, 0.3); color: white; text-align: center;">${formatCurrency(product.unitPrice)}</td>
                            <td style="padding: 8px; border: 1px solid rgba(212, 175, 55, 0.3); color: white; text-align: center;">${product.quantity || 0}</td>
                            <td style="padding: 8px; border: 1px solid rgba(212, 175, 55, 0.3); color: white; text-align: center;">${product.giftQuantity || 0}</td>
                            <td style="padding: 8px; border: 1px solid rgba(212, 175, 55, 0.3); color: white; text-align: center;">${formatCurrency(product.totalAmount)}</td>
                        </tr>`;
                });
                
                productsTable += `
                            </tbody>
                            <tfoot style="background: rgba(212, 175, 55, 0.1);">
                                <tr>
                                    <td colspan="4" style="padding: 8px; border: 1px solid var(--gold); color: var(--gold); text-align: right; font-weight: bold;">${getText('total-products-amount')}</td>
                                    <td style="padding: 8px; border: 1px solid var(--gold); color: var(--gold); text-align: center; font-weight: bold;">${formatCurrency(totalAmount)}</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>`;
            } else if (transaction.products && typeof transaction.products === 'string') {
                // å…¼å®¹æ—§æ•°æ®æ ¼å¼
                productsTable = `
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: var(--gold-light); margin-bottom: 10px;">${getText('products')}</h4>
                        <p style="color: white; padding: 10px; background: rgba(212, 175, 55, 0.1); border-radius: 5px;">${transaction.products}</p>
                    </div>`;
            }
            
            const container = document.getElementById('transaction-detail-content');
            
            container.innerHTML = `
                <div style="background: rgba(212, 175, 55, 0.1); padding: 25px; border-radius: 10px; border: 1px solid rgba(212, 175, 55, 0.3);">
                    <div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid var(--gold); padding-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div style="flex: 1;"></div>
                            <div style="flex: 1; text-align: center;">
                                <h2 style="color: var(--gold); margin: 0;">${getText('print-transaction-title')}</h2>
                                <p style="color: #cccccc; margin: 10px 0 0 0;">${salon.name} - ${date}</p>
                            </div>
                            <div style="flex: 1; text-align: right;">
                                ${currentUser && currentUser.position === 'admin' ? `
                                    <button onclick="showEditTransactionModal()" style="background: #4CAF50; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9em; margin-right: 10px;">${getText('edit-transaction')}</button>
                                    <button onclick="confirmDeleteTransaction()" style="background: #ff6666; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9em;">${getText('delete-transaction')}</button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 25px;">
                        <div>
                            <h3 style="color: var(--gold-light); margin-bottom: 15px;">${getText('salon-info')}</h3>
                            <p><strong>${getText('salon-name')}:</strong> ${salon.name}</p>
                            <p><strong>${getText('salon-address')}:</strong> ${salon.address}</p>
                            <p><strong>${getText('director-name-text')}:</strong> ${salon.directorName}</p>
                            <p><strong>${getText('director-mobile-text')}:</strong> ${formatMobile(salon.directorMobile)}</p>
                        </div>
                        
                        <div>
                            <h3 style="color: var(--gold-light); margin-bottom: 15px;">${getText('transaction-detail')}</h3>
                            <p><strong>${getText('transaction-date')}:</strong> ${date}</p>

                            <p><strong>${getText('salesperson-name').replace('ï¼š', '')}:</strong> ${salespersonInfo.name}</p>
                            ${salespersonInfo.mobile ? `<p><strong>${getText('salesperson-mobile')}:</strong> ${formatMobile(salespersonInfo.mobile)}</p>` : ''}
                            <p><strong>${getText('agent-store-name')}:</strong> ${agentStoreName}</p>
                            ${transaction.notes ? `<p><strong>${getText('notes')}</strong> ${transaction.notes}</p>` : ''}
                        </div>
                    </div>
                    
                    ${productsTable}
                    
                    <div style="border: 2px solid var(--gold); border-radius: 8px; padding: 20px; background: rgba(0,0,0,0.2);">
                        <h3 style="color: var(--gold-light); margin-bottom: 20px; text-align: center;">${getText('transaction-amount-label')}</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; text-align: center;">
                            <div>
                                <div style="font-size: 0.9em; color: #cccccc; margin-bottom: 5px;">${getText('total-products-amount')}</div>
                                <div style="font-size: 1.3em; color: #90EE90; font-weight: bold;">${formatCurrency(totalAmount)}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.9em; color: #cccccc; margin-bottom: 5px;">${getText('received-amount')}</div>
                                <div style="font-size: 1.3em; color: #87CEEB; font-weight: bold;">${formatCurrency(receivedAmount)}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.9em; color: #cccccc; margin-bottom: 5px;">${getText('historical-outstanding')}</div>
                                <div style="font-size: 1.3em; color: #ffaa66; font-weight: bold;">${formatCurrency(historicalOutstanding)}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.9em; color: #cccccc; margin-bottom: 5px;">${getText('total-outstanding')}</div>
                                <div style="font-size: 1.3em; color: ${totalOutstanding > 0 ? '#ff6666' : '#90EE90'}; font-weight: bold;">${formatCurrency(totalOutstanding)}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // è¿”å›å¯¼èˆªåŠŸèƒ½
        function backToSalonInfo() {
            document.getElementById('transaction-list').classList.remove('active');
            document.getElementById('salon-info').classList.add('active');
        }
        
        function backToTransactionList() {
            document.getElementById('transaction-detail').classList.remove('active');
            document.getElementById('transaction-list').classList.add('active');
            // é‡æ–°æ˜¾ç¤ºäº¤æ˜“åˆ—è¡¨
            if (currentViewingSalonId) {
                displayTransactionList(currentViewingSalonId);
            }
        }
        
        // æ—¥æœŸç­›é€‰åŠŸèƒ½
        function filterTransactions() {
            const startDate = document.getElementById('start-date').value;
            const endDate = document.getElementById('end-date').value;
            
            if (!startDate || !endDate) {
                alert(getText('select-start-end-date'));
                return;
            }
            
            const salons = getSalons();
            const salon = salons.find(s => s.id === currentViewingSalonId);
            if (!salon) return;
            
            const transactions = salon.transactions || [];
            const filteredTransactions = transactions.filter(transaction => {
                const transactionDate = new Date(transaction.date).toISOString().split('T')[0];
                return transactionDate >= startDate && transactionDate <= endDate;
            });
            
            // æ›´æ–°æ˜¾ç¤º
            const container = document.getElementById('transaction-records');
            
            if (filteredTransactions.length === 0) {
                container.innerHTML = `<div style="text-align: center; color: #cccccc; padding: 40px;"><p>${getText('no-transactions-found')}</p></div>`;
                return;
            }
            
            // æŒ‰æ—¥æœŸå€’åºæ’åˆ—
            const sortedTransactions = filteredTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = ``;
            
            sortedTransactions.forEach(transaction => {
                const date = new Date(transaction.date).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
                const totalAmount = transaction.totalAmount || 0;
                const receivedAmount = transaction.receivedAmount || 0;
                const outstandingAmount = transaction.outstandingAmount || (totalAmount - receivedAmount);
                
                // è·å–ä¸šåŠ¡å‘˜åç§°
                const salespersonName = transaction.salesperson || getText('unassigned');
                
                // ç”Ÿæˆäº§å“åˆ—è¡¨æ˜¾ç¤º
                let productsDisplay = '';
                if (transaction.products && Array.isArray(transaction.products)) {
                    const productNames = transaction.products.map(p => p.name).join(', ');
                    productsDisplay = `<p style="margin: 5px 0 0 0; color: white;">${getText('transaction-content')} ${productNames}</p>`;
                } else if (transaction.products && typeof transaction.products === 'string') {
                    // å…¼å®¹æ—§æ•°æ®æ ¼å¼
                    productsDisplay = `<p style="margin: 5px 0 0 0; color: white;">${getText('products')} ${transaction.products}</p>`;
                }
                
                html += `
                    <div onclick="viewTransactionDetail(${currentViewingSalonId}, ${transaction.id})" style="background: rgba(212, 175, 55, 0.1); padding: 15px; border-radius: 5px; margin-bottom: 10px; border: 1px solid rgba(212, 175, 55, 0.3); cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(212, 175, 55, 0.2)'" onmouseout="this.style.background='rgba(212, 175, 55, 0.1)'">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h4 style="color: var(--gold-light); margin: 0 0 10px 0;">${transaction.description || getText('transaction-default')}</h4>
                                <p style="margin: 0; color: #cccccc;">${getText('transaction-date')}: ${date}</p>
                                <p style="margin: 5px 0 0 0; color: #aaaaaa; font-size: 0.9em;">${getText('salesperson-label')}ï¼š${salespersonName}</p>
                                ${productsDisplay}
                            </div>
                            <div style="text-align: right;">
                                ${totalAmount > 0 ? `<div style="margin-bottom: 5px;"><span style="color: #90EE90;">${getText('total-products-amount')} ${formatCurrency(totalAmount)}</span></div>` : ''}
                                ${receivedAmount > 0 ? `<div style="margin-bottom: 5px;"><span style="color: #87CEEB;">${getText('received-amount')} ${formatCurrency(receivedAmount)}</span></div>` : ''}
                                ${outstandingAmount > 0 ? `<div><span style="color: #ff6666;">${getText('current-outstanding')} ${formatCurrency(outstandingAmount)}</span></div>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // æ¸…ç©ºæ—¥æœŸç­›é€‰
        function clearDateFilter() {
            document.getElementById('start-date').value = '';
            document.getElementById('end-date').value = '';
            displayTransactionList(currentViewingSalonId);
        }
        
        // æ‰“å°åŠŸèƒ½
        function printTransaction() {
            const salons = getSalons();
            const salon = salons.find(s => s.id === currentViewingSalonId);
            if (!salon) return;
            
            const transaction = salon.transactions.find(t => t.id === currentTransactionId);
            if (!transaction) return;
            
            const date = new Date(transaction.date).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
            const totalAmount = transaction.totalAmount || 0;
            const receivedAmount = transaction.receivedAmount || 0;
            const currentOutstanding = transaction.outstandingAmount || (totalAmount - receivedAmount);
            
            // è®¡ç®—å†å²æ€»æ¬ æ¬¾
            const historicalOutstanding = calculateTotalOutstanding(currentViewingSalonId) - currentOutstanding;
            const totalOutstanding = calculateTotalOutstanding(currentViewingSalonId);
            
            // ç”Ÿæˆäº§å“è¡¨æ ¼
            let productsTableHTML = '';
            if (transaction.products && Array.isArray(transaction.products)) {
                productsTableHTML = `
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid #000; margin: 5px 0;">
                        <thead>
                            <tr style="background: #f0f0f0;">
                                <th style="padding: 4px; border: 1px solid #000; text-align: left; font-weight: bold; font-size: 10px;">${getText('product-name')}</th>
                                <th style="padding: 4px; border: 1px solid #000; text-align: center; font-weight: bold; font-size: 10px;">${getText('unit-price')}</th>
                                <th style="padding: 4px; border: 1px solid #000; text-align: center; font-weight: bold; font-size: 10px;">${getText('quantity')}</th>
                                <th style="padding: 4px; border: 1px solid #000; text-align: center; font-weight: bold; font-size: 10px;">${getText('total-amount')}</th>
                            </tr>
                        </thead>
                        <tbody>`;
                
                transaction.products.forEach(product => {
                    productsTableHTML += `
                        <tr>
                            <td style="padding: 3px; border: 1px solid #000; font-size: 9px;">${product.name}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-size: 9px;">${formatCurrency(product.unitPrice)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-size: 9px;">${product.quantity}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-size: 9px;">${formatCurrency(product.totalAmount)}</td>
                        </tr>`;
                });
                
                productsTableHTML += `
                        </tbody>
                        <tfoot>
                            <tr style="background: #f0f0f0; font-weight: bold;">
                                <td colspan="3" style="padding: 4px; border: 1px solid #000; text-align: right; font-size: 10px;">${getText('total-products-amount')}</td>
                                <td style="padding: 4px; border: 1px solid #000; text-align: center; font-size: 10px;">${formatCurrency(totalAmount)}</td>
                            </tr>
                        </tfoot>
                    </table>`;
            }
            
            // ç”Ÿæˆå•ä»½å†…å®¹ï¼ˆå‹ç¼©ç‰ˆï¼Œé€‚åˆA4çº¸ä¸€é¡µä¸¤ä»½ï¼‰
            function generateSingleCopyContent(copyType) {
                return `
                    <div style="width: 100%; padding: 10px; box-sizing: border-box; page-break-inside: avoid; margin-bottom: 10px;">
                        <div style="text-align: center; margin-bottom: 10px; border: 2px solid #000; padding: 8px;">
                            <h2 style="margin: 0; font-size: 16px; font-weight: bold;">${getText('print-transaction-title')}</h2>
                            <div style="margin: 5px 0; font-size: 12px; font-weight: bold; background: #f0f0f0; padding: 3px; border: 1px solid #000;">
                                ${copyType}
                            </div>
                            <p style="margin: 3px 0; font-size: 11px;">${salon.name} - ${date}</p>
                            ${transaction.salesperson ? `<p style="margin: 2px 0; font-size: 10px;">${getText('salesperson-name')} ${transaction.salesperson}</p>` : ''}
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 10px;">
                            <div style="width: 48%;">
                                <h3 style="margin: 0 0 5px 0; font-size: 12px; border-bottom: 1px solid #000; padding-bottom: 2px;">${getText('salon-info')}</h3>
                                <p style="margin: 2px 0;"><strong>${getText('salon-name')}:</strong> ${salon.name}</p>
                                <p style="margin: 2px 0;"><strong>${getText('salon-address')}:</strong> ${salon.address}</p>
                                <p style="margin: 2px 0;"><strong>${getText('director-name-text')}:</strong> ${salon.directorName}</p>
                                <p style="margin: 2px 0;"><strong>${getText('director-mobile-text')}:</strong> ${formatMobile(salon.directorMobile)}</p>
                            </div>
                            
                            <div style="width: 48%;">
                                <h3 style="margin: 0 0 5px 0; font-size: 12px; border-bottom: 1px solid #000; padding-bottom: 2px;">${getText('transaction-detail')}</h3>
                                <p style="margin: 2px 0;"><strong>${getText('transaction-date')}:</strong> ${date}</p>
                                ${transaction.salesperson ? `<p style="margin: 2px 0;"><strong>${getText('salesperson-name').replace('ï¼š', '')}:</strong> ${transaction.salesperson}</p>` : ''}
                                ${transaction.salesperson ? `<p style="margin: 2px 0;"><strong>ì—…ë¬´ì› ì—°ë½ì²˜:</strong> ${getSalespersonMobile(transaction.salespersonId)}</p>` : ''}
                                <p style="margin: 2px 0;"><strong>ëŒ€ë¦¬ì ëª…:</strong> ë©”ì‹œì•„ì„œë¶€ì§€ì </p>
                                ${transaction.notes ? `<p style="margin: 2px 0;"><strong>${getText('notes')}:</strong> ${transaction.notes}</p>` : ''}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 8px;">
                            <h3 style="margin: 0 0 5px 0; font-size: 12px; border-bottom: 1px solid #000; padding-bottom: 2px;">${getText('transaction-content')}</h3>
                            ${productsTableHTML}
                        </div>
                        
                        <div style="border: 2px solid #000; padding: 8px; background: #f9f9f9;">
                            <h3 style="margin: 0 0 8px 0; font-size: 12px; text-align: center;">${getText('transaction-amount-label')}</h3>
                            <div style="display: flex; justify-content: space-between;">
                                <div style="text-align: center; width: 24%;">
                                    <div style="font-size: 9px; margin-bottom: 2px; color: #666;">${getText('total-products-amount')}</div>
                                    <div style="font-size: 12px; font-weight: bold; color: #008000;">${formatCurrency(totalAmount)}</div>
                                </div>
                                <div style="text-align: center; width: 24%;">
                                    <div style="font-size: 9px; margin-bottom: 2px; color: #666;">${getText('received-amount')}</div>
                                    <div style="font-size: 12px; font-weight: bold; color: #0066cc;">${formatCurrency(receivedAmount)}</div>
                                </div>
                                <div style="text-align: center; width: 24%;">
                                    <div style="font-size: 9px; margin-bottom: 2px; color: #666;">${getText('historical-outstanding')}</div>
                                    <div style="font-size: 12px; font-weight: bold; color: #ff8800;">${formatCurrency(historicalOutstanding)}</div>
                                </div>
                                <div style="text-align: center; width: 24%;">
                                    <div style="font-size: 9px; margin-bottom: 2px; color: #666;">${getText('total-outstanding')}</div>
                                    <div style="font-size: 14px; font-weight: bold; color: ${totalOutstanding > 0 ? '#cc0000' : '#008000'}; border: 2px solid ${totalOutstanding > 0 ? '#cc0000' : '#008000'}; padding: 3px;">${formatCurrency(totalOutstanding)}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            const printWindow = window.open('', '_blank');
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>${getText('print-transaction-title')}</title>
                    <style>
                        @page {
                            size: A4;
                            margin: 10mm;
                        }
                        
                        body {
                            font-family: 'Microsoft YaHei', 'SimSun', Arial, sans-serif;
                            margin: 0;
                            padding: 0;
                            color: #000;
                            background: #fff;
                            font-size: 12px;
                            line-height: 1.3;
                        }
                        
                        h2, h3 {
                            color: #000;
                        }
                        
                        p {
                            margin: 5px 0;
                            line-height: 1.4;
                        }
                        
                        strong {
                            font-weight: bold;
                        }
                        
                        table {
                            border-collapse: collapse;
                            width: 100%;
                        }
                        
                        th, td {
                            border: 1px solid #000;
                            padding: 6px;
                            text-align: left;
                        }
                        
                        th {
                            background: #f0f0f0;
                            font-weight: bold;
                            text-align: center;
                        }
                        
                        .copy-separator {
                            height: 15px;
                            border-bottom: 2px dashed #000;
                            margin: 10px 0;
                            position: relative;
                        }
                        
                        .copy-separator::after {
                            content: "âœ‚";
                            position: absolute;
                            right: 10px;
                            top: -8px;
                            background: white;
                            padding: 0 3px;
                            font-size: 14px;
                        }
                        
                        @media print {
                            body {
                                margin: 0;
                                padding: 0;
                            }
                            
                            .copy-separator {
                                page-break-inside: avoid;
                            }
                        }
                    </style>
                </head>
                <body>
                    ${generateSingleCopyContent(getText('copy-for-director'))}
                    
                    <div class="copy-separator"></div>
                    
                    ${generateSingleCopyContent(getText('copy-for-agent'))}
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 1000);
        }
        
        // äº§å“è¡¨æ ¼ç®¡ç†
        let productRowCounter = 0;
        
        // æ·»åŠ äº§å“è¡Œ
        function addProductRow() {
            productRowCounter++;
            const tbody = document.getElementById('productTableBody');
            const row = document.createElement('tr');
            row.id = `productRow_${productRowCounter}`;
            row.innerHTML = `
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3);">
                    <input type="text" placeholder="äº§å“åç§°" oninput="checkProductHistory(this)" style="width: 100%; padding: 5px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.5); color: var(--text-light); border-radius: 3px; box-sizing: border-box;">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3);">
                    <input type="text" placeholder="1,000" oninput="formatInputAndCalculate(this, ${productRowCounter})" style="width: 100%; padding: 5px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.5); color: var(--text-light); border-radius: 3px; box-sizing: border-box; text-align: center;">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3);">
                    <input type="number" placeholder="1" min="0" max="99" oninput="calculateRowTotal(${productRowCounter})" style="width: 100%; padding: 5px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.5); color: var(--text-light); border-radius: 3px; box-sizing: border-box; text-align: center;">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3);">
                    <input type="number" placeholder="0" min="0" style="width: 100%; padding: 5px; background: transparent; border: 1px solid rgba(212, 175, 55, 0.5); color: var(--text-light); border-radius: 3px; box-sizing: border-box; text-align: center;">
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3); text-align: center; color: var(--gold);" id="rowTotal_${productRowCounter}">
                    â‚©0
                </td>
                <td style="padding: 8px; border-bottom: 1px solid rgba(212, 175, 55, 0.3); text-align: center;">
                    <button type="button" onclick="removeProductRow(${productRowCounter})" style="background: #ff6666; color: white; border: none; padding: 3px 8px; border-radius: 3px; cursor: pointer; font-size: 0.8em;" data-i18n="remove">åˆ é™¤</button>
                </td>
            `;
            tbody.appendChild(row);
            updateTexts(); // æ›´æ–°ç¿»è¯‘
            calculateTotalAmount();
        }
        
        // åˆ é™¤äº§å“è¡Œ
        function removeProductRow(rowId) {
            const row = document.getElementById(`productRow_${rowId}`);
            if (row) {
                row.remove();
                calculateTotalAmount();
            }
        }
        
        // æ ¼å¼åŒ–è¾“å…¥å¹¶è®¡ç®—
        function formatInputAndCalculate(input, rowId) {
            // åªå…è®¸è¾“å…¥æ•°å­—å’Œå°æ•°ç‚¹
            let value = input.value.replace(/[^\d.]/g, '');
            
            // ç¡®ä¿åªæœ‰ä¸€ä¸ªå°æ•°ç‚¹
            const parts = value.split('.');
            if (parts.length > 2) {
                value = parts[0] + '.' + parts.slice(1).join('');
            }
            
            // æ ¼å¼åŒ–æ˜¾ç¤º
            if (value && !isNaN(parseFloat(value))) {
                const numValue = parseFloat(value);
                input.value = formatNumber(numValue);
            } else if (value === '') {
                input.value = '';
            }
            
            calculateRowTotal(rowId);
        }
        
        // è®¡ç®—å•è¡Œæ€»é‡‘é¢ï¼ˆä¸åŒ…æ‹¬èµ é€æ•°é‡ï¼‰
        function calculateRowTotal(rowId) {
            const row = document.getElementById(`productRow_${rowId}`);
            if (!row) return;
            
            const inputs = row.querySelectorAll('input');
            const unitPrice = parseFloat(inputs[1].value.replace(/[^\d.]/g, '')) || 0;
            const quantity = parseFloat(inputs[2].value) || 0;  // åªè®¡ç®—å‡ºåº“æ•°é‡ï¼Œä¸åŒ…æ‹¬èµ é€
            const rowTotal = unitPrice * quantity;
            
            document.getElementById(`rowTotal_${rowId}`).textContent = formatCurrency(rowTotal);
            calculateTotalAmount();
        }
        
        // è®¡ç®—æ€»é‡‘é¢
        function calculateTotalAmount() {
            const totalElements = document.querySelectorAll('[id^="rowTotal_"]');
            let total = 0;
            
            totalElements.forEach(element => {
                const amount = parseFloat(element.textContent.replace(/[^\d.]/g, '')) || 0;
                total += amount;
            });
            
            document.getElementById('totalProductsAmount').textContent = formatCurrency(total);
            calculateCurrentOutstanding();
        }
        
        // è®¡ç®—æœ¬æ¬¡æ¬ æ¬¾
        function calculateCurrentOutstanding() {
            const totalAmountText = document.getElementById('totalProductsAmount').textContent;
            const totalAmount = parseFloat(totalAmountText.replace(/[^\d.]/g, '')) || 0;
            const receivedAmountInput = document.getElementById('receivedAmount');
            let receivedAmount = parseFloat(receivedAmountInput.value.replace(/[^\d.]/g, '')) || 0;
            const currentOutstanding = Math.max(0, totalAmount - receivedAmount);
            
            const currentOutstandingInput = document.getElementById('currentOutstanding');
            currentOutstandingInput.value = formatNumber(currentOutstanding);
            currentOutstandingInput.placeholder = formatNumber(0);
        }
        
        // æ ¼å¼åŒ–å®æ”¶æ¬¾è¾“å…¥å¹¶è®¡ç®—
        function formatReceivedAmountAndCalculate(input) {
            // åªå…è®¸è¾“å…¥æ•°å­—å’Œå°æ•°ç‚¹
            let value = input.value.replace(/[^\d.]/g, '');
            
            // ç¡®ä¿åªæœ‰ä¸€ä¸ªå°æ•°ç‚¹
            const parts = value.split('.');
            if (parts.length > 2) {
                value = parts[0] + '.' + parts.slice(1).join('');
            }
            
            // æ ¼å¼åŒ–æ˜¾ç¤º
            if (value && !isNaN(parseFloat(value))) {
                const numValue = parseFloat(value);
                input.value = formatNumber(numValue);
            } else if (value === '') {
                input.value = '';
            }
            
            calculateCurrentOutstanding();
        }
        
        // è·å–äº§å“åˆ—è¡¨æ•°æ®
        function getProductsData() {
            const tbody = document.getElementById('productTableBody');
            const rows = tbody.querySelectorAll('tr');
            const products = [];
            
            rows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                const productName = inputs[0].value.trim();
                const unitPrice = parseFloat(inputs[1].value.replace(/[^\d.]/g, '')) || 0;
                const quantity = parseFloat(inputs[2].value) || 0;
                const giftQuantity = parseFloat(inputs[3].value) || 0;
                
                if (productName && (quantity > 0 || giftQuantity > 0)) {
                    products.push({
                        name: productName,
                        unitPrice: unitPrice,
                        quantity: quantity,
                        giftQuantity: giftQuantity,
                        totalAmount: unitPrice * quantity  // åªè®¡ç®—é”€å”®æ•°é‡ï¼Œä¸åŒ…æ‹¬èµ é€
                    });
                }
            });
            
            return products;
        }
        
        // è®¡ç®—æ²™é¾™çš„å†å²æ€»æ¬ æ¬¾
        function calculateTotalOutstanding(salonId) {
            const salons = getSalons();
            const salon = salons.find(s => s.id === salonId);
            if (!salon || !salon.transactions) return 0;
            
            let totalOutstanding = 0;
            salon.transactions.forEach(transaction => {
                const products = transaction.products || [];
                let transactionTotal = 0;
                products.forEach(product => {
                    transactionTotal += product.totalAmount || 0;
                });
                
                const receivedAmount = transaction.receivedAmount || 0;
                const transactionOutstanding = transactionTotal - receivedAmount;
                totalOutstanding += transactionOutstanding;
            });
            
            return totalOutstanding;
        }
        
        // å¤„ç†äº¤æ˜“è®°å½•è¡¨å•æäº¤
        document.addEventListener('DOMContentLoaded', async function() {
            // åˆå§‹åŒ–ç³»ç»Ÿï¼Œåˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·
            await initializeSystem();
            
            // é¡µé¢åŠ è½½æ—¶æ·»åŠ ä¸€è¡Œäº§å“
            addProductRow();
            
            document.getElementById('transactionForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const salespersonId = document.getElementById('salespersonSelect').value;
                const products = getProductsData();
                const receivedAmount = parseFloat(document.getElementById('receivedAmount').value.replace(/[^\d.]/g, '')) || 0;
                const currentOutstanding = parseFloat(document.getElementById('currentOutstanding').value.replace(/[^\d.]/g, '')) || 0;
                const notes = document.getElementById('transactionNotes').value.trim();
                
                if (!salespersonId) {
                    alert(translations[currentLanguage]['please-select-salesperson']);
                    return;
                }
                
                if (products.length === 0) {
                    alert(translations[currentLanguage]['add-at-least-one-product']);
                    return;
                }
                
                // è·å–ä¸šåŠ¡å‘˜ä¿¡æ¯
                const employees = getEmployees();
                const selectedEmployee = employees.find(emp => emp.id == salespersonId);
                
                // è®¡ç®—äº§å“æ€»é‡‘é¢
                let totalProductsAmount = 0;
                products.forEach(product => {
                    totalProductsAmount += product.totalAmount;
                });
                
                if (currentSalonId) {
                    const transaction = {
                        id: Date.now(),
                        date: new Date().toISOString(),
                        salesperson: selectedEmployee ? selectedEmployee.name : '',
                        salespersonId: selectedEmployee ? selectedEmployee.id : null,
                        products: products,
                        totalAmount: totalProductsAmount,
                        receivedAmount: receivedAmount,
                        outstandingAmount: currentOutstanding,
                        notes: notes
                    };
                    
                    addTransaction(currentSalonId, transaction);
                    
                    // æ¸…ç©ºè¡¨å•
                    document.getElementById('transactionForm').reset();
                    // æ¸…ç©ºäº§å“è¡¨æ ¼
                    document.getElementById('productTableBody').innerHTML = '';
                    productRowCounter = 0;
                    addProductRow(); // é‡æ–°æ·»åŠ ä¸€è¡Œ
                    updateSalespersonOptions(); // é‡æ–°åŠ è½½ä¸šåŠ¡å‘˜é€‰é¡¹
                    
                    // éšè—äº§å“å†å²è®°å½•åŒºåŸŸ
                    const historySection = document.getElementById('product-history-section');
                    if (historySection) {
                        historySection.style.display = 'none';
                    }
                    
                    displaySalonList(currentFilter, currentPage); // ä¿æŒå½“å‰ç­›é€‰å’Œé¡µé¢
                    closeTransactionModal();
                    alert(getText('transaction-added-success'));
                    
                    // è·³è½¬åˆ°å†å²äº¤æ˜“è®°å½•é¡µé¢
                    viewAllTransactions(currentSalonId);
                }
            });
            
            // äº¤æ˜“æ¨¡æ€æ¡†ä¸å…è®¸ç‚¹å‡»å¤–éƒ¨å…³é—­ï¼Œåªèƒ½é€šè¿‡æŒ‰é’®å…³é—­
            // document.getElementById('transactionModal').addEventListener('click', function(e) {
            //     if (e.target === this) {
            //         closeTransactionModal();
            //     }
            // });
            
            // ç¼–è¾‘äº¤æ˜“è®°å½•è¡¨å•æäº¤å¤„ç†
            document.getElementById('editTransactionForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const salespersonId = document.getElementById('editSalespersonSelect').value;
                const products = getEditProductsData();
                const receivedAmount = parseFloat(document.getElementById('editReceivedAmount').value.replace(/[^\d.]/g, '')) || 0;
                const currentOutstanding = parseFloat(document.getElementById('editCurrentOutstanding').value.replace(/[^\d.]/g, '')) || 0;
                const notes = document.getElementById('editTransactionNotes').value.trim();
                
                if (!salespersonId) {
                    alert(translations[currentLanguage]['please-select-salesperson']);
                    return;
                }
                
                if (products.length === 0) {
                    alert(translations[currentLanguage]['add-at-least-one-product']);
                    return;
                }
                
                // è·å–ä¸šåŠ¡å‘˜ä¿¡æ¯
                const employees = getEmployees();
                const selectedEmployee = employees.find(emp => emp.id == salespersonId);
                
                // è®¡ç®—äº§å“æ€»é‡‘é¢
                let totalProductsAmount = 0;
                products.forEach(product => {
                    totalProductsAmount += product.totalAmount;
                });
                
                // æ›´æ–°äº¤æ˜“è®°å½•
                const updatedTransaction = {
                    id: currentTransactionId,
                    date: new Date().toISOString(), // æ›´æ–°æ—¶é—´
                    salesperson: selectedEmployee ? selectedEmployee.name : '',
                    salespersonId: selectedEmployee ? selectedEmployee.id : null,
                    products: products,
                    totalAmount: totalProductsAmount,
                    receivedAmount: receivedAmount,
                    outstandingAmount: currentOutstanding,
                    notes: notes
                };
                
                updateTransaction(currentViewingSalonId, updatedTransaction);
                
                closeEditTransactionModal();
                displayTransactionDetail(currentViewingSalonId, currentTransactionId); // åˆ·æ–°è¯¦æƒ…é¡µé¢
                displaySalonList(currentFilter, currentPage); // ä¿æŒå½“å‰ç­›é€‰å’Œé¡µé¢
                alert(getText('transaction-updated-success'));
            });
            
            // ç¼–è¾‘äº¤æ˜“æ¨¡æ€æ¡†ä¸å…è®¸ç‚¹å‡»å¤–éƒ¨å…³é—­ï¼Œåªèƒ½é€šè¿‡æŒ‰é’®å…³é—­
            // document.getElementById('editTransactionModal').addEventListener('click', function(e) {
            //     if (e.target === this) {
            //         closeEditTransactionModal();
            //     }
            // });
        });
        
        // æ˜¾ç¤ºå­èœå•ï¼ˆæ”¯æŒå±•å¼€/æ”¶èµ·åˆ‡æ¢ï¼‰
        function showSubmenu(menuType) {
            const targetSubmenu = document.getElementById(menuType + '-submenu');
            
            if (targetSubmenu) {
                // å¦‚æœå½“å‰å­èœå•å·²ç»å±•å¼€ï¼Œåˆ™æ”¶èµ·å®ƒ
                if (targetSubmenu.classList.contains('active')) {
                    targetSubmenu.classList.remove('active');
                } else {
                    // å…ˆéšè—æ‰€æœ‰å…¶ä»–å­èœå•
                    const allSubmenus = document.querySelectorAll('.submenu');
                    allSubmenus.forEach(submenu => {
                        submenu.classList.remove('active');
                    });
                    
                    // æ˜¾ç¤ºç‚¹å‡»çš„å­èœå•
                    targetSubmenu.classList.add('active');
                }
            }
        }
        
        // æ›´æ–°è´Ÿè´£èŒå‘˜é€‰é¡¹
        async function updateResponsibleEmployeeOptions() {
            const selectElement = document.getElementById('responsibleEmployee');
            if (!selectElement) return;
            
            const employees = await getEmployees();
            let optionsHtml = `<option value="">${getText('please-select-employee')}</option>`;
            optionsHtml += `<option value="unassigned">${getText('unassigned')}</option>`;
            
            if (currentUser) {
                if (currentUser.position === 'admin') {
                    // ç®¡ç†å‘˜å¯ä»¥é€‰æ‹©æ‰€æœ‰äºº
                    employees.forEach(employee => {
                        const positionText = getPositionText(employee.position);
                        optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                    });
                } else if (currentUser.position === 'manager') {
                    // ç»ç†å¯ä»¥é€‰æ‹©ä¸šåŠ¡å‘˜
                    employees.forEach(employee => {
                        if (employee.position === 'salesperson') {
                            const positionText = getPositionText(employee.position);
                            optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                        }
                    });
                } else if (currentUser.position === 'salesperson') {
                    // ä¸šåŠ¡å‘˜åªèƒ½é€‰æ‹©è‡ªå·±ï¼Œå¹¶ä¸”é»˜è®¤é€‰ä¸­
                    const positionText = getPositionText(currentUser.position);
                    optionsHtml = `<option value="">${getText('please-select-employee')}</option>`;
                    optionsHtml += `<option value="unassigned">${getText('unassigned')}</option>`;
                    optionsHtml += `<option value="${currentUser.id}" selected>${currentUser.name} - ${positionText}</option>`;
                }
            }
            
            selectElement.innerHTML = optionsHtml;
        }
        
        // æ›´æ–°ç¼–è¾‘æ²™é¾™çš„è´Ÿè´£èŒå‘˜é€‰é¡¹
        async function updateEditResponsibleEmployeeOptions() {
            const selectElement = document.getElementById('editResponsibleEmployee');
            if (!selectElement) return;
            
            const employees = await getEmployees();
            let optionsHtml = `<option value="">${getText('please-select-employee')}</option>`;
            optionsHtml += `<option value="unassigned">${getText('unassigned')}</option>`;
            
            if (currentUser) {
                if (currentUser.position === 'admin') {
                    // ç®¡ç†å‘˜å¯ä»¥é€‰æ‹©æ‰€æœ‰äºº
                    employees.forEach(employee => {
                        const positionText = getPositionText(employee.position);
                        optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                    });
                } else if (currentUser.position === 'manager') {
                    // ç»ç†å¯ä»¥é€‰æ‹©ä¸šåŠ¡å‘˜
                    employees.forEach(employee => {
                        if (employee.position === 'salesperson') {
                            const positionText = getPositionText(employee.position);
                            optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                        }
                    });
                } else if (currentUser.position === 'salesperson') {
                    // ä¸šåŠ¡å‘˜åªèƒ½é€‰æ‹©è‡ªå·±
                    const positionText = getPositionText(currentUser.position);
                    optionsHtml = `<option value="">${getText('please-select-employee')}</option>`;
                    optionsHtml += `<option value="unassigned">${getText('unassigned')}</option>`;
                    optionsHtml += `<option value="${currentUser.id}" selected>${currentUser.name} - ${positionText}</option>`;
                }
            }
            
            selectElement.innerHTML = optionsHtml;
        }
        
        // æ˜¾ç¤ºå†…å®¹åŒºåŸŸ
        async function showContent(contentId, event) {
            if (event) {
                event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
            }
            
            // æƒé™æ£€æŸ¥ï¼šåˆ é™¤åŠŸèƒ½åªæœ‰ç®¡ç†å‘˜å¯ä»¥è®¿é—®
            if (contentId === 'delete-salon' || contentId === 'delete-employee') {
                if (!hasPermission('admin')) {
                    alert(contentId === 'delete-salon' ? getText('no-permission-delete-salon') : getText('no-permission-delete-employee'));
                    return;
                }
            }
            
            // éšè—ä¸»èœå•
            document.getElementById('main-menu').style.display = 'none';
            
            // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
            const allContent = document.querySelectorAll('.content-area');
            allContent.forEach(content => {
                content.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰æ‹©çš„å†…å®¹åŒºåŸŸ
            const targetContent = document.getElementById(contentId);
            if (targetContent) {
                targetContent.classList.add('active');
                
                // å¦‚æœæ˜¯æ²™é¾™ä¿¡æ¯é¡µé¢ï¼Œåˆ·æ–°åˆ—è¡¨å’Œç­›é€‰é€‰é¡¹
                if (contentId === 'salon-info') {
                    // é‡ç½®æ’åºçŠ¶æ€ä¸ºé»˜è®¤
                    currentSortField = 'default';
                    currentSortOrder = '';
                    await updateResponsibleFilterOptions();
                    await displaySalonList(null, 1); // åˆå§‹åŒ–æ—¶æ˜¾ç¤ºç¬¬ä¸€é¡µ
                }
                
                // å¦‚æœæ˜¯æ–°å¢æ²™é¾™é¡µé¢ï¼Œæ›´æ–°è´Ÿè´£èŒå‘˜é€‰é¡¹
                if (contentId === 'new-salon') {
                    await updateResponsibleEmployeeOptions();
                    checkBatchUploadPermission();
                }
                
                // å¦‚æœæ˜¯åˆ é™¤æ²™é¾™é¡µé¢ï¼Œæ›´æ–°é€‰é¡¹
                if (contentId === 'delete-salon') {
                    await updateDeleteSalonOptions();
                }
                
                // å¦‚æœæ˜¯èŒå‘˜åˆ—è¡¨é¡µé¢ï¼Œåˆ·æ–°åˆ—è¡¨
                if (contentId === 'employee-list') {
                    await displayEmployeeList();
                }
                
                // å¦‚æœæ˜¯æ–°å¢èŒå‘˜é¡µé¢ï¼Œæ ¹æ®æƒé™è®¾ç½®èŒä½é€‰é¡¹
                if (contentId === 'new-employee') {
                    const positionSelect = document.getElementById('employeePosition');
                    if (currentUser && currentUser.position === 'manager') {
                        // ç»ç†åªèƒ½åˆ›å»ºä¸šåŠ¡å‘˜
                        positionSelect.innerHTML = `<option value="salesperson" data-i18n="salesperson">ä¸šåŠ¡å‘˜</option>`;
                    } else {
                        // ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºæ‰€æœ‰çº§åˆ«
                        positionSelect.innerHTML = `
                            <option value="salesperson" data-i18n="salesperson">ä¸šåŠ¡å‘˜</option>
                            <option value="manager" data-i18n="manager">ç»ç†</option>
                            <option value="admin" data-i18n="admin">ç®¡ç†å‘˜</option>
                        `;
                    }
                    updateTexts(); // æ›´æ–°ç¿»è¯‘
                }
                
                // å¦‚æœæ˜¯åˆ é™¤èŒå‘˜é¡µé¢ï¼Œæ›´æ–°é€‰é¡¹
                if (contentId === 'delete-employee') {
                    await updateDeleteEmployeeOptions();
                }
                
                // å¦‚æœæ˜¯æ“ä½œå†å²é¡µé¢ï¼ŒåŠ è½½å†å²è®°å½•
                if (contentId === 'operation-history') {
                    displayOperationHistory();
                }
                
                // å¦‚æœæ˜¯å®¡è®¡æŠ¥å‘Šé¡µé¢ï¼Œç”ŸæˆæŠ¥å‘Š
                if (contentId === 'audit-report') {
                    displayAuditReport();
                }
                
                // å¦‚æœæ˜¯å®¡æ‰¹ç®¡ç†é¡µé¢ï¼Œæ˜¾ç¤ºå®¡æ‰¹åˆ—è¡¨
                if (contentId === 'approval-management') {
                    displayApprovalList();
                }
                
                // å¦‚æœæ˜¯ä¸šç»©ç›®æ ‡é¡µé¢ï¼Œåˆå§‹åŒ–ä¸šç»©ç›®æ ‡
                if (contentId === 'performance-target') {
                    initializePerformanceTargets();
                }
            }
        }
        
        // è¿”å›ä¸»èœå•
        function backToMenu() {
            // æ¸…é™¤æ•°æ®å¯¹æ¯”é¡µé¢çš„æ“ä½œè®°å½•
            currentComparisonOperation = null;
            
            // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
            const allContent = document.querySelectorAll('.content-area');
            allContent.forEach(content => {
                content.classList.remove('active');
            });
            
            // éšè—æ‰€æœ‰å­èœå•
            const allSubmenus = document.querySelectorAll('.submenu');
            allSubmenus.forEach(submenu => {
                submenu.classList.remove('active');
            });
            
            // æ˜¾ç¤ºä¸»èœå•
            document.getElementById('main-menu').style.display = 'grid';
        }
        
        // ç‚¹å‡»M logoè¿”å›é¦–é¡µ
        function goToHomePage() {
            // æ¸…é™¤æ•°æ®å¯¹æ¯”é¡µé¢çš„æ“ä½œè®°å½•
            currentComparisonOperation = null;
            
            // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
            const allContent = document.querySelectorAll('.content-area');
            allContent.forEach(content => {
                content.classList.remove('active');
            });
            
            // éšè—æ‰€æœ‰å­èœå•
            const allSubmenus = document.querySelectorAll('.submenu');
            allSubmenus.forEach(submenu => {
                submenu.classList.remove('active');
            });
            
            // æ˜¾ç¤ºä¸»èœå•
            document.getElementById('main-menu').style.display = 'grid';
            
            // è®°å½•æ“ä½œå†å²
            if (currentUser) {
                recordOperation(
                    'navigation',
                    'system',
                    null,
                    'é¦–é¡µå¯¼èˆª',
                    `${currentUser.name} é€šè¿‡ç‚¹å‡»Logoè¿”å›é¦–é¡µ`,
                    null,
                    null
                );
            }
        }
        
        // å¤„ç†æ–°å¢æ²™é¾™è¡¨å•æäº¤
        document.getElementById('newSalonForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const salonName = document.getElementById('salonName').value;
            const salonAddress = document.getElementById('salonAddress').value;
            const businessLicense = document.getElementById('businessLicense').value;
            const salonDistrict = document.getElementById('salonDistrict').value;
            const salonPhone = document.getElementById('salonPhone').value;
            const directorName = document.getElementById('directorName').value;
            const directorMobile = document.getElementById('directorMobile').value;
            const responsibleEmployeeId = document.getElementById('responsibleEmployee').value;
            
            // æ‰€æœ‰å­—æ®µéƒ½æ”¹ä¸ºå¯é€‰å¡«ï¼Œåªéœ€è¦æœ‰æ²™é¾™åç§°å³å¯
            if (salonName) {
                // ä¿å­˜æ²™é¾™ä¿¡æ¯
                const newSalon = {
                    name: salonName,
                    address: salonAddress,
                    businessLicense: businessLicense,
                    district: salonDistrict,
                    phone: salonPhone,
                    directorName: directorName,
                    directorMobile: directorMobile,
                    responsibleEmployeeId: responsibleEmployeeId
                };
                
                // æ£€æŸ¥æ˜¯å¦éœ€è¦å®¡æ‰¹
                if (currentUser.position === 'admin') {
                    // ç®¡ç†å‘˜ç›´æ¥æ·»åŠ 
                    const addResult = await addSalon(newSalon);
                    
                    if (addResult) {
                        let alertMessage = getText('salon-added-success') + '\n\n' + getText('salon-name-text') + 'ï¼š' + salonName + '\n' + getText('salon-address-text') + 'ï¼š' + salonAddress;
                        if (salonPhone) {
                            alertMessage += '\n' + getText('salon-phone-text') + 'ï¼š' + salonPhone;
                        }
                        alertMessage += '\n' + getText('director-name-text') + 'ï¼š' + directorName + '\n' + getText('director-mobile-text') + 'ï¼š' + directorMobile;
                        alert(alertMessage);
                        // æ¸…ç©ºè¡¨å•
                        this.reset();
                        await updateResponsibleEmployeeOptions(); // é‡ç½®è´Ÿè´£èŒå‘˜é€‰é¡¹
                        // è·³è½¬åˆ°æ²™é¾™åˆ—è¡¨é¡µé¢
                        await showContent('salon-info');
                    } else {
                        alert('æ·»åŠ æ²™é¾™å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ï¼');
                    }
                } else {
                    // ç»ç†å’Œä¸šåŠ¡å‘˜éœ€è¦å®¡æ‰¹
                    const description = `æ–°å¢æ²™é¾™ï¼š${salonName} (${salonAddress})`;
                    submitApprovalRequest('create-salon', newSalon, description);
                    
                    alert(getText('approval-submitted'));
                    // æ¸…ç©ºè¡¨å•
                    this.reset();
                    await updateResponsibleEmployeeOptions(); // é‡ç½®è´Ÿè´£èŒå‘˜é€‰é¡¹
                    // è·³è½¬åˆ°æ²™é¾™åˆ—è¡¨é¡µé¢
                    await showContent('salon-info');
                }
            } else {
                alert(getText('salon-name-required'));
            }
        });
        
        // æ–°å¢èŒå‘˜å§“åè‡ªåŠ¨å¡«å……åˆ°è´¦æˆ·æŒæœ‰äºº
        document.getElementById('employeeName').addEventListener('input', function(e) {
            const accountHolderField = document.getElementById('employeeAccountHolder');
            if (!accountHolderField.value.trim()) {
                accountHolderField.value = e.target.value.trim();
            }
        });
        

        
        // å¤„ç†æ–°å¢èŒå‘˜è¡¨å•æäº¤
        document.getElementById('newEmployeeForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const employeeName = document.getElementById('employeeName').value.trim();
            const employeePosition = document.getElementById('employeePosition').value;
            const employeeUsername = document.getElementById('employeeUsername').value.trim();
            const employeePassword = document.getElementById('employeePassword').value.trim();
            const employeeMobile = document.getElementById('employeeMobile').value.trim();
            
            // é“¶è¡Œè´¦æˆ·ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
            const bankName = document.getElementById('employeeBankName').value.trim();
            const accountNumber = document.getElementById('employeeAccountNumber').value.trim();
            const accountHolder = document.getElementById('employeeAccountHolder').value.trim() || employeeName; // é»˜è®¤ä½¿ç”¨èŒå‘˜å§“å
            const bankBranch = document.getElementById('employeeBankBranch').value.trim();
            
            if (employeeName && employeePosition && employeeUsername && employeePassword && employeeMobile) {
                // æƒé™éªŒè¯ï¼šç»ç†ä¸èƒ½åˆ›å»ºç®¡ç†å‘˜æˆ–å…¶ä»–ç»ç†
                if (currentUser.position === 'manager' && (employeePosition === 'admin' || employeePosition === 'manager')) {
                    alert(getText('cannot-edit-admin-permission'));
                    return;
                }
                
                const newEmployee = {
                    name: employeeName,
                    position: employeePosition,
                    username: employeeUsername,
                    password: employeePassword,
                    mobile: employeeMobile,
                    bankInfo: {
                        bankName: bankName,
                        accountNumber: accountNumber,
                        accountHolder: accountHolder,
                        bankBranch: bankBranch
                    }
                };
                
                if (await addEmployee(newEmployee)) {
                    alert(getText('employee-added-success'));
                    this.reset();
                    // è·³è½¬åˆ°èŒå‘˜åˆ—è¡¨é¡µé¢
                    await showContent('employee-list');
                } else {
                    alert(getText('username-already-exists'));
                }
            } else {
                alert(getText('fill-all-employee-fields'));
            }
        });

        // ç¼–è¾‘èŒå‘˜è¡¨å•æäº¤å¤„ç†
        document.getElementById('editEmployeeForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const employeeId = parseInt(document.getElementById('editEmployeeId').value);
            const employeeName = document.getElementById('editEmployeeName').value.trim();
            const employeePosition = document.getElementById('editEmployeePosition').value;
            const employeeUsername = document.getElementById('editEmployeeUsername').value.trim();
            const employeePassword = document.getElementById('editEmployeePassword').value.trim();
            const employeeMobile = document.getElementById('editEmployeeMobile').value.trim();
            
            // é“¶è¡Œè´¦æˆ·ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
            const editBankName = document.getElementById('editEmployeeBankName').value.trim();
            const editAccountNumber = document.getElementById('editEmployeeAccountNumber').value.trim();
            const editAccountHolder = document.getElementById('editEmployeeAccountHolder').value.trim() || employeeName;
            const editBankBranch = document.getElementById('editEmployeeBankBranch').value.trim();
            
            // åŸºæœ¬ä¿¡æ¯éªŒè¯
            if (!employeeName || !employeeUsername || !employeeMobile) {
                alert(getText('fill-employee-basic-info'));
                return;
            }
            
            // æƒé™éªŒè¯ï¼šç»ç†ä¸èƒ½ä¿®æ”¹ä¸ºç®¡ç†å‘˜æƒé™
            if (currentUser.position === 'manager' && employeePosition === 'admin') {
                alert(getText('cannot-edit-admin-permission'));
                return;
            }
            
            const updatedEmployee = {
                id: employeeId,
                name: employeeName,
                position: employeePosition,
                username: employeeUsername,
                password: employeePassword,
                mobile: employeeMobile,
                bankInfo: {
                    bankName: editBankName,
                    accountNumber: editAccountNumber,
                    accountHolder: editAccountHolder,
                    bankBranch: editBankBranch
                }
            };
            
            if (await updateEmployee(updatedEmployee)) {
                alert(getText('employee-updated-success'));
                closeEditEmployeeModal();
                
                // åˆ·æ–°èŒå‘˜åˆ—è¡¨ï¼ˆå¦‚æœå½“å‰åœ¨èŒå‘˜åˆ—è¡¨é¡µé¢ï¼‰
                const employeeListPage = document.getElementById('employee-list');
                if (employeeListPage && employeeListPage.classList.contains('active')) {
                    await displayEmployeeList();
                }
            } else {
                alert(getText('username-already-exists-edit'));
            }
        });
        
        // ç¼–è¾‘èŒå‘˜æ¨¡æ€æ¡†ä¸å…è®¸ç‚¹å‡»å¤–éƒ¨å…³é—­ï¼Œåªèƒ½é€šè¿‡æŒ‰é’®å…³é—­
        // document.getElementById('editEmployeeModal').addEventListener('click', function(e) {
        //     if (e.target === this) {
        //         closeEditEmployeeModal();
        //     }
        // });
        
        // ==================== å®¡æ‰¹ç³»ç»ŸåŠŸèƒ½ ====================
        
        // è·å–å¾…å®¡æ‰¹æ“ä½œ
        function getPendingApprovals() {
            return JSON.parse(localStorage.getItem('pendingApprovals')) || [];
        }
        
        // ä¿å­˜å¾…å®¡æ‰¹æ“ä½œ
        function savePendingApprovals(approvals) {
            localStorage.setItem('pendingApprovals', JSON.stringify(approvals));
        }
        
        // æäº¤å®¡æ‰¹è¯·æ±‚
        function submitApprovalRequest(operationType, operationData, description) {
            const approvals = getPendingApprovals();
            const approval = {
                id: Date.now() + Math.random(),
                operationType: operationType, // 'create-salon', 'delete-salon'
                operationData: JSON.parse(JSON.stringify(operationData)),
                description: description,
                requestedBy: currentUser.id,
                requestedByName: currentUser.name,
                requestedByPosition: currentUser.position,
                requestedAt: new Date().toISOString(),
                status: 'pending' // pending, approved, rejected
            };
            
            approvals.push(approval);
            savePendingApprovals(approvals);
            
            // è®°å½•æ“ä½œå†å²
            recordOperation(
                'approval-request',
                'system',
                approval.id,
                'å®¡æ‰¹è¯·æ±‚',
                `${currentUser.name} è¯·æ±‚å®¡æ‰¹ï¼š${description}`,
                null,
                approval
            );
            
            return approval.id;
        }
        
        // å®¡æ‰¹æ“ä½œ
        function processApproval(approvalId, action, reason) {
            const approvals = getPendingApprovals();
            const approvalIndex = approvals.findIndex(a => a.id.toString() === approvalId.toString());
            
            if (approvalIndex === -1) return false;
            
            const approval = approvals[approvalIndex];
            approval.status = action; // 'approved' or 'rejected'
            approval.processedBy = currentUser.id;
            approval.processedByName = currentUser.name;
            approval.processedAt = new Date().toISOString();
            approval.reason = reason;
            
            if (action === 'approved') {
                // æ‰§è¡Œè¢«å®¡æ‰¹çš„æ“ä½œ
                if (approval.operationType === 'create-salon') {
                    // å®é™…åˆ›å»ºæ²™é¾™
                    addSalon(approval.operationData);
                } else if (approval.operationType === 'delete-salon') {
                    // å®é™…åˆ é™¤æ²™é¾™
                    deleteSalon(approval.operationData.salonId);
                }
            }
            
            savePendingApprovals(approvals);
            
            // è®°å½•å®¡æ‰¹ç»“æœ
            recordOperation(
                action === 'approved' ? 'approval-approved' : 'approval-rejected',
                'system',
                approval.id,
                'å®¡æ‰¹å¤„ç†',
                `${currentUser.name} ${action === 'approved' ? 'æ‰¹å‡†' : 'æ‹’ç»'}äº† ${approval.requestedByName} çš„ç”³è¯·ï¼š${approval.description}`,
                null,
                approval
            );
            
            return true;
        }
        
        // æ˜¾ç¤ºå®¡æ‰¹åˆ—è¡¨
        function displayApprovalList() {
            const approvals = getPendingApprovals();
            const statusFilter = document.getElementById('approvalStatusFilter').value;
            const container = document.getElementById('approvalList');
            
            // æ ¹æ®çŠ¶æ€ç­›é€‰
            let filteredApprovals = approvals;
            if (statusFilter) {
                filteredApprovals = approvals.filter(approval => approval.status === statusFilter);
            }
            
            if (filteredApprovals.length === 0) {
                container.innerHTML = `<div style="text-align: center; color: #cccccc; padding: 40px;"><p>${getText('no-pending-approvals')}</p></div>`;
                return;
            }
            
            let html = '';
            filteredApprovals.forEach(approval => {
                const requestDate = new Date(approval.requestedAt).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
                const processDate = approval.processedAt ? new Date(approval.processedAt).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN') : '-';
                
                // æ ¹æ®çŠ¶æ€è®¾ç½®é¢œè‰²
                let statusColor = '#cccccc';
                let statusText = getText(approval.status);
                switch(approval.status) {
                    case 'pending': statusColor = '#FFD700'; break;
                    case 'approved': statusColor = '#90EE90'; break;
                    case 'rejected': statusColor = '#ff6666'; break;
                }
                
                // æ“ä½œç±»å‹çš„æ˜¾ç¤ºæ–‡æœ¬
                let operationTypeText = '';
                switch(approval.operationType) {
                    case 'create-salon': operationTypeText = 'æ–°å¢æ²™é¾™'; break;
                    case 'delete-salon': operationTypeText = 'åˆ é™¤æ²™é¾™'; break;
                }
                
                html += `
                    <div style="background: rgba(212, 175, 55, 0.1); padding: 20px; border-radius: 8px; margin-bottom: 15px; border: 1px solid rgba(212, 175, 55, 0.3);">
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                            <div>
                                <strong style="color: var(--gold);">${getText('request-time')}:</strong><br>
                                <span style="color: #cccccc;">${requestDate}</span>
                            </div>
                            <div>
                                <strong style="color: var(--gold);">${getText('requester')}:</strong><br>
                                <span style="color: #cccccc;">${approval.requestedByName} (${getPositionText(approval.requestedByPosition)})</span>
                            </div>
                            <div>
                                <strong style="color: var(--gold);">${getText('operation-type')}:</strong><br>
                                <span style="color: #cccccc;">${operationTypeText}</span>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <strong style="color: var(--gold);">${getText('operation-description')}:</strong><br>
                            <span style="color: #cccccc;">${approval.description}</span>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span style="background: ${statusColor}; color: black; padding: 4px 8px; border-radius: 4px; font-weight: bold;">
                                    ${statusText}
                                </span>
                                ${approval.processedAt ? `
                                    <div style="margin-top: 5px; font-size: 0.9em; color: #aaaaaa;">
                                        ${getText('process-time')}: ${processDate}<br>
                                        ${getText('processor')}: ${approval.processedByName}
                                        ${approval.reason ? `<br>æ„è§: ${approval.reason}` : ''}
                                    </div>
                                ` : ''}
                            </div>
                            
                            ${approval.status === 'pending' ? `
                                <div style="display: flex; gap: 10px;">
                                    <button onclick="approveOperation('${approval.id}')" style="background: #4CAF50; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                                        ${getText('approve')}
                                    </button>
                                    <button onclick="rejectOperation('${approval.id}')" style="background: #f44336; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">
                                        ${getText('reject')}
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // æ‰¹å‡†æ“ä½œ
        function approveOperation(approvalId) {
            const reason = prompt(getText('enter-approval-reason'));
            if (reason === null) return; // ç”¨æˆ·å–æ¶ˆ
            
            if (!reason.trim()) {
                alert(getText('approval-reason-required'));
                return;
            }
            
            if (processApproval(approvalId, 'approved', reason)) {
                alert(getText('approval-processed-success'));
                displayApprovalList(); // åˆ·æ–°åˆ—è¡¨
            }
        }
        
        // æ‹’ç»æ“ä½œ
        function rejectOperation(approvalId) {
            const reason = prompt(getText('enter-approval-reason'));
            if (reason === null) return; // ç”¨æˆ·å–æ¶ˆ
            
            if (!reason.trim()) {
                alert(getText('approval-reason-required'));
                return;
            }
            
            if (processApproval(approvalId, 'rejected', reason)) {
                alert(getText('approval-processed-success'));
                displayApprovalList(); // åˆ·æ–°åˆ—è¡¨
            }
        }
        
        // ==================== æ“ä½œå†å²è®°å½•åŠŸèƒ½ ====================
        
        // è·å–æ“ä½œå†å²è®°å½•
        function getOperationHistory() {
            return JSON.parse(localStorage.getItem('operationHistory')) || [];
        }
        
        // ä¿å­˜æ“ä½œå†å²è®°å½•
        function saveOperationHistory(history) {
            localStorage.setItem('operationHistory', JSON.stringify(history));
        }
        
        // è®°å½•æ“ä½œå†å²
        function recordOperation(operationType, objectType, objectId, objectName, description, beforeData = null, afterData = null) {
            const history = getOperationHistory();
            const operation = {
                id: Date.now() + Math.random(),
                timestamp: new Date().toISOString(),
                userId: currentUser ? currentUser.id : null,
                userName: currentUser ? currentUser.name : 'ç³»ç»Ÿ',
                userPosition: currentUser ? currentUser.position : 'system',
                operationType: operationType, // create, edit, delete, login, logout
                objectType: objectType, // salon, transaction, employee, system
                objectId: objectId,
                objectName: objectName,
                description: description,
                beforeData: beforeData ? JSON.parse(JSON.stringify(beforeData)) : null,
                afterData: afterData ? JSON.parse(JSON.stringify(afterData)) : null,
                ipAddress: '127.0.0.1', // åœ¨çœŸå®ç¯å¢ƒä¸­å¯ä»¥è·å–çœŸå®IP
                browserInfo: navigator.userAgent
            };
            
            history.unshift(operation); // æ·»åŠ åˆ°å¼€å¤´ï¼Œæœ€æ–°çš„åœ¨å‰é¢
            
            // ä¿ç•™æœ€è¿‘1000æ¡è®°å½•
            if (history.length > 1000) {
                history.splice(1000);
            }
            
            saveOperationHistory(history);
        }
        
        // æ˜¾ç¤ºæ“ä½œå†å²è®°å½•ï¼ˆæ”¯æŒåˆ†é¡µï¼‰
        function displayOperationHistory(page = 1) {
            const history = getOperationHistory();
            const container = document.getElementById('operation-history-list');
            
            // ä¿å­˜å½“å‰æ•°æ®å’Œé¡µé¢
            currentHistoryData = history;
            currentHistoryPage = page;
            
            if (history.length === 0) {
                container.innerHTML = `<div style="text-align: center; color: #cccccc; padding: 40px;"><p>${getText('no-operation-history')}</p></div>`;
                return;
            }
            
            // è®¡ç®—åˆ†é¡µ
            const totalPages = Math.ceil(history.length / historyItemsPerPage);
            const startIndex = (page - 1) * historyItemsPerPage;
            const endIndex = startIndex + historyItemsPerPage;
            const paginatedHistory = history.slice(startIndex, endIndex);
            
            // æ¸²æŸ“å†å²è®°å½•åˆ—è¡¨
            renderHistoryItems(paginatedHistory, startIndex);
            
            // æ¸²æŸ“åˆ†é¡µæ§ä»¶
            renderHistoryPagination(totalPages, page, history.length);
            
            // æ›´æ–°ç”¨æˆ·ç­›é€‰é€‰é¡¹
            updateHistoryUserFilter();
        }
        
        // æ¸²æŸ“å†å²è®°å½•é¡¹ç›®
        function renderHistoryItems(operations, startIndex) {
            const container = document.getElementById('operation-history-list');
            
            let html = '';
            operations.forEach((operation, index) => {
                const globalIndex = startIndex + index + 1;
                const date = new Date(operation.timestamp).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
                const operationTypeText = getText('operation-' + operation.operationType);
                const objectTypeText = getText('object-' + operation.objectType);
                
                // æ ¹æ®æ“ä½œç±»å‹è®¾ç½®é¢œè‰²
                let operationColor = '#cccccc';
                switch(operation.operationType) {
                    case 'create': operationColor = '#90EE90'; break;
                    case 'edit': operationColor = '#87CEEB'; break;
                    case 'delete': operationColor = '#ff6666'; break;
                    case 'login': operationColor = '#98FB98'; break;
                    case 'logout': operationColor = '#DDA0DD'; break;
                }
                
                // ç¡®å®šæ˜¯å¦ä¸ºé‡è¦æ“ä½œ
                const isCritical = operation.operationType === 'delete' || 
                                  (operation.operationType === 'edit' && operation.objectType === 'employee');
                
                html += `
                    <div style="background: rgba(212, 175, 55, 0.1); padding: 15px; border-radius: 5px; margin-bottom: 10px; border: 1px solid rgba(212, 175, 55, 0.3); ${isCritical ? 'border-left: 4px solid #ff6666;' : ''}">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div style="flex: 1;">
                                <div style="display: flex; gap: 20px; margin-bottom: 10px; align-items: center;">
                                    <span style="color: #999; font-size: 0.9em;">#${globalIndex}</span>
                                    <span style="color: var(--gold);">${getText('operation-time')}: ${date}</span>
                                    <span style="color: ${operationColor}; font-weight: bold;">${operationTypeText} ${objectTypeText}</span>
                                    ${isCritical ? '<span style="color: #ff6666; font-size: 0.9em;">âš ï¸ é‡è¦æ“ä½œ</span>' : ''}
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <span style="color: #aaaaaa;">${getText('operator')}: ${operation.userName} (${getPositionText(operation.userPosition)})</span>
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <span style="color: white;">${getText('object-name')}: ${translateObjectName(operation.objectName || operation.objectId)}</span>
                                </div>
                                <div style="color: #cccccc; font-size: 0.9em;">
                                    ${translateOperationDescription(operation.description, operation)}
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="viewOperationDetails('${operation.id}')" style="background: var(--gold); color: var(--black); border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 0.85em;">${getText('view-details')}</button>
                                ${operation.beforeData && operation.afterData ? `<button onclick="compareOperationData('${operation.id}')" style="background: #4CAF50; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 0.85em;">${getText('compare-data')}</button>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // æ¸²æŸ“å†å²è®°å½•åˆ†é¡µæ§ä»¶
        function renderHistoryPagination(totalPages, currentPage, totalItems) {
            const container = document.getElementById('operation-history-list');
            
            if (totalPages <= 1) return; // ä¸éœ€è¦åˆ†é¡µ
            
            // è·å–ç¿»è¯‘æ–‡å­—
            const firstPageText = getText('first-page');
            const prevPageText = getText('prev-page');
            const nextPageText = getText('next-page');
            const lastPageText = getText('last-page');
            const goToPageText = getText('go-to-page');
            const itemsPerPageText = getText('items-per-page');
            const itemsText = getText('items');
            const jumpText = getText('jump');
            const pageInfoText = getText('page-info')
                .replace('{current}', currentPage)
                .replace('{total}', totalPages)
                .replace('{items}', totalItems);
            
            let paginationHtml = `
                <div class="history-pagination-container" style="display: flex; justify-content: center; align-items: center; margin: 20px 0; gap: 10px; flex-wrap: wrap;">
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="page-btn" onclick="goToHistoryPage(1)" ${currentPage === 1 ? 'disabled' : ''} style="padding: 8px 12px; background: ${currentPage === 1 ? '#666' : 'var(--gold)'}; color: ${currentPage === 1 ? '#999' : 'var(--black)'}; border: none; border-radius: 4px; cursor: ${currentPage === 1 ? 'not-allowed' : 'pointer'}; font-size: 0.9em;">${firstPageText}</button>
                        <button class="page-btn" onclick="goToHistoryPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''} style="padding: 8px 12px; background: ${currentPage === 1 ? '#666' : 'var(--gold)'}; color: ${currentPage === 1 ? '#999' : 'var(--black)'}; border: none; border-radius: 4px; cursor: ${currentPage === 1 ? 'not-allowed' : 'pointer'}; font-size: 0.9em;">${prevPageText}</button>
                        
                        <span style="color: var(--gold); font-size: 0.9em; margin: 0 10px;">${pageInfoText}</span>
                        
                        <button class="page-btn" onclick="goToHistoryPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''} style="padding: 8px 12px; background: ${currentPage === totalPages ? '#666' : 'var(--gold)'}; color: ${currentPage === totalPages ? '#999' : 'var(--black)'}; border: none; border-radius: 4px; cursor: ${currentPage === totalPages ? 'not-allowed' : 'pointer'}; font-size: 0.9em;">${nextPageText}</button>
                        <button class="page-btn" onclick="goToHistoryPage(${totalPages})" ${currentPage === totalPages ? 'disabled' : ''} style="padding: 8px 12px; background: ${currentPage === totalPages ? '#666' : 'var(--gold)'}; color: ${currentPage === totalPages ? '#999' : 'var(--black)'}; border: none; border-radius: 4px; cursor: ${currentPage === totalPages ? 'not-allowed' : 'pointer'}; font-size: 0.9em;">${lastPageText}</button>
                    </div>
                    
                    <div style="display: flex; gap: 10px; align-items: center; margin-left: 20px;">
                        <div style="display: flex; gap: 5px; align-items: center;">
                            <span style="color: var(--gold); font-size: 0.9em;">${goToPageText}ï¼š</span>
                            <input type="number" id="history-page-jump-input" min="1" max="${totalPages}" value="${currentPage}" onkeydown="if(event.key==='Enter')jumpToHistoryPage()" style="width: 60px; padding: 6px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 4px; text-align: center; font-size: 0.9em;">
                            <button onclick="jumpToHistoryPage()" style="padding: 6px 12px; background: var(--gold); color: var(--black); border: none; border-radius: 4px; cursor: pointer; font-size: 0.9em;">${jumpText}</button>
                        </div>
                        
                        <div style="display: flex; gap: 5px; align-items: center;">
                            <span style="color: var(--gold); font-size: 0.9em;">${itemsPerPageText}</span>
                            <select id="history-items-per-page-select" onchange="changeHistoryItemsPerPage()" style="padding: 6px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 4px; font-size: 0.9em;">
                                <option value="10">10</option>
                                <option value="20">20</option>
                                <option value="30">30</option>
                                <option value="50">50</option>
                            </select>
                            <span style="color: var(--gold); font-size: 0.9em;">${itemsText}</span>
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', paginationHtml);
            
            // è®¾ç½®æ¯é¡µæ˜¾ç¤ºæ¡æ•°é€‰æ‹©å™¨çš„å½“å‰å€¼
            const itemsPerPageSelect = document.getElementById('history-items-per-page-select');
            if (itemsPerPageSelect) {
                itemsPerPageSelect.value = historyItemsPerPage.toString();
            }
        }
        
        // è·³è½¬åˆ°æŒ‡å®šå†å²è®°å½•é¡µé¢
        function goToHistoryPage(page) {
            if (page < 1 || page > Math.ceil(currentHistoryData.length / historyItemsPerPage)) return;
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ç­›é€‰æ¡ä»¶
            const userFilter = document.getElementById('history-user-filter').value;
            const operationFilter = document.getElementById('history-operation-filter').value;
            const objectFilter = document.getElementById('history-object-filter').value;
            const startDate = document.getElementById('history-start-date').value;
            const endDate = document.getElementById('history-end-date').value;
            
            const hasFilter = userFilter || operationFilter || objectFilter || startDate || endDate;
            
            if (hasFilter) {
                // å¦‚æœæœ‰ç­›é€‰æ¡ä»¶ï¼Œé‡æ–°æ‰§è¡Œç­›é€‰å¹¶æ˜¾ç¤ºæŒ‡å®šé¡µé¢
                const history = getOperationHistory();
                let filteredHistory = history;
                
                // æŒ‰ç”¨æˆ·ç­›é€‰
                if (userFilter) {
                    filteredHistory = filteredHistory.filter(operation => 
                        operation.userId && operation.userId.toString() === userFilter
                    );
                }
                
                // æŒ‰æ“ä½œç±»å‹ç­›é€‰
                if (operationFilter) {
                    filteredHistory = filteredHistory.filter(operation => 
                        operation.operationType === operationFilter
                    );
                }
                
                // æŒ‰å¯¹è±¡ç±»å‹ç­›é€‰
                if (objectFilter) {
                    filteredHistory = filteredHistory.filter(operation => 
                        operation.objectType === objectFilter
                    );
                }
                
                // æŒ‰æ—¥æœŸç­›é€‰
                if (startDate) {
                    const startDateTime = new Date(startDate).getTime();
                    filteredHistory = filteredHistory.filter(operation => 
                        new Date(operation.timestamp).getTime() >= startDateTime
                    );
                }
                
                if (endDate) {
                    const endDateTime = new Date(endDate + 'T23:59:59').getTime();
                    filteredHistory = filteredHistory.filter(operation => 
                        new Date(operation.timestamp).getTime() <= endDateTime
                    );
                }
                
                displayFilteredOperationHistory(filteredHistory, page);
            } else {
                // æ²¡æœ‰ç­›é€‰æ¡ä»¶ï¼Œæ˜¾ç¤ºå…¨éƒ¨è®°å½•
                displayOperationHistory(page);
            }
        }

        // é€šè¿‡è¾“å…¥æ¡†è·³è½¬åˆ°æŒ‡å®šå†å²è®°å½•é¡µé¢
        function jumpToHistoryPage() {
            const input = document.getElementById('history-page-jump-input');
            if (!input) return;
            
            const page = parseInt(input.value);
            const maxPage = Math.ceil(currentHistoryData.length / historyItemsPerPage);
            
            if (isNaN(page) || page < 1 || page > maxPage) {
                alert(getText('invalid-page-number').replace('{max}', maxPage));
                input.value = currentHistoryPage; // é‡ç½®ä¸ºå½“å‰é¡µ
                return;
            }
            
            goToHistoryPage(page);
        }
        
        // æ”¹å˜æ¯é¡µæ˜¾ç¤ºå†å²è®°å½•æ¡æ•°
        function changeHistoryItemsPerPage() {
            const select = document.getElementById('history-items-per-page-select');
            historyItemsPerPage = parseInt(select.value);
            
            // é‡æ–°æ˜¾ç¤ºåˆ—è¡¨ï¼Œå›åˆ°ç¬¬ä¸€é¡µ
            displayOperationHistory(1);
        }

        // æ›´æ–°å†å²è®°å½•ç”¨æˆ·ç­›é€‰é€‰é¡¹
        function updateHistoryUserFilter() {
            const history = getOperationHistory();
            const select = document.getElementById('history-user-filter');
            const currentValue = select.value;
            
            // è·å–æ‰€æœ‰ç”¨æˆ·
            const users = new Set();
            history.forEach(operation => {
                if (operation.userName) {
                    users.add(`${operation.userId}|${operation.userName}`);
                }
            });
            
            let optionsHtml = `<option value="">${getText('all-users')}</option>`;
            users.forEach(userInfo => {
                const [userId, userName] = userInfo.split('|');
                optionsHtml += `<option value="${userId}">${userName}</option>`;
            });
            
            select.innerHTML = optionsHtml;
            select.value = currentValue; // æ¢å¤ä¹‹å‰çš„é€‰æ‹©
        }
        
        // ç­›é€‰æ“ä½œå†å²è®°å½•
        function filterOperationHistory() {
            const userFilter = document.getElementById('history-user-filter').value;
            const operationFilter = document.getElementById('history-operation-filter').value;
            const objectFilter = document.getElementById('history-object-filter').value;
            const startDate = document.getElementById('history-start-date').value;
            const endDate = document.getElementById('history-end-date').value;
            
            const history = getOperationHistory();
            let filteredHistory = history;
            
            // æŒ‰ç”¨æˆ·ç­›é€‰
            if (userFilter) {
                filteredHistory = filteredHistory.filter(operation => 
                    operation.userId && operation.userId.toString() === userFilter
                );
            }
            
            // æŒ‰æ“ä½œç±»å‹ç­›é€‰
            if (operationFilter) {
                filteredHistory = filteredHistory.filter(operation => 
                    operation.operationType === operationFilter
                );
            }
            
            // æŒ‰å¯¹è±¡ç±»å‹ç­›é€‰
            if (objectFilter) {
                filteredHistory = filteredHistory.filter(operation => 
                    operation.objectType === objectFilter
                );
            }
            
            // æŒ‰æ—¥æœŸç­›é€‰
            if (startDate) {
                const startDateTime = new Date(startDate).getTime();
                filteredHistory = filteredHistory.filter(operation => 
                    new Date(operation.timestamp).getTime() >= startDateTime
                );
            }
            
            if (endDate) {
                const endDateTime = new Date(endDate + 'T23:59:59').getTime();
                filteredHistory = filteredHistory.filter(operation => 
                    new Date(operation.timestamp).getTime() <= endDateTime
                );
            }
            
            // æ˜¾ç¤ºç­›é€‰ç»“æœ
            displayFilteredOperationHistory(filteredHistory, 1); // ç­›é€‰åæ˜¾ç¤ºç¬¬ä¸€é¡µ
        }
        
        // æ˜¾ç¤ºç­›é€‰åçš„æ“ä½œå†å²è®°å½•ï¼ˆæ”¯æŒåˆ†é¡µï¼‰
        function displayFilteredOperationHistory(filteredHistory, page = 1) {
            const container = document.getElementById('operation-history-list');
            
            // ä¿å­˜å½“å‰ç­›é€‰åçš„æ•°æ®å’Œé¡µé¢
            currentHistoryData = filteredHistory;
            currentHistoryPage = page;
            
            if (filteredHistory.length === 0) {
                container.innerHTML = `<div style="text-align: center; color: #cccccc; padding: 40px;"><p>${getText('no-operation-history')}</p></div>`;
                return;
            }
            
            // è®¡ç®—åˆ†é¡µ
            const totalPages = Math.ceil(filteredHistory.length / historyItemsPerPage);
            const startIndex = (page - 1) * historyItemsPerPage;
            const endIndex = startIndex + historyItemsPerPage;
            const paginatedHistory = filteredHistory.slice(startIndex, endIndex);
            
            // æ¸²æŸ“å†å²è®°å½•åˆ—è¡¨
            renderHistoryItems(paginatedHistory, startIndex);
            
            // æ¸²æŸ“åˆ†é¡µæ§ä»¶
            renderHistoryPagination(totalPages, page, filteredHistory.length);
        }
        
        // æ¸…ç©ºå†å²è®°å½•ç­›é€‰
        function clearHistoryFilters() {
            document.getElementById('history-user-filter').value = '';
            document.getElementById('history-operation-filter').value = '';
            document.getElementById('history-object-filter').value = '';
            document.getElementById('history-start-date').value = '';
            document.getElementById('history-end-date').value = '';
            displayOperationHistory(1); // æ¸…ç©ºç­›é€‰åå›åˆ°ç¬¬ä¸€é¡µ
        }
        
        // æŸ¥çœ‹æ“ä½œè¯¦æƒ…
        function viewOperationDetails(operationId) {
            const history = getOperationHistory();
            const operation = history.find(op => op.id.toString() === operationId.toString());
            
            if (!operation) return;
            
            const date = new Date(operation.timestamp).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
            const operationTypeText = getText('operation-' + operation.operationType);
            const objectTypeText = getText('object-' + operation.objectType);
            
            const modalHtml = `
                <div id="operation-details-modal-${operationId}" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; display: flex; justify-content: center; align-items: center;">
                    <div style="background: var(--dark-gray); padding: 30px; border-radius: 10px; border: 1px solid var(--gold); width: 600px; max-width: 95vw; max-height: 95vh; overflow-y: auto;" onclick="event.stopPropagation()">
                        <h2 style="color: var(--gold); margin-top: 0;">${getText('operation-details')}</h2>
                        
                        <div style="margin-bottom: 20px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                                <div>
                                    <strong style="color: var(--gold);">${getText('operation-time')}:</strong><br>
                                    <span style="color: white;">${date}</span>
                                </div>
                                <div>
                                    <strong style="color: var(--gold);">${getText('operator')}:</strong><br>
                                    <span style="color: white;">${operation.userName} (${getPositionText(operation.userPosition)})</span>
                                </div>
                                <div>
                                    <strong style="color: var(--gold);">${getText('operation-type')}:</strong><br>
                                    <span style="color: white;">${operationTypeText}</span>
                                </div>
                                <div>
                                    <strong style="color: var(--gold);">${getText('object-type')}:</strong><br>
                                    <span style="color: white;">${objectTypeText}</span>
                                </div>
                                <div>
                                    <strong style="color: var(--gold);">${getText('object-name')}:</strong><br>
                                    <span style="color: white;">${translateObjectName(operation.objectName || operation.objectId)}</span>
                                </div>
                                <div>
                                    <strong style="color: var(--gold);">${getText('ip-address')}:</strong><br>
                                    <span style="color: white;">${operation.ipAddress}</span>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 15px;">
                                <strong style="color: var(--gold);">${getText('operation-description')}:</strong><br>
                                <span style="color: white;">${translateOperationDescription(operation.description, operation)}</span>
                            </div>
                            
                            <div>
                                <strong style="color: var(--gold);">${getText('browser-info')}:</strong><br>
                                <span style="color: #cccccc; font-size: 0.9em;">${operation.browserInfo}</span>
                            </div>
                        </div>
                        
                        <div style="text-align: right;">
                            <button onclick="closeOperationDetailsModal('${operationId}')" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">${getText('cancel')}</button>
                            ${operation.beforeData && operation.afterData ? `<button onclick="closeOperationDetailsModal('${operationId}'); compareOperationData('${operation.id}')" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">${getText('compare-data')}</button>` : ''}
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            updateTexts(); // æ›´æ–°ç¿»è¯‘
        }

        // å…³é—­æ“ä½œè¯¦æƒ…å¼¹çª—
        function closeOperationDetailsModal(operationId) {
            const modal = document.getElementById(`operation-details-modal-${operationId}`);
            if (modal) {
                modal.remove();
            }
        }
        
        // æ•°æ®å¯¹æ¯”åŠŸèƒ½
        function compareOperationData(operationId) {
            const history = getOperationHistory();
            const operation = history.find(op => op.id.toString() === operationId.toString());
            
            if (!operation || !operation.beforeData || !operation.afterData) return;
            
            // éšè—å½“å‰é¡µé¢ï¼Œæ˜¾ç¤ºæ•°æ®å¯¹æ¯”é¡µé¢
            document.querySelectorAll('.content-area').forEach(area => area.classList.remove('active'));
            document.getElementById('data-comparison').classList.add('active');
            
            displayDataComparison(operation);
        }
        
        // æ˜¾ç¤ºæ•°æ®å¯¹æ¯”
        function displayDataComparison(operation) {
            // ä¿å­˜å½“å‰æ“ä½œè®°å½•ï¼Œç”¨äºè¯­è¨€åˆ‡æ¢æ—¶é‡æ–°æ¸²æŸ“
            currentComparisonOperation = operation;
            
            const container = document.getElementById('comparison-content');
            const date = new Date(operation.timestamp).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
            const operationTypeText = getText('operation-' + operation.operationType);
            const objectTypeText = getText('object-' + operation.objectType);
            
            let comparisonHtml = `
                <div style="margin-bottom: 30px; text-align: center;">
                    <h2 style="color: var(--gold);">${translateObjectName(operation.objectName || operation.objectId)} - ${operationTypeText} ${objectTypeText}</h2>
                    <p style="color: #cccccc;">${date} - ${operation.userName} (${getPositionText(operation.userPosition)})</p>
                    <p style="color: #aaaaaa;">${translateOperationDescription(operation.description, operation)}</p>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
                    <div>
                        <h3 style="color: #ff9999; text-align: center; margin-bottom: 20px;">${getText('data-before')}</h3>
                        <div style="background: rgba(255, 153, 153, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(255, 153, 153, 0.3);">
                            ${formatDataForComparison(operation.beforeData)}
                        </div>
                    </div>
                    <div>
                        <h3 style="color: #99ff99; text-align: center; margin-bottom: 20px;">${getText('data-after')}</h3>
                        <div style="background: rgba(153, 255, 153, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(153, 255, 153, 0.3);">
                            ${formatDataForComparison(operation.afterData)}
                        </div>
                    </div>
                </div>
                
                <!-- å…³é—­æŒ‰é’® -->
                <div style="text-align: right; margin-top: 20px;">
                    <button onclick="closeDataComparison()" style="background: #666; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 0.9em;">${getText('close')}</button>
                </div>
            `;
            
            container.innerHTML = comparisonHtml;
        }
        
        // å…³é—­æ•°æ®å¯¹æ¯”æŸ¥çœ‹çª—å£
        function closeDataComparison() {
            // æ¸…é™¤å½“å‰æ“ä½œè®°å½•
            currentComparisonOperation = null;
            
            // éšè—æ•°æ®å¯¹æ¯”é¡µé¢ï¼Œè¿”å›æ“ä½œå†å²è®°å½•é¡µé¢
            document.querySelectorAll('.content-area').forEach(area => area.classList.remove('active'));
            document.getElementById('operation-history').classList.add('active');
        }
        
        // è·å–å­—æ®µåç¿»è¯‘
        function getFieldName(key) {
            const fieldKey = 'field-' + key;
            return getText(fieldKey) !== fieldKey ? getText(fieldKey) : key;
        }
        
        // è·å–å­—æ®µå€¼ç¿»è¯‘ï¼ˆé’ˆå¯¹ç‰¹å®šå­—æ®µè¿›è¡Œå€¼ç¿»è¯‘ï¼‰
        function getFieldValue(key, value) {
            if (key === 'position' && value) {
                // ç¿»è¯‘èŒä½å€¼
                return getPositionText(value);
            } else if (key === 'district' && value) {
                // ç¿»è¯‘åŒºåŸŸå€¼
                return getDistrictText(value);
            }
            return value;
        }
        
        // ç¿»è¯‘å¯¹è±¡åç§°
        function translateObjectName(objectName) {
            if (!objectName) return objectName;
            
            // å¯¹è±¡åç§°æ˜ å°„
            const objectNameMap = {
                'é¦–é¡µå¯¼èˆª': 'object-name-home-navigation',
                'ç³»ç»Ÿç™»å‡º': 'object-name-system-logout'
            };
            
            const translationKey = objectNameMap[objectName];
            if (translationKey) {
                const translated = getText(translationKey);
                return translated !== translationKey ? translated : objectName;
            }
            
            return objectName;
        }
        
        // ç¿»è¯‘æ“ä½œæè¿°
        function translateOperationDescription(description, operation) {
            if (!description) return description;
            
            // ç”¨äºåŒ¹é…å’Œæ›¿æ¢çš„æ¨¡å¼
            const patterns = [
                {
                    // é€šè¿‡ç‚¹å‡»Logoè¿”å›é¦–é¡µ
                    pattern: /^(.+)\s*é€šè¿‡ç‚¹å‡»Logoè¿”å›é¦–é¡µ$/,
                    key: 'operation-desc-homepage-navigation',
                    format: (matches, translated) => `${matches[1]} ${translated}`
                },
                {
                    // ç³»ç»Ÿç™»å‡º
                    pattern: /^ç³»ç»Ÿç™»å‡º$/,
                    key: 'operation-desc-system-logout'
                },
                {
                    // ç”¨æˆ· XXX (position) ç™»å‡ºç³»ç»Ÿ
                    pattern: /^ç”¨æˆ·\s*(.+)\s*\((.+)\)\s*ç™»å‡ºç³»ç»Ÿ$/,
                    key: 'operation-desc-user-logout',
                    format: (matches, translated) => translated.replace('{user}', matches[1]).replace('{position}', getPositionText(matches[2]))
                },
                {
                    // åˆ›å»ºæ–°æ²™é¾™ï¼šXXXï¼Œé™¢é•¿ï¼šXXX
                    pattern: /^åˆ›å»ºæ–°æ²™é¾™ï¼š(.+)ï¼Œé™¢é•¿ï¼š(.*)$/,
                    key: 'operation-desc-create-salon',
                    format: (matches, translated) => translated.replace('{name}', matches[1]).replace('{director}', matches[2] || '')
                },
                {
                    // åˆ é™¤æ²™é¾™ï¼šXXXï¼Œé™¢é•¿ï¼šXXX
                    pattern: /^åˆ é™¤æ²™é¾™ï¼š(.+)ï¼Œé™¢é•¿ï¼š(.*)$/,
                    key: 'operation-desc-delete-salon',
                    format: (matches, translated) => translated.replace('{name}', matches[1]).replace('{director}', matches[2] || '')
                },
                {
                    // ç¼–è¾‘èŒå‘˜ä¿¡æ¯ï¼šXXX
                    pattern: /^ç¼–è¾‘èŒå‘˜ä¿¡æ¯ï¼š(.+)$/,
                    key: 'operation-desc-edit-employee',
                    format: (matches, translated) => translated.replace('{name}', matches[1])
                }
            ];
            
            // å°è¯•åŒ¹é…å¹¶ç¿»è¯‘
            for (const pattern of patterns) {
                const matches = description.match(pattern.pattern);
                if (matches) {
                    const translatedText = getText(pattern.key);
                    if (translatedText !== pattern.key) {
                        if (pattern.format) {
                            return pattern.format(matches, translatedText);
                        } else {
                            return translatedText;
                        }
                    }
                    break;
                }
            }
            
            return description; // å¦‚æœæ²¡æœ‰åŒ¹é…çš„æ¨¡å¼ï¼Œè¿”å›åŸæ–‡
        }
        
        // æ ¼å¼åŒ–æ•°æ®ç”¨äºå¯¹æ¯”æ˜¾ç¤º
        function formatDataForComparison(data) {
            if (!data) return `<p style="color: #666;">${getText('no-data')}</p>`;
            
            let html = '';
            
            if (typeof data === 'object') {
                for (const [key, value] of Object.entries(data)) {
                    const translatedKey = getFieldName(key);
                    
                    if (key === 'transactions' && Array.isArray(value)) {
                        html += `<div style="margin-bottom: 10px;"><strong>${translatedKey}:</strong> ${value.length} ${getText('records')}</div>`;
                    } else if (typeof value === 'object' && value !== null) {
                        html += `<div style="margin-bottom: 10px;"><strong>${translatedKey}:</strong><br>${formatDataForComparison(value)}</div>`;
                    } else {
                        const translatedValue = getFieldValue(key, value);
                        html += `<div style="margin-bottom: 10px;"><strong>${translatedKey}:</strong> ${translatedValue || getText('not-set')}</div>`;
                    }
                }
            } else {
                html = `<div>${data}</div>`;
            }
            
            return html || `<p style="color: #666;">${getText('no-data')}</p>`;
        }
        
        // æ˜¾ç¤ºå®¡è®¡æŠ¥å‘Š
        function displayAuditReport() {
            const history = getOperationHistory();
            
            // ç»Ÿè®¡æ•°æ®
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const totalOperations = history.length;
            const todayOperations = history.filter(op => 
                new Date(op.timestamp) >= today
            ).length;
            
            const activeUsers = new Set(history.map(op => op.userId)).size;
            const criticalOperations = history.filter(op => 
                op.operationType === 'delete' || 
                (op.operationType === 'edit' && op.objectType === 'employee')
            ).length;
            
            // æ›´æ–°ç»Ÿè®¡æ•°å­—
            document.getElementById('total-operations-count').textContent = totalOperations;
            document.getElementById('today-operations-count').textContent = todayOperations;
            document.getElementById('active-users-count').textContent = activeUsers;
            document.getElementById('critical-operations-count').textContent = criticalOperations;
            
            // ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
            const reportContainer = document.getElementById('audit-report-content');
            
            // æŒ‰ç”¨æˆ·ç»Ÿè®¡
            const userStats = {};
            history.forEach(op => {
                const userName = op.userName || getText('unknown-user');
                if (!userStats[userName]) {
                    userStats[userName] = {
                        total: 0,
                        create: 0,
                        edit: 0,
                        delete: 0,
                        login: 0,
                        logout: 0
                    };
                }
                userStats[userName].total++;
                userStats[userName][op.operationType]++;
            });
            
            // æŒ‰æ“ä½œç±»å‹ç»Ÿè®¡
            const operationStats = {
                create: history.filter(op => op.operationType === 'create').length,
                edit: history.filter(op => op.operationType === 'edit').length,
                delete: history.filter(op => op.operationType === 'delete').length,
                login: history.filter(op => op.operationType === 'login').length,
                logout: history.filter(op => op.operationType === 'logout').length
            };
            
            // ç”Ÿæˆç”¨æˆ·ç»Ÿè®¡è¡¨æ ¼
            let userStatsHtml = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--gold); margin-bottom: 15px;">${getText('user-operation-stats')}</h3>
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid var(--gold);">
                        <thead style="background: rgba(212, 175, 55, 0.2);">
                            <tr>
                                <th style="padding: 10px; border: 1px solid var(--gold); color: var(--gold);">${getText('user')}</th>
                                <th style="padding: 10px; border: 1px solid var(--gold); color: var(--gold);">${getText('total')}</th>
                                <th style="padding: 10px; border: 1px solid var(--gold); color: var(--gold);">${getText('create-count')}</th>
                                <th style="padding: 10px; border: 1px solid var(--gold); color: var(--gold);">${getText('edit-count')}</th>
                                <th style="padding: 10px; border: 1px solid var(--gold); color: var(--gold);">${getText('delete-count')}</th>
                                <th style="padding: 10px; border: 1px solid var(--gold); color: var(--gold);">${getText('login-count')}</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            Object.entries(userStats).forEach(([userName, stats]) => {
                userStatsHtml += `
                    <tr>
                        <td style="padding: 10px; border: 1px solid rgba(212, 175, 55, 0.3); color: white;">${userName}</td>
                        <td style="padding: 10px; border: 1px solid rgba(212, 175, 55, 0.3); color: white; text-align: center;">${stats.total}</td>
                        <td style="padding: 10px; border: 1px solid rgba(212, 175, 55, 0.3); color: #90EE90; text-align: center;">${stats.create}</td>
                        <td style="padding: 10px; border: 1px solid rgba(212, 175, 55, 0.3); color: #87CEEB; text-align: center;">${stats.edit}</td>
                        <td style="padding: 10px; border: 1px solid rgba(212, 175, 55, 0.3); color: #ff6666; text-align: center;">${stats.delete}</td>
                        <td style="padding: 10px; border: 1px solid rgba(212, 175, 55, 0.3); color: #98FB98; text-align: center;">${stats.login}</td>
                    </tr>
                `;
            });
            
            userStatsHtml += `
                        </tbody>
                    </table>
                </div>
            `;
            
            // æœ€è¿‘çš„é‡è¦æ“ä½œ
            const recentCriticalOps = history
                .filter(op => 
                    op.operationType === 'delete' || 
                    (op.operationType === 'edit' && op.objectType === 'employee')
                )
                .slice(0, 10);
            
            let criticalOpsHtml = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: #ff6666; margin-bottom: 15px;">âš ï¸ ${getText('recent-critical-operations')}</h3>
            `;
            
            if (recentCriticalOps.length === 0) {
                criticalOpsHtml += `<p style="color: #666;">${getText('no-critical-operations')}</p>`;
            } else {
                recentCriticalOps.forEach(op => {
                    const date = new Date(op.timestamp).toLocaleString(currentLanguage === 'ko' ? 'ko-KR' : 'zh-CN');
                    const operationTypeText = getText('operation-' + op.operationType);
                    const objectTypeText = getText('object-' + op.objectType);
                    
                    criticalOpsHtml += `
                        <div style="background: rgba(255, 102, 102, 0.1); padding: 10px; border-radius: 5px; margin-bottom: 8px; border-left: 3px solid #ff6666;">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: white;">${date} - ${op.userName} ${operationTypeText} ${objectTypeText}: ${op.objectName}</span>
                                <button onclick="viewOperationDetails('${op.id}')" style="background: transparent; border: 1px solid #ff6666; color: #ff6666; padding: 2px 8px; border-radius: 3px; cursor: pointer; font-size: 0.8em;">${getText('details')}</button>
                            </div>
                        </div>
                    `;
                });
            }
            
            criticalOpsHtml += '</div>';
            
            reportContainer.innerHTML = userStatsHtml + criticalOpsHtml;
        }
        

        
        // æ˜¾ç¤ºç¼–è¾‘æ²™é¾™æ¨¡æ€æ¡†
        function showEditSalonModal(salonId) {
            const salons = getSalons();
            const salon = salons.find(s => s.id === salonId);
            
            if (!salon) return;
            
            // å¡«å……è¡¨å•æ•°æ®
            document.getElementById('editSalonId').value = salon.id;
            document.getElementById('editSalonName').value = salon.name;
            document.getElementById('editSalonAddress').value = salon.address;
            document.getElementById('editSalonDistrict').value = salon.district;
            document.getElementById('editSalonPhone').value = salon.phone || '';
            document.getElementById('editDirectorName').value = salon.directorName;
            document.getElementById('editDirectorMobile').value = salon.directorMobile;
            
            // æ›´æ–°è´Ÿè´£èŒå‘˜é€‰é¡¹
            updateEditResponsibleEmployeeOptions();
            
            // è®¾ç½®è´Ÿè´£èŒå‘˜é€‰æ‹©
            if (salon.responsibleEmployeeId) {
                document.getElementById('editResponsibleEmployee').value = salon.responsibleEmployeeId;
            }
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = document.getElementById('editSalonModal');
            modal.style.display = 'flex';
        }
        
        // å…³é—­ç¼–è¾‘æ²™é¾™æ¨¡æ€æ¡†
        function closeEditSalonModal() {
            const modal = document.getElementById('editSalonModal');
            modal.style.display = 'none';
            document.getElementById('editSalonForm').reset();
        }
        
        // ç¼–è¾‘æ²™é¾™è¡¨å•æäº¤å¤„ç†
        document.getElementById('editSalonForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const salonId = parseInt(document.getElementById('editSalonId').value);
            const salonName = document.getElementById('editSalonName').value.trim();
            const salonAddress = document.getElementById('editSalonAddress').value.trim();
            const salonDistrict = document.getElementById('editSalonDistrict').value;
            const salonPhone = document.getElementById('editSalonPhone').value.trim();
            const directorName = document.getElementById('editDirectorName').value.trim();
            const directorMobile = document.getElementById('editDirectorMobile').value.trim();
            const responsibleEmployeeId = document.getElementById('editResponsibleEmployee').value;
            
            // åŸºæœ¬ä¿¡æ¯éªŒè¯ - åªè¦æ±‚æ²™é¾™åç§°
            if (!salonName) {
                alert(getText('salon-name-required'));
                return;
            }
            
            const updatedSalon = {
                id: salonId,
                name: salonName,
                address: salonAddress,
                district: salonDistrict,
                phone: salonPhone,
                directorName: directorName,
                directorMobile: directorMobile,
                responsibleEmployeeId: responsibleEmployeeId
            };
            
            if (updateSalon(updatedSalon)) {
                alert(getText('salon-updated-success'));
                closeEditSalonModal();
                
                // åˆ·æ–°æ²™é¾™åˆ—è¡¨
                displaySalonList(currentFilter, currentPage); // ä¿æŒå½“å‰ç­›é€‰å’Œé¡µé¢
                
                // æ›´æ–°åˆ é™¤é¡µé¢çš„é€‰é¡¹
                updateDeleteSalonOptions();
            }
        });
        
        // ç¼–è¾‘æ²™é¾™æ¨¡æ€æ¡†ä¸å…è®¸ç‚¹å‡»å¤–éƒ¨å…³é—­ï¼Œåªèƒ½é€šè¿‡æŒ‰é’®å…³é—­
        // document.getElementById('editSalonModal').addEventListener('click', function(e) {
        //     if (e.target === this) {
        //         closeEditSalonModal();
        //     }
        // });

        // æ‰¹é‡æ§åˆ¶åŠŸèƒ½
        function updateBatchControls() {
            const checkboxes = document.querySelectorAll('.salon-checkbox');
            const checkedBoxes = document.querySelectorAll('.salon-checkbox:checked');
            const selectAllCheckbox = document.getElementById('select-all-salons');
            const batchDeleteBtn = document.getElementById('batch-delete-btn');
            const batchAssignBtn = document.getElementById('batch-assign-btn');
            const selectedCount = document.getElementById('selected-count');
            
            const checkedCount = checkedBoxes.length;
            const totalCount = checkboxes.length;
            
            // æ›´æ–°å…¨é€‰çŠ¶æ€
            if (checkedCount === 0) {
                selectAllCheckbox.indeterminate = false;
                selectAllCheckbox.checked = false;
            } else if (checkedCount === totalCount) {
                selectAllCheckbox.indeterminate = false;
                selectAllCheckbox.checked = true;
            } else {
                selectAllCheckbox.indeterminate = true;
                selectAllCheckbox.checked = false;
            }
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            if (checkedCount > 0) {
                batchDeleteBtn.disabled = false;
                batchDeleteBtn.style.cursor = 'pointer';
                batchDeleteBtn.style.opacity = '1';
                batchAssignBtn.disabled = false;
                batchAssignBtn.style.cursor = 'pointer';
                batchAssignBtn.style.opacity = '1';
            } else {
                batchDeleteBtn.disabled = true;
                batchDeleteBtn.style.cursor = 'not-allowed';
                batchDeleteBtn.style.opacity = '0.6';
                batchAssignBtn.disabled = true;
                batchAssignBtn.style.cursor = 'not-allowed';
                batchAssignBtn.style.opacity = '0.6';
            }
            
            // æ›´æ–°é€‰æ‹©è®¡æ•°
            selectedCount.textContent = getText('selected-count').replace('{count}', checkedCount);
        }
        
        // å…¨é€‰/å–æ¶ˆå…¨é€‰
        function toggleSelectAllSalons() {
            const selectAllCheckbox = document.getElementById('select-all-salons');
            const checkboxes = document.querySelectorAll('.salon-checkbox');
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
            
            updateBatchControls();
        }
        
        // æ‰¹é‡åˆ é™¤æ²™é¾™
        function batchDeleteSalons() {
            const checkedBoxes = document.querySelectorAll('.salon-checkbox:checked');
            if (checkedBoxes.length === 0) {
                alert(getText('no-salons-selected'));
                return;
            }
            
            const selectedSalonIds = Array.from(checkedBoxes).map(cb => parseInt(cb.dataset.salonId));
            const salons = getSalons();
            const selectedSalons = salons.filter(salon => selectedSalonIds.includes(salon.id));
            
            const salonNames = selectedSalons.map(salon => salon.name).join('ã€');
            
            if (!confirm(getText('confirm-batch-delete').replace('{count}', selectedSalonIds.length).replace('{names}', salonNames))) {
                return;
            }
            
            // æ£€æŸ¥æƒé™
            if (currentUser.position === 'admin') {
                // ç®¡ç†å‘˜ç›´æ¥åˆ é™¤
                selectedSalonIds.forEach(salonId => {
                    deleteSalon(salonId);
                });
                displaySalonList(currentFilter, 1); // åˆ·æ–°åˆ°ç¬¬ä¸€é¡µ
                updateDeleteSalonOptions();
                alert(getText('batch-delete-success').replace('{count}', selectedSalonIds.length));
            } else {
                // ç»ç†å’Œä¸šåŠ¡å‘˜éœ€è¦å®¡æ‰¹
                const description = `æ‰¹é‡åˆ é™¤æ²™é¾™ï¼š${salonNames}ï¼ˆå…±${selectedSalonIds.length}ä¸ªï¼‰`;
                submitApprovalRequest('batch-delete-salon', { salonIds: selectedSalonIds }, description);
                alert(getText('approval-submitted'));
            }
        }
        
        // æ˜¾ç¤ºæ‰¹é‡æŒ‡å®šè´Ÿè´£äººæ¨¡æ€æ¡†
        function showBatchAssignModal() {
            const checkedBoxes = document.querySelectorAll('.salon-checkbox:checked');
            if (checkedBoxes.length === 0) {
                alert(getText('no-salons-selected'));
                return;
            }
            
            const modal = document.getElementById('batchAssignModal');
            updateBatchAssignEmployeeOptions();
            modal.style.display = 'flex';
        }
        
        // å…³é—­æ‰¹é‡æŒ‡å®šè´Ÿè´£äººæ¨¡æ€æ¡†
        function closeBatchAssignModal() {
            document.getElementById('batchAssignModal').style.display = 'none';
            document.getElementById('batchAssignForm').reset();
        }
        
        // æ›´æ–°æ‰¹é‡æŒ‡å®šçš„å‘˜å·¥é€‰é¡¹
        function updateBatchAssignEmployeeOptions() {
            const selectElement = document.getElementById('batchAssignEmployee');
            const employees = getEmployees();
            
            let optionsHtml = `<option value="">${getText('please-select-employee')}</option>`;
            optionsHtml += `<option value="unassigned">${getText('unassigned')}</option>`;
            
            employees.forEach(employee => {
                if (currentUser.position === 'admin' || currentUser.position === 'manager') {
                    const positionText = getPositionText(employee.position);
                    optionsHtml += `<option value="${employee.id}">${employee.name} - ${positionText}</option>`;
                }
            });
            
            selectElement.innerHTML = optionsHtml;
        }
        
        // æ‰§è¡Œæ‰¹é‡æŒ‡å®šè´Ÿè´£äºº
        function executeBatchAssign() {
            const checkedBoxes = document.querySelectorAll('.salon-checkbox:checked');
            const employeeId = document.getElementById('batchAssignEmployee').value;
            
            if (!employeeId) {
                alert(getText('please-select-employee'));
                return;
            }
            
            const selectedSalonIds = Array.from(checkedBoxes).map(cb => parseInt(cb.dataset.salonId));
            const salons = getSalons();
            
            // æ£€æŸ¥æƒé™
            if (currentUser.position === 'admin' || currentUser.position === 'manager') {
                // ç®¡ç†å‘˜å’Œç»ç†ç›´æ¥æ“ä½œ
                selectedSalonIds.forEach(salonId => {
                    const salonIndex = salons.findIndex(s => s.id === salonId);
                    if (salonIndex !== -1) {
                        salons[salonIndex].responsibleEmployeeId = employeeId === 'unassigned' ? 'unassigned' : parseInt(employeeId);
                        salons[salonIndex].lastModified = new Date().toISOString();
                    }
                });
                
                saveSalons(salons);
                displaySalonList(currentFilter, currentPage); // ä¿æŒå½“å‰ç­›é€‰å’Œé¡µé¢
                closeBatchAssignModal();
                
                // æ¸…é™¤é€‰æ‹©çŠ¶æ€
                document.querySelectorAll('.salon-checkbox').forEach(cb => cb.checked = false);
                updateBatchControls();
                
                const employeeName = getEmployeeName(employeeId === 'unassigned' ? 'unassigned' : parseInt(employeeId));
                alert(getText('batch-assign-success').replace('{count}', selectedSalonIds.length).replace('{employee}', employeeName));
            } else {
                // ä¸šåŠ¡å‘˜éœ€è¦å®¡æ‰¹
                const selectedSalons = salons.filter(salon => selectedSalonIds.includes(salon.id));
                const salonNames = selectedSalons.map(salon => salon.name).join('ã€');
                const employeeName = getEmployeeName(employeeId === 'unassigned' ? 'unassigned' : parseInt(employeeId));
                const description = getText('batch-assign-description')
                    .replace('{salons}', salonNames)
                    .replace('{count}', selectedSalonIds.length)
                    .replace('{employee}', employeeName);
                
                submitApprovalRequest('batch-assign-responsible', { 
                    salonIds: selectedSalonIds, 
                    employeeId: employeeId === 'unassigned' ? 'unassigned' : parseInt(employeeId)
                }, description);
                
                closeBatchAssignModal();
                alert(getText('approval-submitted'));
            }
        }
        
        // ==================== ä¸šç»©ç›®æ ‡ç®¡ç† ====================
        
        // ä¸šç»©ç›®æ ‡æ•°æ®å­˜å‚¨
        function getPerformanceTargets() {
            const targets = localStorage.getItem('performanceTargets');
            return targets ? JSON.parse(targets) : {};
        }
        
        function savePerformanceTargets(targets) {
            localStorage.setItem('performanceTargets', JSON.stringify(targets));
        }
        
        // è·å–ä¸šç»©å®é™…æ•°æ®
        function getPerformanceActuals() {
            const actuals = localStorage.getItem('performanceActuals');
            return actuals ? JSON.parse(actuals) : {};
        }
        
        function savePerformanceActuals(actuals) {
            localStorage.setItem('performanceActuals', JSON.stringify(actuals));
        }
        
        // åˆå§‹åŒ–ä¸šç»©ç›®æ ‡é¡µé¢
        function initializePerformanceTargets() {
            generateMonthOptions();
            initializeEmployeeTargets();
            displayPerformanceTargets();
        }
        
        // ç”Ÿæˆæœˆä»½é€‰æ‹©é€‰é¡¹
        function generateMonthOptions() {
            const monthSelect = document.getElementById('performance-month');
            const currentDate = new Date();
            const currentYear = currentDate.getFullYear();
            const currentMonth = currentDate.getMonth();
            
            monthSelect.innerHTML = '';
            
            // ç”Ÿæˆè¿‡å»6ä¸ªæœˆå’Œæœªæ¥6ä¸ªæœˆçš„é€‰é¡¹
            for (let i = -6; i <= 6; i++) {
                const month = new Date(currentYear, currentMonth + i, 1);
                const monthKey = `${month.getFullYear()}-${String(month.getMonth() + 1).padStart(2, '0')}`;
                const monthText = currentLanguage === 'ko' ? 
                    `${month.getFullYear()}ë…„ ${month.getMonth() + 1}ì›”` :
                    `${month.getFullYear()}å¹´${month.getMonth() + 1}æœˆ`;
                
                const option = document.createElement('option');
                option.value = monthKey;
                option.textContent = monthText;
                
                if (i === 0) {
                    option.selected = true;
                }
                
                monthSelect.appendChild(option);
            }
        }
        
        // åˆå§‹åŒ–å‘˜å·¥ç›®æ ‡ï¼ˆ200ä¸‡éŸ©å…ƒ = 2000åƒéŸ©å…ƒï¼‰
        function initializeEmployeeTargets() {
            const employees = getEmployees();
            const targets = getPerformanceTargets();
            const currentMonth = document.getElementById('performance-month').value;
            
            if (!targets[currentMonth]) {
                targets[currentMonth] = {};
            }
            
            let hasNewTargets = false;
            employees.forEach(employee => {
                if (!targets[currentMonth][employee.id]) {
                    targets[currentMonth][employee.id] = 2000; // 200ä¸‡éŸ©å…ƒ = 2000åƒéŸ©å…ƒ
                    hasNewTargets = true;
                }
            });
            
            if (hasNewTargets) {
                savePerformanceTargets(targets);
            }
        }
        
        // æ˜¾ç¤ºä¸šç»©ç›®æ ‡
        function displayPerformanceTargets() {
            const selectedMonth = document.getElementById('performance-month').value;
            initializeEmployeeTargets();
            
            const employees = getEmployees();
            const targets = getPerformanceTargets();
            const actuals = getPerformanceActuals();
            
            const monthTargets = targets[selectedMonth] || {};
            const monthActuals = actuals[selectedMonth] || {};
            
            // è®¡ç®—å›¢é˜Ÿæ€»ç›®æ ‡å’Œæ€»å®é™…
            let teamTarget = 0;
            let teamActual = 0;
            
            employees.forEach(employee => {
                teamTarget += monthTargets[employee.id] || 0;
                teamActual += monthActuals[employee.id] || 0;
            });
            
            // æ›´æ–°å›¢é˜Ÿç›®æ ‡æ˜¾ç¤º
            document.getElementById('team-target-amount').textContent = teamTarget.toLocaleString();
            document.getElementById('team-actual-amount').textContent = teamActual.toLocaleString();
            document.getElementById('team-target-display').textContent = teamTarget.toLocaleString();
            
            const teamProgress = teamTarget > 0 ? Math.min((teamActual / teamTarget) * 100, 100) : 0;
            document.getElementById('team-progress-text').textContent = `${teamProgress.toFixed(1)}%`;
            document.getElementById('team-progress-bar').style.width = `${teamProgress}%`;
            
            // ç”Ÿæˆä¸ªäººç›®æ ‡åˆ—è¡¨
            renderIndividualTargets(employees, monthTargets, monthActuals, selectedMonth);
        }
        
        // æ¸²æŸ“ä¸ªäººç›®æ ‡åˆ—è¡¨
        function renderIndividualTargets(employees, targets, actuals, selectedMonth) {
            const container = document.getElementById('performance-list');
            
            let html = `
                <div style="background: rgba(135, 206, 235, 0.1); padding: 20px; border-radius: 8px; border: 1px solid rgba(135, 206, 235, 0.3);">
                    <h2 style="color: #87CEEB; margin: 0 0 20px 0; text-align: center;" data-i18n="individual-targets">ä¸ªäººä¸šç»©ç›®æ ‡</h2>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; min-width: 800px;">
                            <thead>
                                <tr style="background: rgba(135, 206, 235, 0.2);">
                                    <th style="padding: 12px; text-align: left; color: #87CEEB; border: 1px solid rgba(135, 206, 235, 0.5);" data-i18n="employee-name-column">èŒå‘˜å§“å</th>
                                    <th style="padding: 12px; text-align: center; color: #87CEEB; border: 1px solid rgba(135, 206, 235, 0.5);" data-i18n="monthly-target">æœˆåº¦ç›®æ ‡</th>
                                    <th style="padding: 12px; text-align: center; color: #87CEEB; border: 1px solid rgba(135, 206, 235, 0.5);" data-i18n="monthly-actual">æœˆåº¦å®é™…</th>
                                    <th style="padding: 12px; text-align: center; color: #87CEEB; border: 1px solid rgba(135, 206, 235, 0.5);" data-i18n="progress-rate">è¿›åº¦ç‡(%)</th>
                                    <th style="padding: 12px; text-align: center; color: #87CEEB; border: 1px solid rgba(135, 206, 235, 0.5);" data-i18n="target-adjustment">ç›®æ ‡è°ƒæ•´</th>
                                </tr>
                            </thead>
                            <tbody>
            `;
            
            employees.forEach(employee => {
                const target = targets[employee.id] || 0;
                const actual = actuals[employee.id] || 0;
                const progress = target > 0 ? Math.min((actual / target) * 100, 100) : 0;
                
                // æ£€æŸ¥ä¸Šæœˆä¸šç»©æ˜¯å¦è¶…æ ‡
                const lastMonth = getPreviousMonth(selectedMonth);
                const lastMonthActuals = getPerformanceActuals()[lastMonth] || {};
                const lastMonthTargets = getPerformanceTargets()[lastMonth] || {};
                const lastMonthActual = lastMonthActuals[employee.id] || 0;
                const lastMonthTarget = lastMonthTargets[employee.id] || 0;
                const isTargetIncreased = lastMonthActual > lastMonthTarget;
                
                // è¿›åº¦æ¡é¢œè‰²
                let progressColor = '#4CAF50';
                if (progress < 50) progressColor = '#ff6666';
                else if (progress < 80) progressColor = '#ffaa00';
                
                html += `
                    <tr style="border: 1px solid rgba(135, 206, 235, 0.3);">
                        <td style="padding: 12px; color: var(--text-light); border: 1px solid rgba(135, 206, 235, 0.3);">
                            <div style="font-weight: bold;">${employee.name}</div>
                            <div style="font-size: 0.8em; color: #aaa;">${getPositionText(employee.position)}</div>
                        </td>
                        <td style="padding: 12px; text-align: center; color: var(--gold); border: 1px solid rgba(135, 206, 235, 0.3);">
                            <div style="font-size: 1.2em; font-weight: bold;">${target.toLocaleString()}</div>
                            <div style="font-size: 0.8em; color: #aaa;" data-i18n="thousand-won">åƒéŸ©å…ƒ</div>
                        </td>
                        <td style="padding: 12px; text-align: center; border: 1px solid rgba(135, 206, 235, 0.3);">
                            <div style="margin-bottom: 5px;">
                                <input type="number" id="actual-${employee.id}" value="${actual}" onchange="updateActualAmount('${employee.id}', this.value)" style="width: 100px; padding: 5px; background: var(--dark-gray); border: 1px solid var(--gold); color: var(--text-light); border-radius: 3px; text-align: center;">
                            </div>
                            <div style="font-size: 0.8em; color: #aaa;" data-i18n="thousand-won">åƒéŸ©å…ƒ</div>
                        </td>
                        <td style="padding: 12px; text-align: center; border: 1px solid rgba(135, 206, 235, 0.3);">
                            <div style="margin-bottom: 5px;">
                                <span style="font-size: 1.1em; font-weight: bold; color: ${progressColor};">${progress.toFixed(1)}%</span>
                            </div>
                            <div style="background: rgba(0,0,0,0.3); height: 8px; border-radius: 4px; overflow: hidden; margin: 5px 0;">
                                <div style="height: 100%; background: ${progressColor}; width: ${progress}%; transition: width 0.3s ease;"></div>
                            </div>
                        </td>
                        <td style="padding: 12px; text-align: center; border: 1px solid rgba(135, 206, 235, 0.3);">
                            ${isTargetIncreased ? 
                                `<span style="color: #ffaa00; font-size: 0.9em;" data-i18n="target-increased">ç›®æ ‡ä¸Šè°ƒ10%</span>` : 
                                `<span style="color: #90EE90; font-size: 0.9em;" data-i18n="target-maintained">ç›®æ ‡ä¿æŒ</span>`
                            }
                        </td>
                    </tr>
                `;
            });
            
            html += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
            
            // æ›´æ–°å¤šè¯­è¨€
            updateTexts();
        }
        
        // æ›´æ–°å®é™…é‡‘é¢
        function updateActualAmount(employeeId, value) {
            const selectedMonth = document.getElementById('performance-month').value;
            const actuals = getPerformanceActuals();
            
            if (!actuals[selectedMonth]) {
                actuals[selectedMonth] = {};
            }
            
            actuals[selectedMonth][employeeId] = parseFloat(value) || 0;
            savePerformanceActuals(actuals);
            
            // é‡æ–°æ˜¾ç¤ºä¸šç»©ç›®æ ‡ä»¥æ›´æ–°å›¢é˜Ÿæ€»è®¡
            displayPerformanceTargets();
        }
        
        // è·å–ä¸Šä¸ªæœˆçš„é”®
        function getPreviousMonth(monthKey) {
            const [year, month] = monthKey.split('-').map(Number);
            const date = new Date(year, month - 2, 1); // month-2 å› ä¸ºJavaScriptæœˆä»½ä»0å¼€å§‹
            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
        }
        
        // é‡æ–°è®¡ç®—ç›®æ ‡ï¼ˆæ ¹æ®ä¸Šæœˆä¸šç»©è‡ªåŠ¨è°ƒæ•´ï¼‰
        function recalculatePerformanceTargets() {
            const selectedMonth = document.getElementById('performance-month').value;
            const lastMonth = getPreviousMonth(selectedMonth);
            
            const targets = getPerformanceTargets();
            const actuals = getPerformanceActuals();
            const employees = getEmployees();
            
            if (!targets[selectedMonth]) {
                targets[selectedMonth] = {};
            }
            
            const lastMonthTargets = targets[lastMonth] || {};
            const lastMonthActuals = actuals[lastMonth] || {};
            
            let adjustedCount = 0;
            
            employees.forEach(employee => {
                const lastTarget = lastMonthTargets[employee.id] || 2000; // é»˜è®¤200ä¸‡éŸ©å…ƒ
                const lastActual = lastMonthActuals[employee.id] || 0;
                
                if (lastActual > lastTarget) {
                    // ä¸Šæœˆè¶…æ ‡ï¼Œæœ¬æœˆç›®æ ‡ä¸Šè°ƒ10%
                    targets[selectedMonth][employee.id] = Math.round(lastTarget * 1.1);
                    adjustedCount++;
                } else {
                    // ä¸Šæœˆæœªè¾¾æ ‡ï¼Œç»´æŒç›®æ ‡
                    targets[selectedMonth][employee.id] = lastTarget;
                }
            });
            
            savePerformanceTargets(targets);
            displayPerformanceTargets();
            
            alert(getText('target-recalculation-complete').replace('{count}', adjustedCount));
        }
        
        // é‡ç½®æ‰€æœ‰ç›®æ ‡ä¸ºåˆå§‹å€¼ï¼ˆ200ä¸‡éŸ©å…ƒï¼‰
        function resetPerformanceTargets() {
            const selectedMonth = document.getElementById('performance-month').value;
            
            if (confirm(getText('confirm-reset-targets'))) {
                const targets = getPerformanceTargets();
                const employees = getEmployees();
                
                if (!targets[selectedMonth]) {
                    targets[selectedMonth] = {};
                }
                
                employees.forEach(employee => {
                    targets[selectedMonth][employee.id] = 2000; // 200ä¸‡éŸ©å…ƒ = 2000åƒéŸ©å…ƒ
                });
                
                savePerformanceTargets(targets);
                displayPerformanceTargets();
                
                alert(getText('targets-reset-complete'));
            }
        }
        
        // è·å–èŒä½æ–‡æœ¬
        function getPositionText(position) {
            const positionTexts = {
                'admin': currentLanguage === 'ko' ? 'ê´€ë¦¬ì' : 'ç®¡ç†å‘˜',
                'manager': currentLanguage === 'ko' ? 'ë§¤ë‹ˆì €' : 'ç»ç†',
                'salesperson': currentLanguage === 'ko' ? 'ì˜ì—…ì‚¬ì›' : 'ä¸šåŠ¡å‘˜'
            };
            return positionTexts[position] || position;
        }
        
        // ==================== ğŸ”¥ Firebase äº‘ç«¯æ•°æ®åŒæ­¥åŠŸèƒ½ ====================
        
        // Firebaseé…ç½®
        const firebaseConfig = {
            apiKey: "AIzaSyAcLyCy4FIL34AUd6vKrE_EqHV69qcFDYQ",
            authDomain: "mesiahair.firebaseapp.com",
            projectId: "mesiahair",
            storageBucket: "mesiahair.firebasestorage.app",
            messagingSenderId: "538029419112",
            appId: "1:538029419112:web:e2bb82a5fe0356e8d769dd"
        };
        
        // Firebaseæ•°æ®ç®¡ç†å™¨
        class CloudDataManager {
            constructor() {
                this.db = null;
                this.isOnline = navigator.onLine;
                this.syncQueue = [];
                this.isInitialized = false;
                
                // ç›‘å¬ç½‘ç»œçŠ¶æ€
                window.addEventListener('online', () => {
                    this.isOnline = true;
                    this.updateSyncStatus();
                    this.processSyncQueue();
                });
                
                window.addEventListener('offline', () => {
                    this.isOnline = false;
                    this.updateSyncStatus();
                });
            }
            
            // åˆå§‹åŒ–Firebase
            async initialize() {
                try {
                    firebase.initializeApp(firebaseConfig);
                    this.db = firebase.firestore();
                    this.isInitialized = true;
                    console.log('ğŸ”¥ Firebaseå·²åˆå§‹åŒ–ï¼Œäº‘ç«¯åŒæ­¥åŠŸèƒ½å·²å¯ç”¨');
                    
                    // æ£€æŸ¥å¹¶è¿ç§»æœ¬åœ°æ•°æ®
                    await this.migrateLocalData();
                    
                    this.updateSyncStatus();
                    return true;
                } catch (error) {
                    console.error('âŒ Firebaseåˆå§‹åŒ–å¤±è´¥:', error);
                    this.isInitialized = false;
                    this.updateSyncStatus();
                    return false;
                }
            }
            
            // è¿ç§»æœ¬åœ°æ•°æ®åˆ°äº‘ç«¯
            async migrateLocalData() {
                try {
                    const localEmployees = JSON.parse(localStorage.getItem('employees') || '[]');
                    const localSalons = JSON.parse(localStorage.getItem('salons') || '[]');
                    
                    if (localEmployees.length > 0) {
                        console.log('ğŸ”„ å‘ç°æœ¬åœ°å‘˜å·¥æ•°æ®ï¼Œå¼€å§‹è¿ç§»...');
                        for (const employee of localEmployees) {
                            await this.saveEmployee(employee);
                        }
                        console.log('âœ… å‘˜å·¥æ•°æ®è¿ç§»å®Œæˆ');
                    }
                    
                    if (localSalons.length > 0) {
                        console.log('ğŸ”„ å‘ç°æœ¬åœ°æ²™é¾™æ•°æ®ï¼Œå¼€å§‹è¿ç§»...');
                        for (const salon of localSalons) {
                            await this.saveSalon(salon);
                        }
                        console.log('âœ… æ²™é¾™æ•°æ®è¿ç§»å®Œæˆ');
                    }
                    
                } catch (error) {
                    console.error('âŒ æ•°æ®è¿ç§»å¤±è´¥:', error);
                }
            }
            
            // ä¿å­˜å‘˜å·¥æ•°æ®
            async saveEmployee(employee) {
                try {
                    if (this.isInitialized && this.isOnline) {
                        await this.db.collection('employees').doc(employee.id.toString()).set(employee);
                        console.log('â˜ï¸ å‘˜å·¥æ•°æ®å·²åŒæ­¥åˆ°äº‘ç«¯:', employee.name);
                        return true;
                    } else {
                        // ç¦»çº¿æ—¶å­˜å‚¨åˆ°æœ¬åœ°
                        this.addToSyncQueue(() => this.saveEmployee(employee));
                        const employees = JSON.parse(localStorage.getItem('employees') || '[]');
                        const index = employees.findIndex(emp => emp.id === employee.id);
                        if (index >= 0) {
                            employees[index] = employee;
                        } else {
                            employees.push(employee);
                        }
                        localStorage.setItem('employees', JSON.stringify(employees));
                        return true;
                    }
                } catch (error) {
                    console.error('âŒ ä¿å­˜å‘˜å·¥æ•°æ®å¤±è´¥:', error);
                    // å›é€€åˆ°æœ¬åœ°å­˜å‚¨
                    const employees = JSON.parse(localStorage.getItem('employees') || '[]');
                    const index = employees.findIndex(emp => emp.id === employee.id);
                    if (index >= 0) {
                        employees[index] = employee;
                    } else {
                        employees.push(employee);
                    }
                    localStorage.setItem('employees', JSON.stringify(employees));
                    return true;
                }
            }
            
            // è·å–å‘˜å·¥æ•°æ®
            async getEmployees() {
                try {
                    if (this.isInitialized && this.isOnline) {
                        const snapshot = await this.db.collection('employees').get();
                        const employees = [];
                        snapshot.forEach(doc => {
                            employees.push(doc.data());
                        });
                        // åŒæ­¥åˆ°æœ¬åœ°ç¼“å­˜
                        localStorage.setItem('employees', JSON.stringify(employees));
                        return employees;
                    } else {
                        // ç¦»çº¿æ—¶ä½¿ç”¨æœ¬åœ°æ•°æ®
                        return JSON.parse(localStorage.getItem('employees') || '[]');
                    }
                } catch (error) {
                    console.error('âŒ è·å–å‘˜å·¥æ•°æ®å¤±è´¥:', error);
                    return JSON.parse(localStorage.getItem('employees') || '[]');
                }
            }
            
            // ä¿å­˜æ²™é¾™æ•°æ®
            async saveSalon(salon) {
                try {
                    if (this.isInitialized && this.isOnline) {
                        await this.db.collection('salons').doc(salon.id.toString()).set(salon);
                        console.log('â˜ï¸ æ²™é¾™æ•°æ®å·²åŒæ­¥åˆ°äº‘ç«¯:', salon.name);
                        return true;
                    } else {
                        // ç¦»çº¿æ—¶å­˜å‚¨åˆ°æœ¬åœ°
                        this.addToSyncQueue(() => this.saveSalon(salon));
                        const salons = JSON.parse(localStorage.getItem('salons') || '[]');
                        const index = salons.findIndex(s => s.id === salon.id);
                        if (index >= 0) {
                            salons[index] = salon;
                        } else {
                            salons.push(salon);
                        }
                        localStorage.setItem('salons', JSON.stringify(salons));
                        return true;
                    }
                } catch (error) {
                    console.error('âŒ ä¿å­˜æ²™é¾™æ•°æ®å¤±è´¥:', error);
                    // å›é€€åˆ°æœ¬åœ°å­˜å‚¨
                    const salons = JSON.parse(localStorage.getItem('salons') || '[]');
                    const index = salons.findIndex(s => s.id === salon.id);
                    if (index >= 0) {
                        salons[index] = salon;
                    } else {
                        salons.push(salon);
                    }
                    localStorage.setItem('salons', JSON.stringify(salons));
                    return true;
                }
            }
            
            // è·å–æ²™é¾™æ•°æ®
            async getSalons() {
                try {
                    if (this.isInitialized && this.isOnline) {
                        const snapshot = await this.db.collection('salons').get();
                        const salons = [];
                        snapshot.forEach(doc => {
                            salons.push(doc.data());
                        });
                        // åŒæ­¥åˆ°æœ¬åœ°ç¼“å­˜
                        localStorage.setItem('salons', JSON.stringify(salons));
                        return salons;
                    } else {
                        // ç¦»çº¿æ—¶ä½¿ç”¨æœ¬åœ°æ•°æ®
                        return JSON.parse(localStorage.getItem('salons') || '[]');
                    }
                } catch (error) {
                    console.error('âŒ è·å–æ²™é¾™æ•°æ®å¤±è´¥:', error);
                    return JSON.parse(localStorage.getItem('salons') || '[]');
                }
            }
            
            // åˆ é™¤å‘˜å·¥æ•°æ®
            async deleteEmployee(employeeId) {
                try {
                    if (this.isInitialized && this.isOnline) {
                        await this.db.collection('employees').doc(employeeId.toString()).delete();
                        console.log('â˜ï¸ å‘˜å·¥æ•°æ®å·²ä»äº‘ç«¯åˆ é™¤:', employeeId);
                    } else {
                        this.addToSyncQueue(() => this.deleteEmployee(employeeId));
                    }
                    
                    // åŒæ—¶åˆ é™¤æœ¬åœ°æ•°æ®
                    const employees = JSON.parse(localStorage.getItem('employees') || '[]');
                    const filteredEmployees = employees.filter(emp => emp.id !== employeeId);
                    localStorage.setItem('employees', JSON.stringify(filteredEmployees));
                    return true;
                } catch (error) {
                    console.error('âŒ åˆ é™¤å‘˜å·¥æ•°æ®å¤±è´¥:', error);
                    return false;
                }
            }
            
            // åˆ é™¤æ²™é¾™æ•°æ®
            async deleteSalon(salonId) {
                try {
                    if (this.isInitialized && this.isOnline) {
                        await this.db.collection('salons').doc(salonId.toString()).delete();
                        console.log('â˜ï¸ æ²™é¾™æ•°æ®å·²ä»äº‘ç«¯åˆ é™¤:', salonId);
                    } else {
                        this.addToSyncQueue(() => this.deleteSalon(salonId));
                    }
                    
                    // åŒæ—¶åˆ é™¤æœ¬åœ°æ•°æ®
                    const salons = JSON.parse(localStorage.getItem('salons') || '[]');
                    const filteredSalons = salons.filter(salon => salon.id !== salonId);
                    localStorage.setItem('salons', JSON.stringify(filteredSalons));
                    return true;
                } catch (error) {
                    console.error('âŒ åˆ é™¤æ²™é¾™æ•°æ®å¤±è´¥:', error);
                    return false;
                }
            }
            
            // æ·»åŠ åˆ°åŒæ­¥é˜Ÿåˆ—
            addToSyncQueue(operation) {
                this.syncQueue.push(operation);
                this.updateSyncStatus();
            }
            
            // å¤„ç†åŒæ­¥é˜Ÿåˆ—
            async processSyncQueue() {
                if (!this.isInitialized || !this.isOnline) return;
                
                while (this.syncQueue.length > 0) {
                    const operation = this.syncQueue.shift();
                    try {
                        await operation();
                        console.log('âœ… é˜Ÿåˆ—æ“ä½œåŒæ­¥æˆåŠŸ');
                    } catch (error) {
                        console.error('âŒ é˜Ÿåˆ—æ“ä½œåŒæ­¥å¤±è´¥:', error);
                        this.syncQueue.unshift(operation); // é‡æ–°åŠ å…¥é˜Ÿåˆ—
                        break;
                    }
                }
                this.updateSyncStatus();
            }
            
            // æ›´æ–°åŒæ­¥çŠ¶æ€æ˜¾ç¤º
            updateSyncStatus() {
                const indicator = document.getElementById('sync-status-indicator');
                if (!indicator) return;
                
                const status = this.getSyncStatus();
                indicator.textContent = status.message;
                indicator.className = `sync-status ${status.type}`;
            }
            
            // è·å–åŒæ­¥çŠ¶æ€
            getSyncStatus() {
                if (!this.isInitialized) {
                    return { type: 'error', message: 'äº‘ç«¯åŒæ­¥æœªå¯ç”¨' };
                }
                
                if (!this.isOnline) {
                    return { 
                        type: 'offline', 
                        message: this.syncQueue.length > 0 ? 
                            `ç¦»çº¿æ¨¡å¼ (${this.syncQueue.length}é¡¹å¾…åŒæ­¥)` : 
                            'ç¦»çº¿æ¨¡å¼'
                    };
                }
                
                if (this.syncQueue.length > 0) {
                    return { type: 'syncing', message: `åŒæ­¥ä¸­... (${this.syncQueue.length}é¡¹)` };
                }
                
                return { type: 'online', message: 'äº‘ç«¯å·²åŒæ­¥' };
            }
        }
        
        // åˆ›å»ºå…¨å±€äº‘ç«¯æ•°æ®ç®¡ç†å™¨
        const cloudDataManager = new CloudDataManager();
        
        // äº‘ç«¯åŒæ­¥åŠŸèƒ½å·²é›†æˆåˆ°ä¸Šè¿°å‡½æ•°ä¸­
        
        // æ·»åŠ åŒæ­¥çŠ¶æ€æŒ‡ç¤ºå™¨
        function addSyncStatusIndicator() {
            const indicator = document.createElement('div');
            indicator.id = 'sync-status-indicator';
            indicator.className = 'sync-status offline';
            indicator.textContent = 'åˆå§‹åŒ–ä¸­...';
            indicator.style.cssText = `
                position: fixed;
                top: 70px;
                right: 20px;
                padding: 6px 12px;
                border-radius: 15px;
                font-size: 0.8em;
                font-weight: bold;
                z-index: 1001;
                transition: all 0.3s ease;
                cursor: pointer;
                box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            `;
            
            // æ·»åŠ æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
                .sync-status.online {
                    background: #4CAF50;
                    color: white;
                    border: 1px solid #45a049;
                }
                .sync-status.offline {
                    background: #ff9800;
                    color: white;
                    border: 1px solid #f57c00;
                }
                .sync-status.syncing {
                    background: #2196F3;
                    color: white;
                    border: 1px solid #1976D2;
                    animation: pulse 1.5s infinite;
                }
                .sync-status.error {
                    background: #f44336;
                    color: white;
                    border: 1px solid #d32f2f;
                }
                @keyframes pulse {
                    0% { opacity: 1; }
                    50% { opacity: 0.7; }
                    100% { opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            // ç‚¹å‡»æ˜¾ç¤ºè¯¦ç»†çŠ¶æ€
            indicator.addEventListener('click', () => {
                const status = cloudDataManager.getSyncStatus();
                alert(`äº‘ç«¯åŒæ­¥çŠ¶æ€ï¼š${status.message}\n\n` +
                      `Firebaseè¿æ¥ï¼š${cloudDataManager.isInitialized ? 'å·²è¿æ¥' : 'æœªè¿æ¥'}\n` +
                      `ç½‘ç»œçŠ¶æ€ï¼š${cloudDataManager.isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}\n` +
                      `å¾…åŒæ­¥é¡¹ç›®ï¼š${cloudDataManager.syncQueue.length}é¡¹`);
            });
            
            document.body.appendChild(indicator);
        }
        
        // åœ¨é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–äº‘ç«¯åŒæ­¥
        document.addEventListener('DOMContentLoaded', async function() {
            // æ·»åŠ åŒæ­¥çŠ¶æ€æŒ‡ç¤ºå™¨
            addSyncStatusIndicator();
            
            // ç«‹å³å°è¯•åˆå§‹åŒ–Firebase
            try {
                console.log('ğŸ”„ å¼€å§‹åˆå§‹åŒ–äº‘ç«¯åŒæ­¥...');
                const success = await cloudDataManager.initialize();
                if (success) {
                    console.log('ğŸ‰ äº‘ç«¯æ•°æ®åŒæ­¥åŠŸèƒ½å·²å¯ç”¨ï¼');
                    cloudDataManager.updateSyncStatus();
                    // å®šæœŸæ›´æ–°çŠ¶æ€
                    setInterval(() => {
                        cloudDataManager.updateSyncStatus();
                    }, 3000);
                } else {
                    console.log('âš ï¸ äº‘ç«¯åŒæ­¥åˆå§‹åŒ–å¤±è´¥ï¼Œå°†ä½¿ç”¨æœ¬åœ°å­˜å‚¨æ¨¡å¼');
                    cloudDataManager.updateSyncStatus();
                }
            } catch (error) {
                console.error('âŒ äº‘ç«¯åŒæ­¥åˆå§‹åŒ–å‡ºé”™:', error);
                cloudDataManager.isInitialized = false;
                cloudDataManager.updateSyncStatus();
            }
        });
        
    </script>
</body>
</html> 